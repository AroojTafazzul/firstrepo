/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.admin.widget.Alerts"]){dojo._hasResource["misys.admin.widget.Alerts"]=true;dojo.provide("misys.admin.widget.Alerts");dojo.experimental("misys.admin.widget.Alerts");dojo.require("misys.grid.DataGrid");dojo.require("misys.grid.GridMultipleItems");dojo.declare("misys.admin.widget.Alerts",[misys.grid.GridMultipleItems],{data:{identifier:"store_id",label:"store_id",items:[]},templatePath:null,templateString:dojo.byId("alerts01-template").innerHTML,gridColumns:[],AlertType:"",HasEntity:"",propertiesMap:{},isBank:"",layout:[],startup:function(){this.layout=[];this.gridColumns=["prod_code","sub_prod_code","address","alertlanguage","alert_type","tnx_type_code","issuer_abbv_name","tnx_amount_sign","tnx_currency","tnx_amount","prod_stat_code"];this.propertiesMap={entity:{_fieldName:"entity"},prod_code:{_fieldName:"prod_code"+this.AlertType},sub_prod_code:{_fieldName:"sub_prod_code"+this.AlertType},address:{_fieldName:"address"+this.AlertType},alertlanguage:{_fieldName:"alertlanguage"+this.AlertType},alert_type:{_fieldName:"alert_type"+this.AlertType},tnx_type_code:{_fieldName:"tnx_type_code"+this.AlertType},issuer_abbv_name:{_fieldName:"issuer_abbv_name"+this.AlertType},customer_abbv_name:{_fieldName:"customer_abbv_name"+this.AlertType},tnx_amount_sign:{_fieldName:"tnx_amount_sign"+this.AlertType},tnx_currency:{_fieldName:"tnx_currency"+this.AlertType},tnx_amount:{_fieldName:"tnx_amount"+this.AlertType},prod_stat_code:{_fieldName:"prod_stat_code"+this.AlertType}};if(this.HasEntity==="Y"){this.gridColumns.push("entity");this.layout=[{name:"Entity",field:"entity",width:"10%",noresize:true}];}this.layout.push({name:"ProductCode",field:"prod_code",get:misys.getProductLabel,width:"10%",noresize:true});this.layout.push({name:"SubProductCode",field:"sub_prod_code",get:misys.getSubProductLabel,width:"10%",noresize:true});this.layout.push({name:"TnxTypeCode",field:"tnx_type_code",get:misys.getTypeLabel,width:"5%",noresize:true});this.layout.push({name:"ProdStatCode",field:"prod_stat_code",get:misys.getProdStatCode,width:"10%",noresize:true});if(this.isBank==="Y"){this.gridColumns.push("customer_abbv_name");this.layout.push({name:"Customer",field:"customer_abbv_name",width:"15%",noresize:true});}this.layout.push({name:"Amount",field:"tnx_amount",get:misys.getAmountLabel,width:"10%",noresize:true});if(this.AlertType!=="03"){this.layout.push({name:"Address",field:"address",get:misys.getAddressLabel,width:"15%",noresize:true});}this.layout.push({name:" ",field:"actions",formatter:misys.grid.formatReportActions,width:"5%",noresize:true});this.templateString=dojo.byId("alerts"+this.AlertType+"-template").innerHTML;this.dataList=[];if(this.hasChildren()){dojo.forEach(this.getChildren(),function(_1){var _2;if(this.HasEntity==="Y"){_2={entity:_1.get("entity"),prod_code:_1.get("prod_code"),sub_prod_code:_1.get("sub_prod_code"),address:_1.get("address"),alertlanguage:_1.get("alertlanguage"),alert_type:_1.get("alert_type"),tnx_type_code:_1.get("tnx_type_code"),issuer_abbv_name:_1.get("issuer_abbv_name"),tnx_amount_sign:_1.get("tnx_amount_sign"),tnx_currency:_1.get("tnx_currency"),tnx_amount:_1.get("tnx_amount"),prod_stat_code:_1.get("prod_stat_code")};}else{_2={prod_code:_1.get("prod_code"),sub_prod_code:_1.get("sub_prod_code"),address:_1.get("address"),alertlanguage:_1.get("alertlanguage"),alert_type:_1.get("alert_type"),tnx_type_code:_1.get("tnx_type_code"),issuer_abbv_name:_1.get("issuer_abbv_name"),customer_abbv_name:_1.get("customer_abbv_name"),tnx_amount_sign:_1.get("tnx_amount_sign"),tnx_currency:_1.get("tnx_currency"),tnx_amount:_1.get("tnx_amount"),prod_stat_code:_1.get("prod_stat_code")};}this.dataList.push(_2);},this);}this.inherited(arguments);},openDialogFromExistingItem:function(_3,_4){misys._config=misys._config||{};misys._config.alerts={};dojo.mixin(misys._config.alerts,{tempSubProductCode:_3[0].sub_prod_code[0],tempProdStatCode:_3[0].prod_stat_code[0],tempTypeCode:_3[0].tnx_type_code[0]});this.inherited(arguments);if(dijit.byId("is_customer")&&dijit.byId("is_customer").get("value")==="N"){dijit.byId("issuer_abbv_name01_4").set("checked",true);dijit.byId("issuer_abbv_name01_4").set("disabled",true);}if(dijit.byId("issuer_abbv_name01_4")){if(dijit.byId("issuer_abbv_name01_4").get("checked")){misys.toggleFields(true,["alertlanguage01","address01"],["alertlanguage01","address01"]);misys.animate("fadeIn",dojo.byId("language-address-id-01"));}else{misys.toggleFields(false,["alertlanguage01","address01"],["alertlanguage01","address01"]);misys.animate("fadeOut",dojo.byId("language-address-id-01"));}}else{if(!dijit.byId("issuer_abbv_name01_4")){misys.toggleFields(false,["alertlanguage01","address01"],["alertlanguage01","address01"]);misys.animate("fadeOut",dojo.byId("language-address-id-01"));}}if(dijit.byId("is_customer")&&dijit.byId("is_customer").get("value")==="N"){misys.animate("fadeOut",dojo.byId("issuer_abbv_name01_4_row"));}if(dijit.byId("issuer_abbv_name01_5")){if(dijit.byId("issuer_abbv_name01_5").get("checked")){misys.animate("fadeIn",dojo.byId("contact-person-id-01"));if(dijit.byId("contact_person01")){if(dijit.byId("01entity")&&dijit.byId("01entity").get("value")!==""){dijit.byId("contact_person01").set("value",misys._config.entityEmailCollection[dijit.byId("01entity").get("value")].alertContactPerson);dijit.byId("contact_address01").set("value",misys._config.entityEmailCollection[dijit.byId("01entity").get("value")].alertEmail);}else{if(dijit.byId("01entity")&&dijit.byId("01entity").get("value")===""){dijit.byId("contact_person01").set("value","");dijit.byId("contact_address01").set("value","");}else{dijit.byId("contact_person01").set("value",misys._config.entityEmailCollection["*"].alertContactPerson);dijit.byId("contact_address01").set("value",misys._config.entityEmailCollection["*"].alertEmail);}}}}else{misys.animate("fadeOut",dojo.byId("contact-person-id-01"));}}else{if(!dijit.byId("issuer_abbv_name01_5")){misys.animate("fadeOut",dojo.byId("contact-person-id-01"));}}},addItem:function(){this.inherited(arguments);if(dijit.byId("is_customer")&&dijit.byId("is_customer").get("value")==="N"){dijit.byId("issuer_abbv_name01_4").set("checked",true);dijit.byId("issuer_abbv_name01_4").set("disabled",true);}if(dijit.byId("issuer_abbv_name01_4")){if(dijit.byId("issuer_abbv_name01_4").get("checked")){misys.toggleFields(true,["alertlanguage01","address01"],["alertlanguage01","address01"]);misys.animate("fadeIn",dojo.byId("language-address-id-01"));}else{misys.toggleFields(false,["alertlanguage01","address01"],["alertlanguage01","address01"]);misys.animate("fadeOut",dojo.byId("language-address-id-01"));}}else{if(!dijit.byId("issuer_abbv_name01_4")){misys.toggleFields(false,["alertlanguage01","address01"],["alertlanguage01","address01"]);misys.animate("fadeOut",dojo.byId("language-address-id-01"));}}if(dijit.byId("is_customer")&&dijit.byId("is_customer").get("value")==="N"){misys.animate("fadeOut",dojo.byId("issuer_abbv_name01_4_row"));}if(dijit.byId("issuer_abbv_name01_5")){if(dijit.byId("issuer_abbv_name01_5").get("checked")){misys.animate("fadeIn",dojo.byId("contact-person-id-01"));}else{misys.animate("fadeOut",dojo.byId("contact-person-id-01"));}}else{if(!dijit.byId("issuer_abbv_name01_5")){misys.animate("fadeOut",dojo.byId("contact-person-id-01"));}}},createDataGrid:function(){var _5=this.gridId;if(!_5){_5="grid-"+(this.xmlTagName?this.xmlTagName+"-":"")+dojox.uuid.generateRandomUuid();}this.grid=new misys.grid.DataGrid({jsId:_5,id:_5,store:this.store,structure:this.layout,autoHeight:true,selectionMode:"multiple",columnReordering:true,autoWidth:true,initialWidth:"100%",canSort:function(_6){if(Math.abs(_6)===8){return false;}else{return true;}},showMoveOptions:this.showMoveOptions},document.createElement("div"));this.grid.gridMultipleItemsWidget=this;misys.connect(this.grid,"onStyleRow",dojo.hitch(this,function(_7){var _8=this.grid.getItem(_7.index);if(_8&&_8.hasOwnProperty("is_valid")){var _9=dojo.isArray(_8.is_valid)?_8.is_valid[0]:_8.is_valid;if(_9&&_9!=="Y"){_7.customStyles+="background-color: #F9F7BA !important";this.state="Error";}}this.grid.focus.styleRow(_7);this.grid.edit.styleRow(_7);}));this.addChild(this.grid);this.onGridCreate();}});}