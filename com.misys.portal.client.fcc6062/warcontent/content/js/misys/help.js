/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.help"]){dojo._hasResource["misys.help"]=true;dojo.provide("misys.help");(function(d,dj,m){var _1=".notice";function _2(_3){var _4;if(_3.event!=="execute"){return;}_4=_3.node;if(!_4){return;}m.getHelpData(helpStore.getValue(_4.item,"sectionid"));};function _5(){var _6=[],_7=d.byId("searchInputAnds").value;if(_7){_7=_7.split(" ");d.forEach(_7,function(_8){_6.push(" ",_9(_8));});}return _6.join("");};function _a(){var _b=[],_c=d.byId("searchInputOrs").value;if(_c){_c=_c.split(" ");d.forEach(_c,function(_d){if(_b.length===0){_b.push(" ",_9(_d));}else{_b.push(" OR"+_9(_d));}});}return _b.join("");};function _e(){var _f=[],_10=d.byId("searchInputNots").value;if(_10){_10=_10.split(" ");d.forEach(_10,function(_11){_f.push(" -",_9(_11));});}return _f.join("");};function _12(){var _13=d.byId("searchInputPhrase").value;if(_13){return " \""+_9(_13)+"\"";}return "";};function _9(_14){if(!_14){return "";}var _15="+-&|!(){}[]^\"~*?:\\";d.forEach(_14,function(c){if(_15.indexOf(c)!==-1){_14=_14.replace(c,"\\"+c);}});return _14;};d.mixin(m,{getHelpData:function(_16){var _17=d.position("body",true),_18=d.create("div",{id:"loading-message"},d.byId("GTPRootPortlet"),"first"),_19=d.byId("onlineHelpContent");d.query(_1).forEach(function(_1a){try{d.destroy(noticeMessage);}catch(e){}});d.style(_18,{width:_17.w+"px",height:_17.h+"px"});d.create("p",{innerHTML:onlineHelpLoadingMessage},"loading-message");d.create("div",{id:"loadingProgressBar"},"loading-message");m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetHelpSection?sectionid="+_16),handleAs:"text",contentType:"text/html; charset=utf-8",load:function(_1b,_1c){_19.innerHTML=_1b;d.parser.parse(_19);d.byId("featureid").value=_16;var _1d=d.byId("loading-message");m.animate("fadeOut",_1d,function(){d.destroy(_1d);});}});},editHelpData:function(_1e,id){document.location.href=m.getServletURL("/screen/OnlineHelpScreen?option="+_1e+"&operation=MODIFY_FEATURES&featureid="+id);},deleteHelpData:function(_1f,id,_20){var _21=[{name:"option",value:_1f},{name:"operation",value:"DELETE_FEATURES"},{name:"featureid",value:id},{name:"token",value:_20}];var _22={action:m.getServletURL("/screen/OnlineHelpScreen"),params:_21};m.post(_22);},initHelpTree:function(){d.subscribe("helpTree",_2);},toggleHelpSearchMode:function(){var _23=d.byId("standardSearchContainer"),_24=d.byId("advancedSearchContainer"),_25=d.style(_23,"display");if(_23&&(_25==="block")){d.style(_23,"display","none");dj.byId("search").set("value","");d.style(_24,"display","block");}else{d.style(_23,"display","block");dj.byId("searchInputAnds").set("value","");dj.byId("searchInputOrs").set("value","");dj.byId("searchInputPhrase").set("value","");dj.byId("searchInputNots").set("value","");d.style(_24,"display","none");}},buildLuceneQuery:function(){var _26=_5()+_a()+_e()+_12();if(_26){d.byId("search").value=_26;d.byId("helpSearchForm").submit();}}});d.subscribe("ready",function(){misys.initHelpTree();});})(dojo,dijit,misys);}