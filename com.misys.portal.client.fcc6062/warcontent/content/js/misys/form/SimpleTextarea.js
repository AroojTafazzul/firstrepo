/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.form.SimpleTextarea"]){dojo._hasResource["misys.form.SimpleTextarea"]=true;dojo.provide("misys.form.SimpleTextarea");dojo.experimental("misys.form.SimpleTextarea");dojo.require("dijit.form.SimpleTextarea");dojo.require("dijit.form.ValidationTextBox");dojo.declare("misys.form.SimpleTextarea",[dijit.form.ValidationTextBox,dijit.form.SimpleTextarea],{maxSize:this.maxSize,blnNewRow:false,rowCount:0,postCreate:function(){this.inherited(arguments);},regExp:"(.|\\s)*",validate:function(){if(arguments.length===0){return this.validate(false);}return this.inherited(arguments);},isValid:function(_1){this.invalidMessage=this.messages.invalidMessage;if(!this.validator(this.textbox.value,this.constraints)){return false;}var _2=(this.state==="Error")?false:true;if(false===_1||(true===_1&&!_2)){_2=true;if(this.blnNewRow){if(this.rowCount>=this.maxSize){this.invalidMessage=misys.getLocalization("textareaLinesError",[this.maxSize,this.rowCount+1]);_2=false;}}var _3=(this.maxSize*this.cols)+this.maxSize;if(this.value.length>_3){this.invalidMessage=misys.getLocalization("invalidFieldSizeError",[_3-1,this.value.length]);_2=false;}}return _2;},onBlur:function(_4){var el=(_4==undefined)?this:_4;if(el.value!==""){var _5="";var _6=0;var _7=-1;var _8=el.get("value");var _9=0;var _a=0;var _b=false;var _c=el.cols;var _d=el.maxSize;var _e=false;var _f=misys.getLocalization("g_delExtraLinesTextarea");_8=_8.replace(/(\r\n)+$/,"");_8=_8.replace(/(\n)+$/,"");for(k=0;k<_8.length;k++){strCurrentChar=_8.charAt(k);if((strCurrentChar=="\r")||(strCurrentChar=="\n")){_5+="\n";_6=0;_9++;_b=true;_7=-1;if(strCurrentChar=="\r"){k++;}}else{if(_6==_c){if(_7==-1){_5+="\n";_6=1;}else{_5=_5.slice(0,_5.length-(k-_7)+1)+"\n"+_5.slice(_5.length-(k-_7)+1);_6=k-_7;}_5+=strCurrentChar;_9++;_b=true;_7=-1;}else{_5+=strCurrentChar;_6++;_b=false;}}if(strCurrentChar==" "){_7=k;}if(_b){if(_9>=_d){_e=true;el.set("blnNewRow",_e);el.set("rowCount",_9);if(_f==="true"){el.set("value",_5);}el.validate(false);}}}if(el.maxLength!=""&&el.maxLength>0){if(_5.length>el.maxLength){_5=_5.substring(0,el.maxLength);}}el.set("blnNewRow",_e);el.set("rowCount",_9);el.set("value",_5);}else{var _10=0;el.set("rowCount",_10);}el.validate(false);}});}