/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.bank.report_li"]){dojo._hasResource["misys.binding.bank.report_li"]=true;dojo.provide("misys.binding.bank.report_li");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.file");dojo.require("misys.form.addons");dojo.require("misys.form.SimpleTextarea");dojo.require("dijit.layout.TabContainer");dojo.require("dojo.data.ItemFileReadStore");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.widget.Collaboration");(function(d,dj,m){d.mixin(m,{bind:function(){m.setValidation("iss_date",m.validateIssueDate);m.setValidation("exp_date",m.validateFutureDate);m.setValidation("bol_date",m.validateTransportDocumentDate);m.setValidation("bo_comment",m.bofunction);m.connect("prod_stat_code","onChange",m.toggleOutstandingAmount);m.setValidation("li_cur_code",m.validateCurrency);m.connect("li_cur_code","onChange",function(){m.setCurrency(this,["li_amt"]);});m.connect("li_amt","onBlur",function(){m.setTnxAmt(this.get("value"));});m.connect("li_liab_amt","onBlur",function(){if(dj.byId("li_amt")&&(dj.byId("li_amt").get("value")<dj.byId("li_liab_amt").get("value"))){var _1=function(){var _2=dijit.byId("li_liab_amt");_2.set("state","Error");};m.dialog.show("ERROR",m.getLocalization("LILiabilityAmountCanNotBeGreaterThanLITotalAmount"),"",function(){setTimeout(_1,0);});}});m.connect("bene_type_code","onChange",function(){var _3=this.get("value");m.toggleFields(_3&&_3!=="01"&&_3!=="02",null,["bene_type_other"]);});m.connect("prod_stat_code","onChange",m.toggleProdStatCodeFields);m.connect("prod_stat_code","onChange",function(){var _4=this.get("value");m.toggleFields(_4&&_4!=="01"&&_4!=="18",null,["iss_date","bo_ref_id","li_liab_amt"]);if(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE"){m.toggleRequired("bo_ref_id",false);m.toggleRequired("iss_date",false);m.toggleRequired("li_liab_amt",false);}});m.connect("trans_doc_type_code","onChange",function(){if(dj.byId("trans_doc_type_code").get("value")!=="99"){d.style("trans_doc_type_other_row","display","none");m.toggleRequired("trans_doc_type_other",false);}else{d.style("trans_doc_type_other_row","display","block");m.toggleRequired("trans_doc_type_other",true);}});m.connect("prod_stat_code","onChange",function(){var _5=dj.byId("prod_stat_code").get("value"),_6=dj.byId("li_liab_amt");if(_6&&(_5==="01"||_5==="10"||_5==="06")){_6.set("readOnly",true);_6.set("disabled",true);m.toggleRequired("li_liab_amt",false);dj.byId("li_liab_amt").set("value","");}else{if(_6){_6.set("readOnly",false);_6.set("disabled",false);if(!(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE")){m.toggleRequired("li_liab_amt",true);}dj.byId("li_liab_amt").set("value","");}}if(m._config.enable_to_edit_customer_details_bank_side=="false"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!==""&&dj.byId("li_liab_amt")&&dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").get("value")!=="15"&&dj.byId("tnx_type_code").get("value")!=="13"){m.toggleRequired("li_liab_amt",false);}});},toggleOutstandingAmount:function(){var _7=d.query(".outstanding");if(_7.length===2){var _8=dj.byId(d.attr(_7[1],"widgetid")).get("value")||0;if(this.get("value")==="10"||this.get("value")==="06"){dj.byId(d.attr(_7[1],"widgetid")).set("value",0);dj.byId(d.attr(_7[1],"widgetid")).set("disabled",true);}else{dj.byId(d.attr(_7[1],"widgetid")).set("disabled",false);}}},onFormLoad:function(){m.setCurrency(dj.byId("li_cur_code"),["tnx_amt","li_amt","li_liab_amt"]);if(dj.byId("mode")&&dj.byId("mode").get("value")==="RELEASE"){m.toggleRequired("iss_date",false);m.toggleRequired("li_liab_amt",false);}var _9=dj.byId("bene_type_code");if(_9){var _a=_9.get("value");m.toggleFields(_a&&_a!=="01"&&_a!=="02",null,["bene_type_other"],true);}var _b=dj.byId("trans_doc_type_code");if(_b&&_b.get("value")!=="99"){d.style("trans_doc_type_other_row","display","none");m.toggleRequired("trans_doc_type_other",false);}else{m.toggleRequired("trans_doc_type_other",true);}if(dj.byId("prod_stat_code").get("value")==="01"){m.toggleFields(!(prod_stat_code&&(li_liab_amt||bo_ref_id||iss_date)),null,["iss_date","bo_ref_id","li_liab_amt"],false,false);}if(dj.byId("tnx_type_code")&&(dj.byId("tnx_type_code").get("value")==="15"||(dj.byId("tnx_type_code").get("value")==="13"))&&(m._config.enable_to_edit_customer_details_bank_side=="false")){dojo.style("transactionDetails","display","none");}else{if(m._config.enable_to_edit_customer_details_bank_side=="false"){dojo.style("transactionDetails","display","none");var _c=["exp_date","deal_ref_id","bene_type_code","bene_type_other","entity","applicant_name","applicant_address_line_1","applicant_address_line_2","applicant_dom","applicant_country","applicant_reference","applicant_contact_number","applicant_email","countersign_flag","shipping_by","trans_doc_type_code","bol_number","bol_date","narrative_description_goods","beneficiary_name","beneficiary_address_line_1","beneficiary_address_line_2","beneficiary_dom","beneficiary_country","beneficiary_reference","beneficiary_contact_number","beneficiary_email","goods_desc","li_cur_code","li_amt","li_liab_amt"];d.forEach(_c,function(id){var _d=dj.byId(id);if(_d){m.toggleRequired(_d,false);}});}}},beforeSubmitValidations:function(){if(dj.byId("li_amt")&&dj.byId("li_liab_amt")&&(dj.byId("li_amt").get("value")<dj.byId("li_liab_amt").get("value"))){m._config.onSubmitErrorMsg=m.getLocalization("LILiabilityAmountCanNotBeGreaterThanLITotalAmount");dj.byId("li_liab_amt").set("value","");return false;}return true;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.bank.report_li_client");}