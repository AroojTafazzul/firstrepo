/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.bank.report_freeformat_lc"]){dojo._hasResource["misys.binding.bank.report_freeformat_lc"]=true;dojo.provide("misys.binding.bank.report_freeformat_lc");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.layout.TabContainer");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.addons");dojo.require("misys.form.common");dojo.require("misys.form.file");dojo.require("misys.validation.common");(function(d,dj,m){d.mixin(m,{bind:function(){m.setValidation("template_id",m.validateTemplateId);m.setValidation("exp_date",m.validateTradeExpiryDate);m.setValidation("lc_cur_code",m.validateCurrency);m.connect("lc_cur_code","onChange",function(){m.setCurrency(this,["lc_amt"]);});m.connect("lc_amt","onBlur",function(){m.setTnxAmt(this.get("value"));});m.connect("issuing_bank_abbv_name","onChange",m.populateReferences);if(dj.byId("issuing_bank_abbv_name")){m.connect("entity","onChange",function(){dj.byId("issuing_bank_abbv_name").onChange();});}m.connect("issuing_bank_customer_reference","onChange",m.setApplicantReference);m.connect("prod_stat_code","onChange",m.validateOutstandingAmount);m.connect(dj.byId("prod_stat_code"),"onChange",function(){this.validate();});m.connect("prod_stat_code","onChange",m.toggleProdStatCodeFields);m.connect("prod_stat_code","onChange",function(){var _1=this.get("value");m.toggleFields(_1&&_1!=="01"&&_1!=="18",["action_req_code"],["iss_date","bo_ref_id"]);});m.connect("prod_stat_code","onChange",function(){m.updateOutstandingAmount(dj.byId("lc_liab_amt"),dj.byId("org_lc_liab_amt"));});m.connect("prod_stat_code","onChange",function(){var _2=dj.byId("prod_stat_code").get("value"),_3=dj.byId("lc_liab_amt");if(_3&&(_2==="01"||_2==="10"||_2==="06")){_3.set("readOnly",true);_3.set("disabled",true);}else{if(_3){_3.set("readOnly",false);_3.set("disabled",false);}}if(m._config.enable_to_edit_customer_details_bank_side=="false"&&dj.byId("prod_stat_code")&&dj.byId("prod_stat_code").get("value")!==""){if(dj.byId("lc_liab_amt")&&dj.byId("tnx_type_code")&&dj.byId("tnx_type_code").get("value")!=="15"&&dj.byId("tnx_type_code").get("value")!=="13"){m.toggleRequired("lc_liab_amt",false);}}});m.connect("maturity_date","onBlur",function(){m.validateEnteredGreaterThanCurrentDate();});m.connect("applicable_rules","onChange",function(){m.toggleFields((this.get("value")=="99"),null,["applicable_rules_text"]);});},onFormLoad:function(){m.setCurrency(dj.byId("lc_cur_code"),["lc_amt"]);var _4=dj.byId("applicable_rules");if(_4){m.toggleFields(_4.get("value")=="99",null,["applicable_rules_text"]);}var _5=dj.byId("issuing_bank_abbv_name");if(_5){_5.onChange();}var _6=dj.byId("issuing_bank_customer_reference");if(_6){_6.onChange();}var _7=dj.byId("prod_stat_code"),_8=dj.byId("lc_liab_amt");if(_7&&_7.get("value")==="01"){m.toggleFields(false,["action_req_code"],["iss_date","bo_ref_id"]);}if(_8&&_7&&(_7.get("value")==="01"||_7.get("value")==="10"||_7.get("value")==="06")){_8.set("readOnly",true);_8.set("disabled",true);}else{if(_8){_8.set("readOnly",false);_8.set("disabled",false);}}if(dj.byId("doc_ref_no")&&_7&&(_7.get("value")==="16"||_7.get("value")==="24")){dj.byId("doc_ref_no").set("disabled",false);}else{if(dj.byId("doc_ref_no")){dj.byId("doc_ref_no").set("disabled",true);}}if(dj.byId("tnx_type_code")&&(dj.byId("tnx_type_code").get("value")==="15"||(dj.byId("tnx_type_code").get("value")==="13"))&&(m._config.enable_to_edit_customer_details_bank_side=="false")){dojo.style("transactionDetails","display","none");}else{if(m._config.enable_to_edit_customer_details_bank_side=="false"){dojo.style("transactionDetails","display","none");var _9=["exp_date","expiry_place","entity","applicant_name","applicant_address_line_1","applicant_address_line_2","applicant_dom","applicant_country","applicant_reference","applicant_contact_number","applicant_email","issuing_bank_reference","beneficiary_name","beneficiary_address_line_1","beneficiary_address_line_2","beneficiary_dom","beneficiary_country","beneficiary_reference","beneficiary_contact_number","beneficiary_email","issuing_bank_type_code","issuing_bank_name","issuing_bank_address_line_1","issuing_bank_address_line_2","advising_bank_name","advising_bank_address_line_1","advising_bank_address_line_2","advising_bank_dom","advising_bank_iso_code","advise_thru_bank_iso_code","advise_thru_bank_reference","advising_bank_reference","advise_thru_bank_name","advise_thru_bank_address_line_1","advise_thru_bank_address_line_2","advise_thru_bank_dom","narrative_full_details","lc_amt","pstv_tol_pct","neg_tol_pct","max_cr_desc_code","lc_liab_amt","lc_cur_code"];d.forEach(_9,function(id){var _a=dj.byId(id);if(_a){m.toggleRequired(_a,false);}});}}},beforeSaveValidations:function(){var _b=dj.byId("entity");if(_b&&_b.get("value")===""){return false;}else{return true;}},beforeSubmitValidations:function(){if(dj.byId("lc_amt")){if(!m.validateAmount((dj.byId("lc_amt"))?dj.byId("lc_amt"):0)){m._config.onSubmitErrorMsg=m.getLocalization("amountcannotzero");dj.byId("lc_amt").set("value","");return false;}}return true;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.bank.report_freeformat_lc_client");}