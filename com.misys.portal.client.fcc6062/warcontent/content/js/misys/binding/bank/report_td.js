/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.bank.report_td"]){dojo._hasResource["misys.binding.bank.report_td"]=true;dojo.provide("misys.binding.bank.report_td");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.file");dojo.require("misys.form.addons");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.form.common");dojo.require("misys.widget.Collaboration");dojo.require("misys.validation.common");dojo.require("dojox.xml.DomParser");(function(d,dj,m){function _1(_2){var _3=[],_4=[],_5=dj.byId("tenor_term_code");if(_5&&_2&&_2!=="*"){_5.store=null;var _6=misys._config.depositTypes[_2].tenor;dojo.forEach(_6,function(_7,_8){_3[_8]=misys._config.depositTypes[_2].tenor[_7].key;_4[_8]=misys._config.depositTypes[_2].tenor[_7].value;});jsonData={"identifier":"id","items":[]};productStore=new dojo.data.ItemFileWriteStore({data:jsonData});for(var j=0;j<_3.length;j++){productStore.newItem({"id":_3[j],"name":_4[j]});}_5.store=productStore;_5.set("value","");}};function _9(_a,_b){var _c=[],_d=[],_e=[],_f="";if(dj.byId("td_cur_code")&&_a&&_a!=="*"){_f=dj.byId("td_cur_code");_f.store=null;_e=misys._config.depositTypes[_a].tenor[_b].currency;_e.sort();dojo.forEach(_e,function(_10,_11){_c[_11]=_10;_d[_11]=_10;});jsonData={"identifier":"id","items":[]};productStore=new dojo.data.ItemFileWriteStore({data:jsonData});for(var j=0;j<_c.length;j++){productStore.newItem({"id":_c[j],"name":_d[j]});}_f.store=productStore;_f.set("value","");}};function _12(_13){var _14=[],_15=[],_16=dj.byId("maturity_instruction");_16.store=null;if(_16&&_13&&_13!=="*"){var _17=misys._config.maturityCodes[_13];var _18=misys._config.maturityCodesDescription[_13];for(var i=0;i<_17.length;i++){_14[i]=_17[i];}for(var k=0;k<_18.length;k++){_15[k]=_18[k];}jsonData={"identifier":"id","label":"name","items":[]};productStore=new dojo.data.ItemFileWriteStore({data:jsonData});for(var j=0;j<_14.length;j++){productStore.newItem({"id":_14[j],"name":_15[j]});}_16.store=productStore;_16.set("value","");}};d.mixin(m,{bind:function(){m.connect("td_cur_code","onChange",function(){m.setCurrency(this,["td_amt"]);});m.connect("td_amt","onBlur",function(){m.setTnxAmt(this.get("value"));});m.connect("prod_stat_code","onChange",function(){if(dj.byId("bo_ref_id")){var _19=dj.byId("prod_stat_code").get("value");if(_19==="01"){dj.byId("bo_ref_id").set("readOnly",true);dj.byId("bo_ref_id").set("disabled",true);m.toggleRequired(dj.byId("bo_ref_id"),false);}else{dj.byId("bo_ref_id").set("readOnly",false);dj.byId("bo_ref_id").set("disabled",false);m.toggleRequired(dj.byId("bo_ref_id"),true);}}});if(dj.byId("td_type")){m.connect("td_type","onChange",function(){if(dijit.byId("td_type")&&dijit.byId("td_type").get("value")!==""){var _1a=dijit.byId("td_type").get("value");if(dj.byId("selected_tenor_type")&&dj.byId("selected_tenor_type").get("value")){_1(_1a);}_12(_1a);}});}if(dj.byId("tenor_term_code")){m.connect("tenor_term_code","onChange",function(){if(dj.byId("td_type")&&dj.byId("td_type").get("value")!==""&&dj.byId("tenor_term_code")&&dj.byId("tenor_term_code").get("value")!==""){_9(dj.byId("td_type").get("value"),dijit.byId("tenor_term_code"));}});}if(dj.byId("fx_rates_type_temp")&&dj.byId("fx_rates_type_temp").get("value")!==""){var _1b=0;if(dj.byId("fx_nbr_contracts")&&dj.byId("fx_nbr_contracts").get("value")>0){_1b=dj.byId("fx_nbr_contracts").get("value");}m.bindTheFXTypes(_1b,"Y");}},onFormLoad:function(){var _1c=[],_1d=[],_1e=true,_1f=dj.byId("td_type"),_20="",_21="",_22=-1,_23="";if(_1f){_1f.store=null;dojo.forEach(misys._config.depositTypes,function(_24,_25){var _26=_24.split(",");_1c[_25]=_26[0];_1d[_25]=_26[1];});if(_1f){jsonData={"identifier":"id","label":"name","items":[]};productStore=new dojo.data.ItemFileWriteStore({data:jsonData});for(var j=0;j<_1c.length;j++){productStore.newItem({"id":_1c[j],"name":_1d[j]});}_1f.store=productStore;if(dj.byId("selected_td_type")&&!("S"+dj.byId("selected_td_type").get("value")==="S")){_20=dj.byId("selected_td_type").get("value");dj.byId("td_type").set("value",_20);if((dj.byId("selected_tenor_type")&&!("S"+dj.byId("selected_tenor_type").get("value")==="S"))){tempTenorType=dj.byId("selected_tenor_type").get("value");_1(_20);_21=function(){dj.byId("tenor_term_code").set("value",tempTenorType);};_22=1000;setTimeout(_21,_22);}if((dj.byId("selected_td_cur")&&!("S"+dj.byId("selected_td_cur").get("value")==="S"))){tempCurType=dj.byId("selected_td_cur").get("value");_20=dj.byId("selected_td_type").get("value");tempTenorType=dj.byId("selected_tenor_type").get("value");_9(_20,tempTenorType);_21=function(){dj.byId("td_cur_code").set("value",tempCurType);};_22=1500;setTimeout(_21,_22);}if((dj.byId("selected_maturity_type")&&!("S"+dj.byId("selected_maturity_type").get("value")==="S"))){_23=dj.byId("selected_maturity_type").get("value");if(dj.byId("maturity_instruction")){_12(_20);_21=function(){dj.byId("maturity_instruction").set("value",_23);};_22=1000;setTimeout(_21,_22);}}}else{_1f.set("displayedValue","");}if(d.byId("placement-div")){if(dj.byId("placement_account_enabled")&&dj.byId("placement_account_enabled").get("value")=="Y"){d.style("placement-div","display","block");}else{d.style("placement-div","display","none");}}if(d.byId("interest-rate")){if(dj.byId("service_enabled")&&dj.byId("service_enabled").get("value")=="Y"){d.style("interest-rate","display","block");}else{d.style("interest-rate","display","none");}}}}else{if((dj.byId("selected_td_cur")&&!("S"+dj.byId("selected_td_cur").get("value")==="S"))){dj.byId("td_cur_code").set("displayedValue",dj.byId("selected_td_cur").get("value"));dj.byId("td_amt").set("readOnly",true);}}m.setCurrency(dj.byId("td_cur_code"),["td_amt"]);if(dj.byId("fx_rates_type_temp")&&dj.byId("fx_rates_type_temp").get("value")!==""){m.onloadFXActions();}if(dj.byId("prod_stat_code")&&dj.byId("bo_ref_id")){var _27=dj.byId("prod_stat_code").get("value");if(_27==="01"){dj.byId("bo_ref_id").set("readOnly",true);dj.byId("bo_ref_id").set("disabled",true);m.toggleRequired(dj.byId("bo_ref_id"),false);}}}});m._config=m._config||{};d.mixin(m._config,{xmlTransform:function(xml){var _28=m._config.xmlTagName,_29=_28?["<",_28,">"]:[],_2a="<tnx_td_record>",_2b="</tnx_td_record>",_2c="",_2d="",_2e=-1,_2f=[],_30=[],_31="",_32="",_33="",_34=-1,_35="",_36=[];if(xml.indexOf(_2a)!=-1){_2d=xml.substring(_2a.length,(xml.length-_2b.length));_29.push(_2d);if(dj.byId("maturity_instruction")&&dj.byId("maturity_instruction").get("value")!==""&&(dj.byId("td_type")&&!("S"+dj.byId("td_type").get("value")==="S"))){_2c=dj.byId("maturity_instruction").get("value");_31=dijit.byId("td_type").get("value");_2f=misys._config.maturityCodes[_31];_30=misys._config.maturityCodesDescription[_31];for(var i=0;i<_2f.length;i++){if(_2c===_2f[i]){_2e=i;break;}}_29.push("<maturity_instruction_code>",_2c,"</maturity_instruction_code>");_32=_30[_2e];_29.push("<maturity_instruction_name>",_32,"</maturity_instruction_name>");}if(dj.byId("tenor_term_code")&&dj.byId("tenor_term_code").get("value")!==""&&!("S"+dj.byId("td_type").get("value")==="S")){_33=dj.byId("tenor_term_code").get("value");_36=_33.split("_");_34=_36[0];_35=_36[1];_29.push("<value_date_term_number>",_34,"</value_date_term_number>");_32=_30[_2e];_29.push("<value_date_term_code>",_35,"</value_date_term_code>");}if(_28){_29.push("</",_28,">");}return _29.join("");}else{return xml;}}});})(dojo,dijit,misys);dojo.require("misys.client.binding.bank.report_td_client");}