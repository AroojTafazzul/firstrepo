/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.TradeCreateLaAjaxCall"]){dojo._hasResource["misys.binding.cash.TradeCreateLaAjaxCall"]=true;dojo.provide("misys.binding.cash.TradeCreateLaAjaxCall");_fncAjaxGetRate=function(){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionLA"),handleAs:"json",content:{operation:"REQUEST",applicant_reference:fncGetGlobalVariable("applicant_reference"),la_cur_code:fncGetGlobalVariable("la_cur_code"),la_amt:fncGetGlobalVariable("la_amt"),value_date:fncGetGlobalVariable("value_date"),value_days:fncGetGlobalVariable("value_days"),value_period:fncGetGlobalVariable("value_period"),maturity_date:fncGetGlobalVariable("maturity_date"),maturity_days:fncGetGlobalVariable("maturity_days"),remarks:fncGetGlobalVariable("remarks"),maturity_period:fncGetGlobalVariable("maturity_period")},load:function(_1,_2){dijit.byId("loadingDialog").hide();var _3=_1.status;switch(_3){case 5:_fncGetData(_1);validity=_1.validity;_fncCountdown(validity);fncShowDetailField();break;case 6:fncSetGlobalVariable("trade_id",_1.trade_id);fncSetGlobalVariable("rec_id",_1.rec_id);misys.frequencyStore=_1.delay_frequency;misys.delayStore=_1.delay_timeout;_fncOpenDelayDialog(misys.frequencyStore,misys.delayStore);break;default:_fncManageErrors(_3);break;}},customError:function(_4,_5){dijit.byId("loadingDialog").hide();console.error("[TdAjaxCall] error retrieving quote");_fncManageErrors();}});};_fncPerformDelayRequest=function(_6,_7){if(_6>0){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionLA"),handleAs:"json",content:{operation:"DELAY",rec_id:fncGetGlobalVariable("rec_id"),applicant_reference:fncGetGlobalVariable("applicant_reference"),la_cur_code:fncGetGlobalVariable("la_cur_code"),la_amt:fncGetGlobalVariable("la_amt"),value_date:fncGetGlobalVariable("value_date"),value_days:fncGetGlobalVariable("value_days"),value_period:fncGetGlobalVariable("value_period"),maturity_date:fncGetGlobalVariable("maturity_date"),maturity_days:fncGetGlobalVariable("maturity_days"),remarks:fncGetGlobalVariable("remarks"),maturity_period:fncGetGlobalVariable("maturity_period")},load:function(_8,_9){var _a=_8.status;switch(_a){case 5:_fncGetData(_8);fncCloseDelayDialog();validity=_8.validity;_fncCountdown(validity);fncShowDetailField();break;case 6:fncSetGlobalVariable("rec_id",_8.rec_id);_6--;misys.timer=setTimeout("_fncPerformDelayRequest('"+_6+"','"+_7+"')",(_7*1000));break;default:fncCloseDelayDialog();_fncManageErrors(_a,_8);break;}},customError:function(_b,_c){console.error("[TradeCreateLaAjaxCall] error retrieving quote");_fncManageErrors("",_b);}});}else{_stopCountDown(misys.timer);_fncShowContinuationElement();}};_fncCancelDelayRequest=function(){dijit.byId("buttonAcceptRequest").set("disabled",false);m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionLA"),handleAs:"json",content:{operation:"CANCEL",applicant_reference:dijit.byId("applicant_reference").get("value"),trade_id:fncGetGlobalVariable("trade_id"),rec_id:fncGetGlobalVariable("rec_id")},load:function(_d,_e){fncPerformClear();return;},customError:function(_f,_10){console.error("[TdAjaxCall] error retrieving quote");misys.dialog.show("ERROR",misys.getLocalization("technicalError"));fncPerformClear();}});};fncCancelRequest=function(){dijit.byId("buttonAcceptRequest").set("disabled",false);m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionLA"),handleAs:"json",content:{operation:"REJECT",applicant_reference:dijit.byId("applicant_reference").get("value"),trade_id:fncGetGlobalVariable("trade_id"),rec_id:fncGetGlobalVariable("rec_id")},load:function(_11,_12){fncPerformClear();return;},customError:function(_13,_14){console.error("[TdAjaxCall] error retrieving quote");misys.dialog.show("ERROR",misys.getLocalization("technicalError"));fncPerformClear();}});};_fncGetData=function(_15){dojo.query("#trade_id_report_row .content")[0].innerHTML=_15.trade_id;dojo.query("#rate_report_row .content")[0].innerHTML=_15.rate;dojo.query("#interest_report_row .content")[0].innerHTML=_15.interest;dojo.query("#value_date_report_row .content")[0].innerHTML=_15.value_date;dojo.query("#maturity_date_report_row .content")[0].innerHTML=_15.maturity_date;dijit.byId("trade_id").set("value",_15.trade_id);dijit.byId("rec_id").set("value",_15.rec_id);dijit.byId("remarks").set("value",_15.remarks);fncSetGlobalVariable("trade_id",_15.trade_id);fncSetGlobalVariable("rec_id",_15.rec_id);dijit.byId("rate").set("value",_15.rate);dijit.byId("maturity_date_hidden").set("value",_15.maturity_date);dijit.byId("value_date_hidden").set("value",_15.value_date);dijit.byId("interest").set("value",_15.interest);};_fncManageErrors=function(_16,_17){var _18="";switch(_16){case 20:_18=misys.getLocalization("technicalError");break;default:_18=fncGetCommonMessageError(_16,_17);break;}misys.dialog.show("ERROR",_18);fncPerformClear();};dojo.require("misys.client.binding.cash.TradeCreateLaAjaxCall_client");}