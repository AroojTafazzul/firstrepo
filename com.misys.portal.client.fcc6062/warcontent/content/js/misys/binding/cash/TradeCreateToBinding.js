/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.TradeCreateToBinding"]){dojo._hasResource["misys.binding.cash.TradeCreateToBinding"]=true;dojo.provide("misys.binding.cash.TradeCreateToBinding");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("misys.form.SimpleTextarea");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dojo.data.ItemFileReadStore");dojo.require("misys.form.DateTermField");dojo.require("misys.binding.cash.request.AccountPopup");dojo.require("dojo.parser");fncDoBinding=function(){misys.connect("periode_once","onChange",function(){_fncTogglePeriode("periode_once");});misys.connect("periode_weekly","onChange",function(){_fncTogglePeriode("periode_weekly");});misys.connect("periode_fortnightly","onChange",function(){_fncTogglePeriode("periode_fortnightly");});misys.connect("periode_daily","onChange",function(){_fncTogglePeriode("periode_daily");});misys.connect("periode_monthly","onChange",function(){_fncTogglePeriode("fully");});misys.connect("periode_quaterly","onChange",function(){_fncTogglePeriode("fully");});misys.connect("periode_semi_annual","onChange",function(){_fncTogglePeriode("fully");});misys.connect("periode_annual","onChange",function(){_fncTogglePeriode("fully");});misys.connect("payement_day_weeks","onChange",function(){_fncSetPayementDay(dijit.byId("payement_day_weeks").get("value"));});misys.connect("payement_day_days","onChange",function(){dijit.byId("payement_day").set("value",dijit.byId("payement_day_days").get("value"));});if(dijit.byId("displaymode").get("value")=="edit"){fncSetGlobalVariable("orderingAccountPopupFirstOpening","true");dijit.byId("applicant_act_no_img").set("onClick",function(){fncOpenAccountPopup("orderingAccount","ACT_INTERNAL_ORDERING");});}misys.setValidation("first_payement_date",function(){misys.validateDateGreaterThanHitched=dojo.hitch(this,misys.validateDateGreaterThan);return misys.validateDateGreaterThanHitched(false,"","firstDateGreaterThanDateofDay");});misys.setValidation("next_payement_date",function(){misys.validateDateGreaterThanHitched=dojo.hitch(this,misys.validateDateGreaterThan);if(dijit.byId("first_payement_date").get("value")!=null&&dijit.byId("first_payement_date").get("value")!=""){return misys.validateDateGreaterThanHitched(false,"first_payement_date","nextDateGreaterThanFirstDate");}else{return misys.validateDateGreaterThanHitched(false,"","nextDateGreaterThanDateofDay");}});misys.setValidation("final_payement_date",function(){misys.validateDateGreaterThanHitched=dojo.hitch(this,misys.validateDateGreaterThan);if(dijit.byId("next_payement_date").get("value")!=null&&dijit.byId("next_payement_date").get("value")!=""){return misys.validateDateGreaterThanHitched(false,"next_payement_date","finalDateGreaterThanNexttDate");}else{return misys.validateDateGreaterThanHitched(false,"","finalDateGreaterThanNexttDate");}});misys.connect("to_action","onChange",function(){_fncToggleAction(this.get("value"));});misys.connect("next_payement_date","onChange",function(){_fncSetPaymentDayfromDate();});};fncDoFormOnLoadEvents=function(){if(dijit.byId("tnxtype").get("value")=="01"){_fncTogglePeriode("periode_daily");}else{if(dijit.byId("tnxtype").get("value")=="02"){_fncCheckPaymentDay();_fncInitReview();misys.animate("fadeOut","to-transfer-details");}else{if(dijit.byId("displaymode").get("value")=="view"){_fncInitViewMode();}}}};_fncTogglePeriode=function(_1){if(_1=="periode_once"&&dijit.byId("periode_once").checked){_fncRequiredFalse(["payement_day_weeks","payement_day_days","to_cur_code","to_cur_code","to_amt","next_payement_date"]);_clearFields(["next_payement_date","to_amt","final_payement_date","final_payement_amt"]);misys.animate("fadeOut","periode-div");misys.animate("fadeOut","final-payement-div");_fncRequiredTrue(["first_payement_date","first_payement","first_payement_cur_code","first_payement_amt"]);}else{if((_1=="periode_weekly"||_1=="periode_fortnightly")&&(dijit.byId("periode_weekly").checked||dijit.byId("periode_fortnightly").checked)){_fncRequiredFalse(["first_payement_date","first_payement","first_payement_cur_code","first_payement_amt","payement_day_days"]);misys.animate("fadeIn","periode-div");misys.animate("fadeIn","final-payement-div");misys.animate("fadeOut","payement-day-days");misys.animate("fadeIn","payement-day-weeks");_fncRequiredTrue(["to_cur_code","to_cur_code","to_amt","next_payement_date","payement_day_weeks"]);_fncSetPayementDay(dijit.byId("payement_day_weeks").get("value"));}else{if(_1=="periode_daily"&&dijit.byId("periode_daily").checked){_fncRequiredFalse(["first_payement_date","first_payement","first_payement_cur_code","first_payement_amt","payement_day_weeks"]);misys.animate("fadeIn","periode-div");misys.animate("fadeIn","final-payement-div");misys.animate("fadeOut","payement-day-weeks");misys.animate("fadeIn","payement-day-days");dijit.byId("payement_day_days").set("requiered",false);dijit.byId("payement_day_days").set("disabled",true);_fncRequiredTrue(["to_cur_code","to_cur_code","to_amt","next_payement_date","payement_day_days"]);_fncSetPayementDay(dijit.byId("payement_day_weeks").get("value"));}else{if(_1=="fully"&&(dijit.byId("periode_annual").checked||dijit.byId("periode_semi_annual").checked||dijit.byId("periode_monthly").checked||dijit.byId("periode_quaterly").checked)){misys.animate("fadeIn","periode-div");misys.animate("fadeIn","final-payement-div");misys.animate("fadeOut","payement-day-weeks");misys.animate("fadeIn","payement-day-days");if(dijit.byId("tnxtype").get("value")=="01"){dijit.byId("payement_day_days").set("disabled",false);}_fncRequiredTrue(["to_cur_code","to_cur_code","to_amt","next_payement_date","payement_day_days"]);_fncRequiredFalse(["first_payement_date","first_payement","first_payement_cur_code","first_payement_amt","payement_day_weeks"]);}}}}};_clearFields=function(_2){dojo.forEach(_2,function(id){fncClearField(id);});};fncClearField=function(_3){var _4=dijit.byId(_3);if(_4){var _5=_4.declaredClass;if(_5=="dijit.form.CheckBox"){_4.set("checked",false);}else{if(_5=="dijit.form.DateTextBox"||_5=="dijit.form.TimeTextBox"){_4.set("value",null);}else{_4.set("value","");}}}};_fncRequiredTrue=function(_6){dojo.forEach(_6,function(id){var _7=dijit.byId(id);if(_7){misys.toggleRequired(_7,true);}});};_fncRequiredFalse=function(_8){dojo.forEach(_8,function(id){var _9=dijit.byId(id);if(_9){misys.toggleRequired(_9,false);}});};_fncSetPayementDay=function(_a){if(_a=="MO"){_a="01";}else{if(_a=="TU"){_a="02";}else{if(_a=="WE"){_a="03";}else{if(_a=="TH"){_a="04";}else{if(_a=="FR"){_a="05";}else{if(_a=="SA"){_a="06";}else{if(_a=="SU"){_a="07";}}}}}}}dijit.byId("payement_day").set("value",_a);};_fncSetPaymentDayfromDate=function(){if(dijit.byId("periode_annual").checked||dijit.byId("periode_semi_annual").checked||dijit.byId("periode_monthly").checked||dijit.byId("periode_quaterly").checked){dijit.byId("payement_day_days").set("value",dijit.byId("next_payement_date").get("displayedValue").split("/")[0]);}};fillAccountField=function(_b,_c){if(_b=="orderingAccount"){dijit.byId("applicant_reference").set("value",_c.customer_ref);dijit.byId("applicant_act_no").set("value",_c.account_no);dijit.byId("applicant_act_name").set("value",_c.name);dijit.byId("applicant_act_cur_code").set("value",_c.cur_code);dijit.byId("to_cur_code").set("value",_c.cur_code);dijit.byId("first_payement_cur_code").set("value",_c.cur_code);dijit.byId("final_payement_cur_code").set("value",_c.cur_code);}else{if(_b=="beneficiaryAccount"){dijit.byId("transfer_account").set("value",_c.account_no);dijit.byId("transfer_account_cur_code").set("value",_c.cur_code);}}};_fncInitReview=function(){dijit.byId("applicant_act_no_img").set("style","display:none");if(dijit.byId("periode_once").checked){_fncTogglePeriode("periode_once");}else{if(dijit.byId("periode_weekly").checked){_fncTogglePeriode("periode_weekly");dijit.byId("payement_day_weeks").setDisplayedValue(_fncSetPaymentDayWeeks(dijit.byId("payement_day").get("value")));}else{if(dijit.byId("periode_fortnightly").checked){_fncTogglePeriode("periode_fortnightly");dijit.byId("payement_day_weeks").setDisplayedValue(_fncSetPaymentDayWeeks(dijit.byId("payement_day").get("value")));}else{if(dijit.byId("periode_daily").checked){_fncTogglePeriode("periode_daily");}else{if(dijit.byId("periode_monthly").checked||dijit.byId("periode_quaterly").checked||dijit.byId("periode_semi_annual").checked||dijit.byId("periode_annual").checked){_fncTogglePeriode("fully");dijit.byId("payement_day_days").setDisplayedValue(dijit.byId("payement_day").get("value"));}}}}}var _d=new Date();var _e=new dijit.form.DateTextBox({id:"dateOfDay",value:_d},"myDate");if(_fncCompareDateFields(dijit.byId("first_payement_date"),dijit.byId("dateOfDay"))){dijit.byId("first_payement_date").set("disabled",true);dijit.byId("first_payement_amt").set("disabled",true);}if(_fncCompareDateFields(dijit.byId("next_payement_date"),dijit.byId("dateOfDay"))){dijit.byId("next_payement_date").set("disabled",true);dijit.byId("to_amt").set("disabled",true);dijit.byId("payement_day_days").set("disabled",true);dijit.byId("payement_day_weeks").set("disabled",true);}};_fncCheckPaymentDay=function(){value=dijit.byId("payement_day").get("value");if(value.length=="1"){dijit.byId("payement_day").set("value","0"+value);}};_fncSetPaymentDayWeeks=function(_f){if(_f=="01"){_f="Monday";}else{if(_f=="02"){_f="Tuedsay";}else{if(_f=="03"){_f="Wednesday";}else{if(_f=="04"){_f="Thursday";}else{if(_f=="05"){_f="Friday";}else{if(_f=="06"){_f="Saturday";}else{if(_f=="07"){_f="Sunday";}}}}}}}return _f;};_fncToggleAction=function(_10){if(_10=="18"){misys.animate("fadeIn","to-transfer-details");_fncInitReview();}else{if(_10=="22"){_fncRequiredFalse(["payement_day_weeks","payement_day_days","to_cur_code","to_cur_code","to_amt","next_payement_date","first_payement_date","first_payement","first_payement_cur_code","first_payement_amt"]);misys.animate("fadeOut","to-transfer-details");}}dijit.byId("sub_tnx_type_code").set("value",_10);};_fncInitViewMode=function(){dojo.query("#periodicity-div .content").forEach(function(_11){var _12=_11.innerHTML;if(_12=="Once"){dojo.style("payement-day-weeks","display","none");dojo.style("payement-day-days","display","none");}else{if(_12=="Weekly"||_12=="Fortnighly"){dojo.style("payement-day-days","display","none");dojo.query("#payement-day-weeks .content").forEach(function(_13){_13.innerHTML=_fncSetPaymentDayWeeks(dijit.byId("payement_day").get("value"));});}else{dojo.style("payement-day-weeks","display","none");dojo.query("#payement-day-days .content").forEach(function(_14){_14.innerHTML=dijit.byId("payement_day").get("value");});}}});};dojo.require("misys.client.binding.cash.TradeCreateToBinding_client");}