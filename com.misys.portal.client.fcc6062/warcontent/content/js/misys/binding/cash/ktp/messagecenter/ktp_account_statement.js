/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.ktp.messagecenter.ktp_account_statement"]){dojo._hasResource["misys.binding.cash.ktp.messagecenter.ktp_account_statement"]=true;dojo.provide("misys.binding.cash.ktp.messagecenter.ktp_account_statement");dojo.require("misys.binding.cash.ktp.common.ktp_common");(function(d,dj,m){var _1;var _2;function _3(_4,_5){var _6=_4.indexOf("?");var _7=(_6===-1?_4.substring(_6):_4);var _8=_7.split("&");var _9="";d.forEach(_8,function(_a){if(_a.indexOf(_5)!==-1){_6=_a.indexOf("=");if(_6!==-1){_9=_a.substring(_6+1);}}});return _9;};function _b(){if((dj.byId("DU").get("value")!==""&&dj.byId("AU").get("value")!=="")&&(dj.byId("DU").get("value")!==null&&dj.byId("AU").get("value")!==null)){var _c=dj.byId("DU");var to=dj.byId("AU");if(!m.compareDateFields(_c,to)){_2=m.getLocalization("toDateGreaterThanFromDateError",[dj.byId("AU").get("displayedValue"),dj.byId("DU").get("displayedValue")]);dj.byId("AU").set("state","Error");dj.hideTooltip(dj.byId("AU").domNode);m.showTooltip(_2,d.byId("AU"));return false;}}};function _d(){if((dj.byId("DU").get("value")!==""&&dj.byId("AU").get("value")!=="")&&(dj.byId("DU").get("value")!==null&&dj.byId("AU").get("value")!==null)){var _e=dj.byId("DU");var to=dj.byId("AU");if(!m.compareDateFields(_e,to)){_2=m.getLocalization("fromDateLessThanToDateError",[dj.byId("DU").get("displayedValue"),dj.byId("AU").get("displayedValue")]);dj.byId("DU").set("state","Error");dj.hideTooltip(dj.byId("DU").domNode);m.showTooltip(_2,d.byId("DU"));return false;}}};function _f(){if(dj.byId("MontantMinMaxvisible")&&dj.byId("MontantMinMax2visible")&&(dj.byId("MontantMinMaxvisible").get("value")>dj.byId("MontantMinMax2visible").get("value"))){_1=m.getLocalization("maxAmountGreaterThanMinAmountError",[dj.byId("MontantMinMaxvisible").get("displayedValue"),dj.byId("MontantMinMax2visible").get("displayedValue")]);dj.byId("MontantMinMaxvisible").set("state","Error");dj.hideTooltip(dj.byId("MontantMinMaxvisible").domNode);m.showTooltip(_1,d.byId("MontantMinMaxvisible"));return false;}};function _10(){if(dj.byId("MontantMinMaxvisible")&&dj.byId("MontantMinMax2visible")&&(dj.byId("MontantMinMax2visible").get("value")<dj.byId("MontantMinMaxvisible").get("value"))){_1=m.getLocalization("maxAmountGreaterThanMinAmountError",[dj.byId("MontantMinMax2visible").get("displayedValue"),dj.byId("MontantMinMaxvisible").get("displayedValue")]);dj.byId("MontantMinMax2visible").set("state","Error");dj.hideTooltip(dj.byId("MontantMinMax2visible").domNode);m.showTooltip(_1,d.byId("MontantMinMax2visible"));return false;}};d.mixin(m,{bind:function(){setTimeout(function(){m.connect("entity","onChange",function(){dj.byId("ACCOUNT_NO").set("value","");});},3000);m.connect("MontantMinMaxvisible","onBlur",function(){_f();});m.connect("MontantMinMax2visible","onBlur",function(){_10();});m.connect("DU","onBlur",function(){_d();});m.connect("AU","onBlur",function(){_b();});},onFormLoad:function(){var url=window.location.href;var _11=_3(url,"ktpaccountno");if(_11!==""){var _12=dj.byId("ACCOUNT_NO");_12.set("value",_11);_12.set("readOnly",true);m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/RetrieveEntityNameFromCustomerReferenceAction"),sync:true,handleAs:"json",content:{ktpaccountno:_11},load:function(_13,_14){if(_13.entityAbbvName&&_13.entityAbbvName!==""){dj.byId("entity").set("value",_13.entityAbbvName);dj.byId("ACCOUNT_NO").set("value",_11);}},error:function(_15,_16){m.dialog.show("ERROR",m.getLocalization("retrieveEntityNameError"),"");}});}}});d.ready(function(){m.hideReportDescription();m.setGridCellFormatter();var _17=m.searchGridLayout();if(_17){var _18=m.searchGridLayoutCellByFieldName(_17,"LIBELLE");d.mixin(_18,{formatter:misys.ibanFormatter});}});})(dojo,dijit,misys);}