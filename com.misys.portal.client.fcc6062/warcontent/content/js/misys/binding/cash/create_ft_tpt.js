/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.create_ft_tpt"]){dojo._hasResource["misys.binding.cash.create_ft_tpt"]=true;dojo.provide("misys.binding.cash.create_ft_tpt");dojo.require("dojo.parser");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("misys.form.PercentNumberTextBox");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.common");dojo.require("misys.form.file");dojo.require("misys.validation.common");dojo.require("misys.binding.cash.ft_common");dojo.require("misys.form.BusinessDateTextBox");dojo.require("misys.binding.core.beneficiary_advice_common");dojo.require("misys.binding.common.create_fx_multibank");dojo.require("misys.binding.cash.paymentFees");(function(d,dj,m){var _1=d.byId("fx-message-type");var _2=false;var _3=true;var _4=false;var _5="<style='width:800px;height:1000px;overflow:auto;'>";var _6="<b><span class='legend'>";var _7="</span></b>";var _8="fx-section";function _9(){var _a="";_a=_a.concat(_5);_a=_a.concat(_6+m.getLocalization("generalDetails")+_7);var _b=dijit.byId("entity")?dijit.byId("entity").get("value"):"";var _c=m.getLocalization("entityDetails",[_b]);var _d=dijit.byId("applicant_act_name")?dijit.byId("applicant_act_name").get("value"):"";var _e=m.getLocalization("debitActDetails",[_d]);_a=_a+_c+_e;return _a;};function _f(){var _10="";_10=_10.concat(_5);_10=_10.concat(_6+m.getLocalization("transferToDetails")+_7);var _11=dijit.byId("beneficiary_name")?dijit.byId("beneficiary_name").get("value"):"";var _12=m.getLocalization("creditActDetails",[_11]);_10=_10+_12;return _10;};function _13(){var _14="";_14=_14.concat(_5);_14=_14.concat(_6+m.getLocalization("transactionDetails")+_7);var _15=dijit.byId("ft_amt")?dijit.byId("ft_amt").get("value"):"";var _16=dijit.byId("ft_cur_code")?dijit.byId("ft_cur_code").get("value"):"";var _17=m.getLocalization("transferAmtDetail",[_16,_15]);var _18=dijit.byId("iss_date")?dijit.byId("iss_date").get("value"):"";var _19=m.getLocalization("transferDateDetails",[_18]);_14=_14+_17+_19;return _14;};function _1a(_1b){var amt=_1b.totalFeeAmount;var ccy=_1b.debitAccountCurrency;var _1c=_1b.debitFeeAmount;var _1d=_1b.taxOnDebitFees;var _1e=_1b.taxOnTaxOnDebitFees;var _1f=_1b.agentFees;var _20=m.getLocalization("totalCharges",[ccy,amt]);var _21=m.getLocalization("debitFeeAmountCharges",[ccy,_1c]);var _22=m.getLocalization("taxOnDebitFeesCharges",[ccy,_1d]);var _23=m.getLocalization("taxOnTaxOnDebitFeesCharges",[ccy,_1e]);var _24=m.getLocalization("agentFeesCharges",[ccy,_1f]);var _25="";_25=_25.concat(_5);_25=_25.concat(_6+m.getLocalization("feesDetails")+_7);_25=_25+_20+_21+_22+_23+_24;return _25;};function _26(_27){var _28=function(){var _29=dijit.byId("ft_amt");_29.set("state","Error");m.defaultBindTheFXTypes();dj.byId("ft_amt").set("value","");if(dj.byId("ft_cur_code")&&!dj.byId("ft_cur_code").get("readOnly")){dj.byId("ft_cur_code").set("value","");}};m.dialog.show("ERROR",_27,"",function(){setTimeout(_28,500);});if(d.byId(_8)&&(d.style(d.byId(_8),"display")!=="none")){m.animate("wipeOut",d.byId(_8));}};function _2a(){var _2b=null;var _2c=dj.byId("customer_bank").get("value");if(misys&&misys._config&&misys._config.businessDateForBank&&misys._config.businessDateForBank[_2c]&&misys._config.businessDateForBank[_2c][0]&&misys._config.businessDateForBank[_2c][0].value!==""){var _2d=misys._config.businessDateForBank[_2c][0].value;var _2e=_2d.substring(0,4);var _2f=_2d.substring(5,7);var _30=_2d.substring(8,10);_2d=_30+"/"+_2f+"/"+_2e;var _31=new Date(_2e,_2f-1,_30);if(dj.byId("option_for_tnx")&&dj.byId("option_for_tnx").get("value")==="SCRATCH_TPT"){dj.byId("appl_date").set("value",_2d);document.getElementById("appl_date_view_row").childNodes[1].innerHTML=_2d;dj.byId("appl_date_hidden").set("value",_31);}dj.byId("todays_date").set("value",_31);}if(!_2&&!_3){dj.byId("applicant_act_name").set("value","");dj.byId("beneficiary_name").set("value","");dj.byId("beneficiary_act_cur_code").set("value","");dj.byId("beneficiary_account").set("value","");dj.byId("ft_cur_code").set("value","");dj.byId("ft_amt").set("value","");dj.byId("iss_date").set("value",null);dj.byId("issuing_bank_abbv_name").set("value",_2c);_2b=misys._config.customerBankDetails[_2c][0].value;dj.byId("issuing_bank_name").set("value",_2b);m.setApplicantReference();}if(!_2){dj.byId("issuing_bank_abbv_name").set("value",_2c);_2b=misys._config.customerBankDetails[_2c][0].value;dj.byId("issuing_bank_name").set("value",_2b);}_2=false;if(dj.byId("customer_bank")&&_2c!==""){_3=false;if(dj.byId("issuing_bank_abbv_name").get("value")!==""){_2b=misys._config.customerBankDetails[_2c][0].value;dj.byId("issuing_bank_name").set("value",_2b);}}m.initializeFX(dj.byId("sub_product_code").get("value"),dj.byId("issuing_bank_abbv_name").get("value"));if(dj.byId("applicant_act_cur_code")&&dj.byId("applicant_act_cur_code").get("value")!==""&&dj.byId("ft_cur_code")&&dj.byId("ft_cur_code").get("value")!==""&&dj.byId("applicant_act_cur_code").get("value")!==dj.byId("ft_cur_code").get("value")&&!isNaN(dj.byId("ft_amt").get("value"))){m.onloadFXActions();}else{m.defaultBindTheFXTypes();}_32();};function _32(){var _33=dj.byId("sub_product_code").get("value");if(dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""&&m._config.fxParamData&&m._config.fxParamData[_33][dj.byId("issuing_bank_abbv_name").get("value")].isFXEnabled==="Y"){m.connect("ft_cur_code","onChange",function(){m.setCurrency(this,["ft_amt"]);if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{if(d.byId(_8)&&(d.style(d.byId(_8),"display")!=="none")){m.animate("wipeOut",d.byId(_8));}m.defaultBindTheFXTypes();}});m.connect("ft_cur_code","onChange",function(){if(dj.byId("iss_date")&&dj.byId("iss_date").get("value")!==""){dj.byId("iss_date").validate();}if(dj.byId("recurring_start_date")&&dj.byId("recurring_start_date").get("value")!==""){dj.byId("recurring_start_date").validate();}m.setCurrency(this,["ft_amt"]);if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});m.connect("ft_amt","onBlur",function(){m.setTnxAmt(this.get("value"));var _34="";if(dj.byId("ft_cur_code")){_34=dj.byId("ft_cur_code").get("value");}if(!isNaN(dj.byId("ft_amt").get("value"))&&_34!==""){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});}else{if(d.byId(_8)){d.style(_8,"display","none");}}if(dijit.byId("ft_cur_code")&&dijit.byId("ft_amt")){misys.setCurrency(dijit.byId("ft_cur_code"),["ft_amt"]);}};function _35(){var _36=true;var _37="";var _38=dj.byId("fx_rates_type_2");var _39=dj.byId("fx_total_utilise_amt");var _3a=dj.byId("ft_amt");var _3b=m._config.fxParamData[dj.byId("sub_product_code").get("value")][dj.byId("issuing_bank_abbv_name").get("value")].maxNbrContracts;if(_38.get("checked")&&_39&&!isNaN(_39.get("value"))&&_3a&&!isNaN(_3a.get("value"))){if(_3a.get("value")<_39.get("value")){_37+=m.getLocalization("FXUtiliseAmtGreaterMessage");_36=false;}}m._config.onSubmitErrorMsg=_37;if(_38.get("checked")&&_39&&_3a){var _3c=0;for(var j=1;j<=_3b;j++){var _3d="fx_contract_nbr_amt_"+j;_3c=_3c+dj.byId(_3d).get("value");if(dj.byId(_3d).get("state")==="Error"||_3c.toFixed(2)>_39.get("value")){dj.byId(_3d).set("state","Error");dj.byId(_3d).focus();_36=false;}}}return _36;};var _3e,_3f={};_3f.fields=["beneficiary_name","beneficiary_account","beneficiary_act_cur_code","beneficiary_address","beneficiary_city","beneficiary_dom","cpty_bank_code","cpty_bank_name","cpty_bank_swift_bic_code","cpty_bank_address_line_1","cpty_bank_address_line_2","cpty_bank_dom","cpty_branch_code","cpty_branch_name","pre_approved"];_3f.toggleReadonly=function(_40){m.toggleFieldsReadOnly(this.fields,_40);};_3f.clear=function(){d.forEach(this.fields,function(_41,i){if(dj.byId(_41)){dj.byId(_41).set("value","");}});d.style("PAB","display","none");};function _42(){var _43=dj.byId("applicant_act_pab").get("value");if(_43==="Y"){_3f.toggleReadonly(true);}else{_3f.toggleReadonly(false);}if(document.getElementById("FTCurrSrch")){d.style("FTCurrSrch","display","inline");}d.style("PAB","display","none");_3f.clear();dj.byId("pre_approved_status").set("value","N");m.clearBeneficiaryAdviceFieldsForDefaultingFromBeneMaster();};function _44(){var _45=dj.byId("regexValue");var _46=dj.byId("allowedProducts");var _47=_45?dj.byId("regexValue").get("value"):"";var _48=_46?dj.byId("allowedProducts").get("value"):"";var _49="TPT";var _4a=dj.byId("beneficiary_name");var _4b=_4a?dj.byId("beneficiary_name").get("value"):"";var _4c=new RegExp(_47);var _4d=false;if(_48.indexOf(_49)<0){if(_47!==null&&_47!==""&&_4b!==""&&_4b!==null){_4d=_4c.test(_4b);if(!_4d){this.invalidMessage=m.getLocalization("invalidBeneficiaryName");return false;}}}else{m._config.forceSWIFTValidation=false;}return true;};function _4e(){var _4f=dj.byId("beneficiary_name").get("value");if(_4f!==""){if(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y"){if(m._config.non_pab_allowed){d.style("PAB","display","inline");}else{d.style("PAB","display","none");}if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}_3f.toggleReadonly(true);}else{d.style("PAB","display","none");if((dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")==="")||(dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")===null)){_3f.toggleReadonly(false);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}}else{_3f.toggleReadonly(true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}}}}};function _50(){var _51=dj.byId("notify_beneficiary").get("checked");var _52=dj.byId("notify_beneficiary_choice_1");var _53=dj.byId("notify_beneficiary_choice_2");var _54=dj.byId("notify_beneficiary_email");_52.set("disabled",!_51);_53.set("disabled",!_51);_54.set("disabled",true);_52.set("checked",_51);_53.set("checked",false);_54.set("value","");var _55=d.byId("notify_beneficiary_email_node");var _56=d.byId("label_notify_beneficiary_choice_1");d.place(_55,_56,"after");var _57=dj.byId("bene_email_1").get("value");if(!_57){_57=dj.byId("bene_email_2").get("value");}if(_57&&_51){_54.set("value",_57);_54.set("readOnly",true);}if(!_57&&_51){if(dj.byId("beneficiary_name")&&dj.byId("beneficiary_name").get("value")===""){m.dialog.show("ERROR",m.getLocalization("noBeneficiaryEmail"));}_53.set("checked",true);var _58=d.byId("label_notify_beneficiary_choice_2");d.place(_55,_58,"after");_54.set("disabled",false);}m.toggleRequired("notify_beneficiary_email",_51);m.toggleRequired("notify_beneficiary_choice_1",_51);m.toggleRequired("notify_beneficiary_choice_2",_51);};function _59(){var _5a=dj.byId("notify_beneficiary_choice_2").get("checked")&&!dj.byId("notify_beneficiary_choice_2").get("disabled");var _5b=dj.byId("notify_beneficiary_email");var _5c=dj.byId("notify_beneficiary_choice_2");var _5d=d.byId("notify_beneficiary_email_node");var _5e=d.byId("label_notify_beneficiary_choice_1");var _5f=d.byId("label_notify_beneficiary_choice_2");var _60=dj.byId("bene_email_1").get("value");if(!_60){_60=dj.byId("bene_email_2").get("value");}if(_5a){d.place(_5d,_5f,"after");_5b.set("disabled",false);}else{if(!_60){m.dialog.show("ERROR",m.getLocalization("noBeneficiaryEmail"));_5c.set("checked",true);_5b.set("disabled",false);}else{d.place(_5d,_5e,"after");}}if(_60&&!_5a){_5b.set("value",_60);_5b.set("readOnly",true);}else{_5b.set("value","");_5b.set("readOnly",false);_5b.set("disabled",false);}};function _61(){var _62=dj.byId("applicant_act_pab").get("value");if(_62==="Y"){dj.byId("beneficiary_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",true);}else{if(m._config.non_pab_allowed){dj.byId("beneficiary_name").set("readOnly",false);dj.byId("beneficiary_act_cur_code").set("readOnly",false);dj.byId("beneficiary_account").set("readOnly",false);}else{dj.byId("beneficiary_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",true);}}dojo.forEach(["pre_approved","beneficiary_account","beneficiary_act_cur_code","beneficiary_address","beneficiary_city","","beneficiary_dom","pre_approved_status","","","cpty_bank_name","cpty_bank_address_line_1","cpty_bank_address_line_2","cpty_bank_dom","cpty_branch_address_line_1","cpty_branch_address_line_2","cpty_branch_dom","","","cpty_bank_swift_bic_code","cpty_bank_code","cpty_branch_code","cpty_branch_name","","beneficiary_name","","","bene_adv_beneficiary_id_no_send","bene_adv_mailing_name_add_1_no_send","bene_adv_mailing_name_add_2_no_send","bene_adv_mailing_name_add_3_no_send","bene_adv_mailing_name_add_4_no_send","bene_adv_mailing_name_add_5_no_send","bene_adv_mailing_name_add_6_no_send","bene_adv_postal_code_no_send","bene_adv_country_no_send","bene_email_1","bene_email_2","beneficiary_postal_code","beneficiary_country","bene_adv_fax_no_send","bene_adv_ivr_no_send","bene_adv_phone_no_send"],function(_63){if(dj.byId(_63)){dj.byId(_63).set("value","");}});if(d.byId(_8)&&(d.style(d.byId(_8),"display")!=="none")){m.animate("wipeOut",d.byId(_8));}dj.byId("ft_cur_code").set("value",dj.byId("applicant_act_cur_code").get("value"));dj.byId("beneficiary_act_cur_code").set("value",dj.byId("applicant_act_cur_code").get("value"));d.style("PAB","display","none");if(d.byId("clear_img")){if(_62==="Y"&&d.style(d.byId("clear_img"),"display")!=="none"){m.animate("wipeOut",d.byId("clear_img"));}else{if(_62==="N"&&d.style(d.byId("clear_img"),"display")==="none"){m.animate("wipeIn",d.byId("clear_img"));}}}};function _64(){var _65=dj.byId("applicant_act_no").get("value");if(_65===""){m.dialog.show("ERROR",m.getLocalization("selectDebitFirst"));return;}var _66=dj.byId("entity")?dj.byId("entity").get("value"):"";var _67=dijit.byId("sub_product_code").get("value");m.showSearchDialog("beneficiary_accounts","['beneficiary_name','beneficiary_account','beneficiary_act_cur_code', 'beneficiary_address', 'beneficiary_city', '', 'beneficiary_dom', 'pre_approved_status','','', "+"'cpty_bank_name', 'cpty_bank_address_line_1', 'cpty_bank_address_line_2', 'cpty_bank_dom', 'cpty_branch_address_line_1', 'cpty_branch_address_line_2', 'cpty_branch_dom','','', "+"'cpty_bank_swift_bic_code', 'cpty_bank_code', 'cpty_branch_code', 'cpty_branch_name', 'pre_approved', '','','bene_adv_beneficiary_id_no_send', "+"'bene_adv_mailing_name_add_1_no_send','bene_adv_mailing_name_add_2_no_send','bene_adv_mailing_name_add_3_no_send','bene_adv_mailing_name_add_4_no_send', "+"'bene_adv_mailing_name_add_5_no_send','bene_adv_mailing_name_add_6_no_send','bene_adv_postal_code_no_send','bene_adv_country_no_send','bene_email_1',"+"'bene_email_2','beneficiary_postal_code','beneficiary_country', 'bene_adv_fax_no_send', 'bene_adv_phone_no_send', 'beneficiary_nickname']",{product_type:_67,entity_name:_66,pabAccStat:dijit.byId("applicant_act_pab").get("value"),debitAcctNo:_65},"",_67,"width:710px;height:350px;",m.getLocalization("ListOfBeneficiriesTitleMessage"));if(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y"){if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}}else{d.style("PAB","display","none");}d.style("FTCurrSrch","display","none");};function _68(){var _69="";var _6a,_6b;if(dj.byId("applicant_act_cur_code")&&dj.byId("applicant_act_cur_code").get("value")!==""){_6a=dj.byId("applicant_act_cur_code").get("value");}if(dj.byId("beneficiary_act_cur_code")&&dj.byId("beneficiary_act_cur_code").get("value")!==""){_6b=dj.byId("beneficiary_act_cur_code").get("value");}if(_6a&&_6b&&dj.byId("ft_cur_code")){_69=dj.byId("ft_cur_code");_69.store=null;var _6c={"identifier":"id","items":[]};var _6d=new dojo.data.ItemFileWriteStore({data:_6c});if(_6a!==_6b){_6d.newItem({"id":_6a,"name":_6a});_6d.newItem({"id":_6b,"name":_6b});_69.store=_6d;}else{_6d.newItem({"id":_6b,"name":_6b});_69.store=_6d;}dj.byId("ft_cur_code").set("displayedValue",_6b);}};function _6e(){var _6f=dj.byId("sub_product_code"),_70=dj.byId("beneficiary_account"),_71=dj.byId("beneficiary_act_cur_code");var _72=false;m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/ValidateBeneficiaryMasterAccount"),handleAs:"json",sync:true,content:{account_number:_70.get("value"),account_cur_code:_71.get("value"),sub_product_code:_6f.get("value")},load:function(_73,_74){switch(_73.items.StatusCode){case "OK":_71.set("value",_73.items.AcctCur);_72=true;break;case "ERR_INVALID_ACCOUNT_NUMBER":_3e=misys.getLocalization("invalidAccountNumber",[_70.get("value")]);_70.focus();_70.set("value","");_70.set("state","Error");dj.hideTooltip(_70.domNode);dj.showTooltip(_3e,_70.domNode,0);break;case "ERR_INVALID_INTERFACE_PROCESSING_ERROR":_3e=misys.getLocalization("accountValidationInterfaceError");_70.focus();_70.set("value","");_70.set("state","Error");dj.hideTooltip(_70.domNode);dj.showTooltip(_3e,_70.domNode,0);break;default:_3e=_73.items.StatusCodeMessage;_70.focus();_70.set("value","");_70.set("state","Error");dj.hideTooltip(_70.domNode);dj.showTooltip(_3e,_70.domNode,0);break;}},error:function(_75,_76){console.error("[Could not validate Beneficiary Account] "+_70.get("value"));console.error(_75);}});return _72;};function _77(){var _78=dj.byId("applicant_act_cur_code").get("value");var _79=dj.byId("beneficiary_act_cur_code").get("value");if(_79&&_79!==""){if(_78!==_79){m.dialog.show("ERROR",m.getLocalization("crossCurrency"));dj.byId("beneficiary_name").set("value","");dj.byId("beneficiary_account").set("value","");setTimeout(function(){dj.byId("beneficiary_act_cur_code").set("value",dj.byId("applicant_act_cur_code").get("value"));},0);dj.byId("ft_cur_code").set("value","");dj.byId("pre_approved").set("value","");dj.byId("pre_approved_status").set("value","");dj.byId("notify_beneficiary_choice_1").set("checked",false);dj.byId("notify_beneficiary_choice_2").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("disabled",true);dj.byId("notify_beneficiary_choice_2").set("disabled",true);dj.byId("bene_email_1").set("value","");dj.byId("bene_email_2").set("value","");dj.byId("notify_beneficiary").set("checked",false);d.place(d.byId("notify_beneficiary_email_node"),d.byId("label_notify_beneficiary_choice_2"),"after");dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_email").set("disabled",true);if(dj.byId("applicant_act_pab").get("value")!=="Y"){m.toggleFieldsReadOnly(["beneficiary_name","beneficiary_act_cur_code","beneficiary_account"],false);}else{if(dj.byId("applicant_act_pab").get("value")==="Y"){m.toggleFieldsReadOnly(["beneficiary_name","beneficiary_act_cur_code","beneficiary_account"],true);}}d.style("PAB","display","none");return;}}};d.mixin(m._config,{initReAuthParams:function(){var _7a={productCode:"FT",subProductCode:dj.byId("sub_product_code")?dj.byId("sub_product_code").get("value"):"",transactionTypeCode:"01",entity:dj.byId("entity")?dj.byId("entity").get("value"):"",currency:dj.byId("ft_cur_code")?dj.byId("ft_cur_code").get("value"):"",amount:dj.byId("ft_amt")?m.trimAmount(dj.byId("ft_amt").get("value")):"",bankAbbvName:dj.byId("customer_bank")?dj.byId("customer_bank").get("value"):"",es_field1:dj.byId("ft_amt")?m.trimAmount(dj.byId("ft_amt").get("value")):"",es_field2:(dj.byId("beneficiary_account"))?dj.byId("beneficiary_account").get("value"):""};return _7a;}});d.mixin(m,{fireFXAction:function(){if(m._config.fxParamData&&dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""&&dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""){var _7b=m._config.fxParamData[dj.byId("sub_product_code").get("value")][dj.byId("issuing_bank_abbv_name").get("value")];if(m._config.fxParamData&&_7b.isFXEnabled==="Y"){var _7c,_7d;var _7e="";if(dj.byId("ft_cur_code")){_7e=dj.byId("ft_cur_code").get("value");}var _7f=dj.byId("ft_amt").get("value");var _80=dj.byId("applicant_act_cur_code").get("value");var _81=m._config.productCode;var _82="";if(dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""){_82=dj.byId("issuing_bank_abbv_name").get("value");}var _83=dj.byId("applicant_act_cur_code").get("value");var _84=dj.byId("beneficiary_act_cur_code");var _85=false;if(_7e!==""&&!isNaN(_7f)&&_81!==""&&_82!==""){if(_7e!==_80){_7c=_80;_7d=_7e;_83=_80;}else{if(_83&&_83!==""&&_7e&&_7e!==""&&_83===_7e&&(_84&&_84.get("value")!==""&&_7e!==_84.get("value"))){_85=true;_7c=_7e;_7d=_84.get("value");_83=_7d;}}if(_7c&&_7c!==""&&_7d&&_7d!==""){if(d.byId(_8)&&(d.style(d.byId(_8),"display")==="none")){m.animate("wipeIn",d.byId(_8));}m.fetchFXDetails(_7c,_7d,_7f,_81,_82,_83,_85);if(dj.byId("fx_rates_type_1")&&dj.byId("fx_rates_type_1").get("checked")){if(isNaN(dj.byId("fx_exchange_rate").get("value"))||dj.byId("fx_exchange_rate_cur_code").get("value")===""||isNaN(dj.byId("fx_exchange_rate_amt").get("value"))||(m._config.fxParamData[dj.byId("sub_product_code").get("value")].toleranceDispInd==="Y"&&(isNaN(dj.byId("fx_tolerance_rate").get("value"))||isNaN(dj.byId("fx_tolerance_rate_amt").get("value"))||dj.byId("fx_tolerance_rate_cur_code").get("value")===""))){_26(m.getLocalization("FXDefaultErrorMessage"));}}}else{if(d.byId(_8)&&(d.style(d.byId(_8),"display")!=="none")){m.animate("wipeOut",d.byId(_8));}m.defaultBindTheFXTypes();}}}}},bind:function(){m.setValidation("iss_date",m.validateTransferDateCustomer);m.connect("applicant_act_name","onChange",m.checkNickNameDiv);m.connect("beneficiary_name","onChange",m.checkBeneficiaryNicknameDiv);m.connect("iss_date","onClick",function(){m.clearDateCache();if(misys._config.isMultiBank){var _86;if(dijit.byId("customer_bank")){_86=dijit.byId("customer_bank").get("value");}if(_86!==""&&misys&&misys._config&&misys._config.businessDateForBank&&misys._config.businessDateForBank[_86][0]&&misys._config.businessDateForBank[_86][0].value!==""){var _87=parseInt(misys._config.businessDateForBank[_86][0].value.substring(0,4),10);var _88=parseInt(misys._config.businessDateForBank[_86][0].value.substring(5,7),10);var _89=parseInt(misys._config.businessDateForBank[_86][0].value.substring(8,10),10);this.dropDown.currentFocus=new Date(_87,_88-1,_89);}}});m.setValidation("template_id",m.validateTemplateId);m.connect("applicant_act_no","onChange",_61);m.connect("entity","onClick",m.validateRequiredField);m.connect("applicant_act_name","onClick",m.validateRequiredField);m.connect("beneficiary_name","onClick",m.validateRequiredField);m.connect("beneficiary_act_cur_code","onClick",m.validateRequiredField);m.connect("beneficiary_account","onClick",m.validateRequiredField);dj.byId("sub_product_code").set("value","TPT");m.bindRecurringFields();m.connect("ft_cur_code","onChange",function(){m.setCurrency(this,["ft_amt"]);});m.setValidation("beneficiary_act_cur_code",m.validateCurrency);m.connect("beneficiary_account","onChange",_6e);m.connect("beneficiary_act_cur_code","onChange",function(){if(dj.byId("ft_cur_code")&&!dj.byId("ft_cur_code").get("readOnly")){dj.byId("ft_cur_code").set("value",dj.byId("beneficiary_act_cur_code").get("value"));dj.byId("ft_amt").set("value","");_68();}});m.connect("beneficiary_name","onChange",m.validateMandatoryRemarks);m.setValidation("beneficiary_act_cur_code",m.validateCurrency);m.connect("entity","onChange",function(){if(!misys._config.isMultiBank){m.setApplicantReference();}_3=true;dj.byId("applicant_act_name").set("value","");dj.byId("applicant_act_nickname").set("value","");dj.byId("beneficiary_nickname").set("value","");dj.byId("beneficiary_name").set("value","");dj.byId("beneficiary_act_cur_code").set("value","");dj.byId("beneficiary_account").set("value","");dj.byId("ft_cur_code").set("value","");dj.byId("ft_amt").set("value","");dj.byId("iss_date").set("value",null);if(misys._config.isMultiBank&&dj.byId("customer_bank")){dj.byId("customer_bank").set("value","");m.populateCustomerBanks();}});m.connect("beneficiary_name","onChange",function(){var _8a=dj.byId("currency_res").get("value");if(_8a==="true"){_77();}});m.connect("clear_img","onClick",function(){_42();if(dj.byId("notify_beneficiary_email")){dj.byId("notify_beneficiary").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("checked",false);dj.byId("notify_beneficiary_choice_2").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("disabled",true);dj.byId("notify_beneficiary_choice_2").set("disabled",true);dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_email").set("disabled",true);dj.byId("bene_email_1").set("value","");dj.byId("bene_email_2").set("value","");}});m.connect("applicant","onChange",_68);m.connect("beneficiary_img","onClick",_64);m.setValidation("beneficiary_name",_44);m.connect("beneficiary_name","onChange",function(){_4e();if(dj.byId("notify_beneficiary")&&dj.byId("notify_beneficiary").get("checked")){if(dj.byId("notify_beneficiary_choice_1").get("checked")){if(dj.byId("bene_email_1").get("value")!==""){dj.byId("notify_beneficiary_email").set("value",dj.byId("bene_email_1").get("value"));}else{if(dj.byId("bene_email_2").get("value")!==""){dj.byId("notify_beneficiary_email").set("value",dj.byId("bene_email_2").get("value"));}else{dj.byId("notify_beneficiary").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("checked",false);dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_email").set("disabled",true);}}}else{if(dj.byId("notify_beneficiary_choice_2").get("checked")){dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_choice_2").set("disabled",true);dj.byId("notify_beneficiary_choice_2").set("checked",false);dj.byId("notify_beneficiary").set("checked",false);}}}});m.connect("pre_approved_status","onChange",function(){if(dj.byId("pre_approved_status").get("value")==="N"){if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",false);}if(dj.byId("currency")){dj.byId("currency").set("disabled",false);}}});m.connect("notify_beneficiary","onClick",_50);m.connect("notify_beneficiary_choice_1","onClick",_59);m.connect("notify_beneficiary_choice_2","onClick",_59);m.connect("recurring_flag","onClick",m.showRecurring);m.connect("recurring_flag","onClick",function(){var _8b=dj.byId("gpp_fee_config_flag")?dj.byId("gpp_fee_config_flag").get("value"):"false";var _8c=dj.byId("gpp_fee_config_amt_cur_code")?dj.byId("gpp_fee_config_amt_cur_code").get("value"):"",_8d=dj.byId("gpp_fee_config_amt_val")?dj.byId("gpp_fee_config_amt_val").get("value"):"";if(dj.byId("response_status")){dj.byId("response_status").set("value","");}if(dj.byId("recurring_flag").get("checked")===true){if(dj.byId("payment_fee_details")){dj.byId("payment_fee_details").set("value","");}if((_8b==="true")){if(document.getElementById("NO_FEES_FOR_RECCURING_PAYMENT")){document.getElementById("NO_FEES_FOR_RECCURING_PAYMENT").style.display="block";}m.hideFeeDetailsForError();}}else{if((_8b==="true")){m.hideAllDisclaimerMessages();dj.byId("add_fee_details_button").set("disabled",false);document.getElementById("FEE_DETAILS_CONFIRMATION_DISCLAIMER").style.display="block";if(dj.byId("is_view_fees_btn")){dj.byId("is_view_fees_btn").set("value","false");}}}});m.setValidation("notify_beneficiary_email",m.validateEmailAddr);m.connect("applicant_act_name","onChange",function(){if(dj.byId("ft_cur_code")&&dj.byId("ft_cur_code").get("value")!==""){dj.byId("ft_cur_code").set("value","");var _8e={"identifier":"id","items":[]};var _8f=new dojo.data.ItemFileWriteStore({data:_8e});dj.byId("ft_cur_code").set("store",_8f);}});m.connect("customer_bank","onChange",function(){m.handleMultiBankRecurring(_4);_4=false;});if(dj.byId("bulk_ref_id")&&dj.byId("bulk_ref_id").get("value")!==""&&dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""){m.initializeFX(dj.byId("sub_product_code").get("value"),dj.byId("issuing_bank_abbv_name").get("value"));if(dj.byId("applicant_act_cur_code")&&dj.byId("applicant_act_cur_code").get("value")!==""&&dj.byId("ft_cur_code")&&dj.byId("ft_cur_code").get("value")!==""&&dj.byId("applicant_act_cur_code").get("value")!==dj.byId("ft_cur_code").get("value")&&!isNaN(dj.byId("ft_amt").get("value"))){m.onloadFXActions();}else{m.defaultBindTheFXTypes();}_32();}else{m.connect("customer_bank","onChange",_2a);}var _90=dj.byId("sub_product_code").get("value");if(dj.byId("issuing_bank_abbv_name").get("value")&&dj.byId("issuing_bank_abbv_name").get("value")!==""&&m._config.fxParamData&&m._config.fxParamData[_90][dj.byId("issuing_bank_abbv_name").get("value")].isFXEnabled==="Y"){m.connect("ft_cur_code","onBlur",function(){m.setCurrency(this,["ft_amt"]);if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});m.connect("ft_cur_code","onChange",function(){m.setCurrency(this,["ft_amt"]);m.validateMandatoryRemarks();if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});m.connect("ft_amt","onBlur",function(){m.setTnxAmt(this.get("value"));var _91="";if(dj.byId("ft_cur_code")){_91=dj.byId("ft_cur_code").get("value");}if(!isNaN(dj.byId("ft_amt").get("value"))&&_91!==""){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});}else{if(d.byId(_8)){d.style(_8,"display","none");}}if(dijit.byId("ft_cur_code")&&dijit.byId("ft_amt")){misys.setCurrency(dijit.byId("ft_cur_code"),["ft_amt"]);}m.connect("ft_amt","onChange",function(){var _92=dj.byId("gpp_fee_config_flag")?dj.byId("gpp_fee_config_flag").get("value"):"false";var _93=dj.byId("gpp_fee_config_amt_cur_code")?dj.byId("gpp_fee_config_amt_cur_code").get("value"):"",_94=dj.byId("gpp_fee_config_amt_val")?dj.byId("gpp_fee_config_amt_val").get("value"):"";if(_92==="true"){if(dj.byId("payment_fee_details")){dj.byId("payment_fee_details").set("value","");}if(dj.byId("is_view_fees_btn")){dj.byId("is_view_fees_btn").set("value","false");}if(dj.byId("response_status")){dj.byId("response_status").set("value","");}document.getElementById("ft_fee_details_div").style.display="none";m.hideAllDisclaimerMessages();if(!(dj.byId("recurring_payment_enabled"))||(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")===false)){dj.byId("add_fee_details_button").set("disabled",false);document.getElementById("FEE_DETAILS_CONFIRMATION_DISCLAIMER").style.display="block";}else{if((dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")===true)){document.getElementById("NO_FEES_FOR_RECCURING_PAYMENT").style.display="block";}}}});m.connect("ft_cur_code","onChange",function(){var _95=dj.byId("gpp_fee_config_flag")?dj.byId("gpp_fee_config_flag").get("value"):"false";var _96=dj.byId("gpp_fee_config_amt_cur_code")?dj.byId("gpp_fee_config_amt_cur_code").get("value"):"",_97=dj.byId("gpp_fee_config_amt_val")?dj.byId("gpp_fee_config_amt_val").get("value"):"";if(_95==="true"){if(dj.byId("payment_fee_details")){dj.byId("payment_fee_details").set("value","");}if(dj.byId("is_view_fees_btn")){dj.byId("is_view_fees_btn").set("value","false");}if(dj.byId("response_status")){dj.byId("response_status").set("value","");}document.getElementById("ft_fee_details_div").style.display="none";document.getElementById("fee_agent_details_div").style.display="none";document.getElementById("grand_total_fee_details").style.display="none";m.hideAllDisclaimerMessages();if(!(dj.byId("recurring_payment_enabled"))||(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")===false)){dj.byId("add_fee_details_button").set("disabled",false);document.getElementById("FEE_DETAILS_CONFIRMATION_DISCLAIMER").style.display="block";}else{if((dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")===true)){document.getElementById("NO_FEES_FOR_RECCURING_PAYMENT").style.display="block";}}}});},onFormLoad:function(){m.initForm();var _98=dijit.byId("mode")?dijit.byId("mode").get("value"):"";if(dj.byId("notify_beneficiary")&&dj.byId("notify_beneficiary").get("checked")&&(_98==="DRAFT")){var _99=dj.byId("notify_beneficiary").get("checked");m.toggleRequired("notify_beneficiary_email",_99);m.toggleRequired("notify_beneficiary_choice_1",_99);m.toggleRequired("notify_beneficiary_choice_2",_99);if(dj.byId("notify_beneficiary_choice_1").get("checked")){var _9a=d.byId("notify_beneficiary_email_node");var _9b=d.byId("label_notify_beneficiary_choice_2");_59();if(dj.byId("notify_beneficiary_choice_2").get("checked")){d.place(_9a,_9b,"after");}}}if(_98==="DRAFT"&&dj.byId("beneficiary_name")&&dj.byId("applicant_act_pab")&&dj.byId("applicant_act_pab").get("value")==="Y"&&dj.byId("beneficiary_name").value!==""){if(!m.validateBeneficiaryStatus()){dj.byId("beneficiary_name").set("state","Error");dj.showTooltip(m.getLocalization("beneficiaryIsInactive"),dj.byId("beneficiary_name").domNode,0);}}if(dj.byId("customer_bank")&&dj.byId("customer_bank").get("value")!==""&&misys&&misys._config&&misys._config.businessDateForBank&&misys._config.businessDateForBank[dj.byId("customer_bank").get("value")]&&misys._config.businessDateForBank[dj.byId("customer_bank").get("value")][0]&&misys._config.businessDateForBank[dj.byId("customer_bank").get("value")][0].value!==""){var _9c=misys._config.businessDateForBank[dj.byId("customer_bank").get("value")][0].value;var _9d=_9c.substring(0,4);var _9e=_9c.substring(5,7);var _9f=_9c.substring(8,10);_9c=_9f+"/"+_9e+"/"+_9d;var _a0=new Date(_9d,_9e-1,_9f);if(dj.byId("option_for_tnx")&&dj.byId("option_for_tnx").get("value")==="SCRATCH"){dj.byId("appl_date").set("value",_9c);document.getElementById("appl_date_view_row").childNodes[1].innerHTML=_9c;if(dj.byId("appl_date_hidden")){dj.byId("appl_date_hidden").set("value",_a0);}}if(dj.byId("todays_date")){dj.byId("todays_date").set("value",_a0);}}m.checkBeneficiaryNicknameOnFormLoad();if(misys._config.isMultiBank){m.populateCustomerBanks(true);var _a1=dj.byId("customer_bank");var _a2=dj.byId("customer_bank_hidden");var _a3=dj.byId("entity");var _a4=dj.byId("issuing_bank_abbv_name")?dj.byId("issuing_bank_abbv_name").get("value"):"";if(_a1){if(_a2){_a1.set("value",_a2.get("value"));}if(_a4!==""){_2=true;_3=true;_a1.set("value",_a4);_a2.set("value",_a4);}if(_a3&&_a3.get("value")===""){_a1.set("disabled",true);_a1.set("required",false);}}if(misys._config.perBankRecurringAllowed&&dojo.byId("recurring_payment_checkbox")&&dj.byId("customer_bank")){if(dj.byId("customer_bank").get("value")===""){m.animate("fadeOut",dojo.byId("recurring_payment_checkbox"));}else{if(dj.byId("customer_bank").get("value")!==""&&misys._config.perBankRecurringAllowed[dj.byId("customer_bank").get("value")]!=="Y"){m.animate("fadeOut",dojo.byId("recurring_payment_checkbox"));}}}if(d.byId("server_message")&&d.byId("server_message").innerHTML!==""||(dijit.byId("option_for_tnx").get("value")===""||dijit.byId("option_for_tnx").get("value")==="TEMPLATE")){_4=true;}if(dijit.byId("recurring_frequency")&&dijit.byId("customer_bank").get("value")!==""&&misys._config.perBankFrequency){var _a5=misys._config.perBankFrequency[dijit.byId("customer_bank").get("value")];if(_a5){dijit.byId("recurring_frequency").store=new dojo.data.ItemFileReadStore({data:{identifier:"value",label:"name",items:_a5}});dijit.byId("recurring_frequency").fetchProperties={sort:[{attribute:"name"}]};}dijit.byId("recurring_frequency").set("value",dijit.byId("recurring_frequency")._lastQuery);}}if(misys._config.nickname==="true"&&misys._config.option_for_app_date!=="SCRATCH"){if(dj.byId("applicant_act_nickname")&&dj.byId("applicant_act_nickname").get("value")===""){m.animate("wipeOut",d.byId("applicant_act_nickname_row"));m.animate("wipeOut",d.byId("nickname"));}}else{m.animate("fadeOut",d.byId("applicant_act_nickname_row"));}if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")){dj.byId("recurring_flag").set("checked",true);m._config.clearOnSecondCall=true;m.showSavedRecurringDetails(false);}else{if(d.byId("recurring_payment_div")){d.style("recurring_payment_div","display","none");}m.hasRecurringPayment();m.showSavedRecurringDetails(false);}if(dj.byId("applicant_act_product_types")&&dj.byId("applicant_act_no").get("value")!==""){m.toggleRequired("applicant_act_product_types",false);}var _a6=dj.byId("notify_beneficiary_email");var _a7=dj.byId("notify_beneficiary_choice");if(_a6&&_a6.get("value")!==""&&_a7&&(_a7.get("value")==="default_email")){dj.byId("bene_email_1").set("value",_a6.get("value"));}if(!m._config.isMultiBank&&dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""&&m._config.fxParamData&&dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""&&dj.byId("sub_product_code").get("value")!=="IBG"){m.initializeFX(dj.byId("sub_product_code").get("value"),dj.byId("issuing_bank_abbv_name").get("value"));if(dj.byId("applicant_act_cur_code")&&dj.byId("applicant_act_cur_code").get("value")!==""&&dj.byId("ft_cur_code")&&dj.byId("ft_cur_code").get("value")!==""&&dj.byId("applicant_act_cur_code").get("value")!==dj.byId("ft_cur_code").get("value")){m.onloadFXActions();}else{m.defaultBindTheFXTypes();}}else{m.animate("fadeOut",_1);}if(d.byId(_8)){if(!m._config.fxParamData&&dj.byId("bulk_ref_id").get("value")!==""&&dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.initializeFX(dj.byId("sub_product_code").get("value"),dj.byId("issuing_bank_abbv_name").get("value"));m.fireFXAction();}else{if((dj.byId("fx_exchange_rate_cur_code")&&dj.byId("fx_exchange_rate_cur_code").get("value")!=="")||(dj.byId("fx_total_utilise_cur_code")&&dj.byId("fx_total_utilise_cur_code").get("value")!=="")){m.animate("wipeIn",d.byId(_8));}else{d.style(_8,"display","none");}}}var _a8=dj.byId("ft_cur_code");if(_a8){var _a9=_a8.get("displayedValue");_68();_a8.set("displayedValue",_a9);}m.validateMandatoryRemarks();var _aa=dj.byId("gpp_fee_config_flag")?dj.byId("gpp_fee_config_flag").get("value"):"false";if(dj.byId("ft_amt")&&dj.byId("ft_amt").get("value")!=""){var _ab=(dojo.number.parse(dj.byId("ft_amt").get("value"))>0)?dojo.number.parse(dj.byId("ft_amt").get("value")):0;}if((dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")==true)&&_aa==="true"){document.getElementById("ftFeeFetails").style.display="block";document.getElementById("ft-fee-details-template").style.display="block";document.getElementById("NO_FEES_FOR_RECCURING_PAYMENT").style.display="block";m.hideFeeDetailsForError();}else{if(_aa==="true"){document.getElementById("ftFeeFetails").style.display="block";document.getElementById("ft-fee-details-template").style.display="block";document.getElementById("FEE_DETAILS_CONFIRMATION_DISCLAIMER").style.display="block";if(_98==="DRAFT"&&_ab>0){if(dj.byId("is_view_fees_btn")){dj.byId("is_view_fees_btn").set("value","false");}}}}},initForm:function(){dj.byId("sub_product_code").set("value","TPT");var _ac=dj.byId("applicant_act_pab").get("value");if(_ac==="Y"||(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y")){if(m._config.non_pab_allowed){d.style("PAB","display","inline");}else{d.style("PAB","display","none");}_3f.toggleReadonly(true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}if(dj.byId("currency")){dj.byId("currency").set("disabled",true);}}else{if((dj.byId("pre_approved")&&dj.byId("pre_approved")==null)||(dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")==="")||(dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")===null)){_3f.toggleReadonly(false);}else{_3f.toggleReadonly(true);}}d.forEach(d.query(".CUR"),function(_ad,i){d.style(_ad,"display","inline");});dj.byId("beneficiary_mode").set("value","02");m.toggleRequired("beneficiary_act_cur_code",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(d.byId("clear_img")&&(_ac==="Y"&&d.style(d.byId("clear_img"),"display")!=="none")){m.animate("wipeOut",d.byId("clear_img"));}},setCustomConfirmMessage:function(){var _ae=dijit.byId("mode")?dijit.byId("mode").get("value"):"";if(_ae==="DRAFT"){var _af;var _b0=dj.byId("gpp_fee_config_flag")?dj.byId("gpp_fee_config_flag").get("value"):"false";if(dj.byId("response_status")){_af=dj.byId("response_status").get("value");}if(_b0==="true"&&(_af!="200")&&_af!=""){var _b1=m.getLocalization("getFeeErrorResponse");m._config.globalSubmitConfirmationMsg=_b1;}else{var _b2=m.getLocalization("submitTransactionConfirmation");m._config.globalSubmitConfirmationMsg=_b2;}}},beforeSaveValidations:function(){if(dj.byId("payment_fee_details")){dj.byId("payment_fee_details").set("value","");}var _b3=dj.byId("entity");if(_b3&&_b3.get("value")===""){return false;}return true;},beforeSubmitValidations:function(){var _b4=dijit.byId("mode")?dijit.byId("mode").get("value"):"";if(_b4==="DRAFT"&&!_6e()){return false;}if(_b4==="DRAFT"&&dj.byId("applicant_act_pab")&&dj.byId("applicant_act_pab").get("value")==="Y"&&!m.validateBeneficiaryStatus()){m._config.onSubmitErrorMsg=m.getLocalization("beneficiaryIsInactive");dj.byId("beneficiary_name").set("state","Error");return false;}if(dj.byId("ft_amt")&&!m.validateAmount((dj.byId("ft_amt"))?dj.byId("ft_amt"):0)){m._config.onSubmitErrorMsg=m.getLocalization("amountcannotzero");dj.byId("ft_amt").set("value","");return false;}var _b5=0,_b6="";if(dj.byId("to_currency_amount")){_b5=dj.byId("to_currency_amount").get("value");}if(dj.byId("to_currency")){_b6=dj.byId("to_currency").get("value");}var _b7=dj.byId("gpp_fee_config_flag")?dj.byId("gpp_fee_config_flag").get("value"):"false";var _b8=dj.byId("gpp_fee_config_amt_cur_code")?dj.byId("gpp_fee_config_amt_cur_code").get("value"):"",_b9=dj.byId("gpp_fee_config_amt_val")?dj.byId("gpp_fee_config_amt_val").get("value"):"";if(_b7==="true"&&((((_b8===dj.byId("ft_cur_code").get("value"))||_b8==="*")&&(_b9>=dj.byId("ft_amt").get("value")))||((_b8===_b6)&&((dojo.number.parse(_b9))>=_b5)))){if(dj.byId("payment_fee_details")){dj.byId("payment_fee_details").set("value","");}}if((dj.byId("recurring_flag")&&dj.byId("recurring_flag").get("checked")===false)&&_b7==="true"){if(dj.byId("is_view_fees_btn")&&dj.byId("is_view_fees_btn").get("value")!="true"){if(((_b8===dj.byId("ft_cur_code").get("value"))||_b8==="*")||(_b8!=dj.byId("ft_cur_code").get("value"))){if((dj.byId("payment_fee_details"))&&dj.byId("payment_fee_details").get("value")===""){m._config.onSubmitErrorMsg=m.getLocalization("feeChargesAreNotAccurate");return false;}}}}if(!m.isRecurringDetailsValidForSubmit()){return false;}if(dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name")!==""&&m._config.fxParamData&&m._config.fxParamData[dj.byId("sub_product_code").get("value")][dj.byId("issuing_bank_abbv_name").get("value")].isFXEnabled==="Y"){if(!m.fxBeforeSubmitValidation()){return false;}if(!_35()){return false;}}if(dijit.byId("free_format_text")){if(dijit.byId("free_format_text").get("required")){var _ba=dijit.byId("free_format_text").get("value").trim();if(_ba.length===0){dj.byId("free_format_text").set("value","");dj.byId("free_format_text").set("state","Error");return false;}}}var _bb=dj.byId("applicant_act_no").get("value");var _bc=m.checkAccountStatus(_bb);if(!_bc){m._config.onSubmitErrorMsg=misys.getLocalization("accountStatusError");return false;}if(!dj.byId("bulk_ref_id").get("value")){var _bd=false;if(_b4==="DRAFT"){if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")){_bd=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code",_b4,["Start Date"],["recurring_start_date"],"entity","ft_cur_code","ft_amt");}else{_bd=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code",_b4,["Transfer Date"],["iss_date"],"entity","ft_cur_code","ft_amt");}}else{if(_b4==="UNSIGNED"){if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("value")==="Y"){_bd=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code_unsigned",_b4,["Start Date"],["recurring_start_date_unsigned"],"display_entity_unsigned","ft_cur_code_unsigned","ft_amt_unsigned");}else{_bd=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code_unsigned",_b4,["Transfer Date"],["iss_date_unsigned"],"display_entity_unsigned","ft_cur_code_unsigned","ft_amt_unsigned");}}else{m._config.onSubmitErrorMsg=m.getLocalization("technicalErrorWhileValidatingBusinessDays");}}if(_bd){m._config.holidayCutOffEnabled=false;}return _bd;}else{return true;}},showListOfBanks:function(){m.showSearchDialog("bank","['cpty_bank_name', 'cpty_bank_address_line_1', 'cpty_bank_address_line_2', 'cpty_bank_dom', 'cpty_bank_swift_bic_code', 'cpty_bank_contact_name', 'cpty_bank_phone', 'bank_country']",{swiftcode:false,bankcode:false},"","","width:710px;height:350px;",m.getLocalization("ListOfSwiftBanksTitleMessage"));}});})(dojo,dijit,misys);dojo.require("misys.client.binding.cash.create_ft_tpt_client");}