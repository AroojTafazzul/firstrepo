/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.create_pooling_structure"]){dojo._hasResource["misys.binding.cash.create_pooling_structure"]=true;dojo.provide("misys.binding.cash.create_pooling_structure");dojo.require("dojo.parser");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("misys.form.PercentNumberTextBox");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.common");dojo.require("misys.form.file");dojo.require("misys.validation.common");dojo.require("misys.form.BusinessDateTextBox");dojo.require("dijit.layout.BorderContainer");dojo.require("dojo.data.ItemFileWriteStore");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Form");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.layout.TabContainer");dojo.require("dojo.io.iframe");dojo.require("dijit.ProgressBar");dojo.require("dojo.behavior");dojo.require("dojo.date.locale");dojo.require("dijit.Tooltip");dojo.require("misys.grid.DataGrid");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("misys.layout.FloatingPane");dojo.require("misys.liquidity.widget.BalGroups");dojo.require("misys.liquidity.widget.BalGroup");(function(d,dj,m){function _1(){if(dj.byId("effective_date")&&dj.byId("effective_date").get("value")!==""&&dj.byId("effective_date").get("value")!==null){var _2=dj.byId("effective_date").get("value");if(_2){if(d.date.compare(_2,new Date(),"date")>=0){return true;}else{dj.byId("effective_date").set("state","Error");dj.showTooltip(m.getLocalization("liquidityEffectiveDateLessThanCurrentDate"),dj.byId("effective_date").domNode,0);return false;}}}};d.mixin(m,{bind:function(){m.connect("group_code","onBlur",function(){m.validateGroupCode();});m.connect("description","onBlur",function(){m.validateDescription();});m.connect("structure_code","onBlur",function(){var _3=dj.byId("existing_code").get("value");var _4=dj.byId("structure_code").get("value");if(dj.byId("mode")&&(dj.byId("mode").get("value")==="EXISTING"||dj.byId("mode").get("value")==="DRAFT")){if(_3!==_4){m.checkStructureCodeExists();}}if(dj.byId("mode")&&(dj.byId("mode").get("value")==="copy")){m.checkStructureCodeExists();}});m.connect("effective_date","onBlur",function(){var _5=dj.byId("existing_eff_date").get("value");var _6=dj.byId("effective_date").get("value");if(dj.byId("mode")&&(dj.byId("mode").get("value")==="EXISTING"||dj.byId("mode").get("value")==="DRAFT")){if(d.date.compare(m.localizeDate(dj.byId("existing_eff_date")),_6,"date")!=0){m.checkEffectiveDateExists();_1();}}if(dj.byId("mode")&&(dj.byId("mode").get("value")==="copy")){m.checkEffectiveDateExists();_1();}});m.connect("sub_group_code","onBlur",function(){m.validateSubGroupCode();});m.connect("subgrp_description","onBlur",function(){m.validateSubGrpDescription();});m.connect(dj.byId("frequency"),"onChange",function(){dj.byId("frequency").set("value",this.get("value"));});m.connect("subGrpType","onChange",function(){if(this.get("value")==="1"){dj.byId("low_target").set("disabled",false);dj.byId("high_target").set("disabled",false);dj.byId("balance_target").set("disabled",false);}if(this.get("value")==="2"){dj.byId("low_target").set("disabled",true);dj.byId("high_target").set("disabled",true);dj.byId("balance_target").set("disabled",false);dj.byId("low_target").setValue(0);dj.byId("high_target").setValue(0);}if(this.get("value")==="3"){dj.byId("low_target").set("disabled",true);dj.byId("high_target").set("disabled",true);dj.byId("balance_target").set("disabled",true);dj.byId("balance_target").setValue(0);dj.byId("low_target").setValue(0);dj.byId("high_target").setValue(0);}});m.connect("high_target","onBlur",function(){m.validateHighTargetBalances();});m.connect("low_target","onBlur",function(){m.validateLowTargetBalances();});},beforeSubmitValidations:function(){var _7=true;var _8="";var _9=dj.byId("structure_code");var _a=dj.byId("effective_date");if(_9&&_9.get("value")!==""){_9.onBlur();if(_9.get("state")==="Error"){_8+=m.getLocalization("mandatorystructureCode");_7=false;m._config.onSubmitErrorMsg=_8;return _7;}}if(_a&&_a.get("value")!==""){_a.onBlur();if(_a.get("state")==="Error"){_8+=m.getLocalization("mandatoryeffectiveDate");_7=false;m._config.onSubmitErrorMsg=_8;return _7;}}return _7;},beforeSaveValidations:function(){var _b=true;var _c="";var _d=dj.byId("structure_code");var _e=dj.byId("effective_date");if(_d&&_d.get("value")!==""){_d.onBlur();if(_d.get("state")==="Error"){_c+=m.getLocalization("mandatorystructureCode");_b=false;m._config.onSubmitErrorMsg=_c;return _b;}}if(_e&&_e.get("value")!==""){_e.onBlur();if(_e.get("state")==="Error"){_c+=m.getLocalization("mandatoryeffectiveDate");_b=false;m._config.onSubmitErrorMsg=_c;return _b;}}return _b;}});d.mixin(m._config,{initReAuthParams:function(){var _f={productCode:"LIQ",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:"",es_field2:""};return _f;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.cash.create_pooling_structure_client");}