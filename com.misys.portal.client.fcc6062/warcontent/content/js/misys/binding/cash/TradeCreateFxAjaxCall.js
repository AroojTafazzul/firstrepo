/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.TradeCreateFxAjaxCall"]){dojo._hasResource["misys.binding.cash.TradeCreateFxAjaxCall"]=true;dojo.provide("misys.binding.cash.TradeCreateFxAjaxCall");_fncAjaxGetRate=function(){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionFX"),handleAs:"json",content:{operation:"REQUEST",applicant_reference:fncGetGlobalVariable("applicant_reference"),fx_type:fncGetGlobalVariable("fx_type"),contract_type:fncGetGlobalVariable("contract_type"),counter_cur_code:fncGetGlobalVariable("counter_cur_code"),fx_cur_code:fncGetGlobalVariable("fx_cur_code"),fx_amt:fncGetGlobalVariable("fx_amt"),value_date:fncGetGlobalVariable("input_value_date"),value_days:fncGetGlobalVariable("input_value_days"),value_period:fncGetGlobalVariable("input_value_period"),near_date:fncGetGlobalVariable("input_near_date"),near_days:fncGetGlobalVariable("input_near_days"),near_period:fncGetGlobalVariable("input_near_period"),near_amt:fncGetGlobalVariable("near_amt"),remarks:fncGetGlobalVariable("remarks"),option_date:fncGetGlobalVariable("input_option_date"),option_days:fncGetGlobalVariable("input_option_days"),option_period:fncGetGlobalVariable("input_option_period")},load:function(_1,_2){dijit.byId("loadingDialog").hide();var _3=_1.status;switch(_3){case 5:_fncGetData(_1);validity=_1.validity;_fncCountdown(validity);fncShowDetailField();break;case 6:fncSetGlobalVariable("trade_id",_1.trade_id);fncSetGlobalVariable("rec_id",_1.rec_id);misys.frequencyStore=_1.delay_frequency;misys.delayStore=_1.delay_timeout;_fncOpenDelayDialog(misys.frequencyStore,misys.delayStore);break;default:dijit.byId("loadingDialog").hide();_fncManageErrors(_3,_1);break;}},customError:function(_4,_5){dijit.byId("loadingDialog").hide();console.error("[TradeCreateFxBinding] error retrieving quote");_fncManageErrors(_4.status,_4);}});};_fncPerformDelayRequest=function(_6,_7){if(_6>0){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionFX"),handleAs:"json",content:{operation:"DELAY",applicant_reference:dijit.byId("applicant_reference").get("value"),trade_id:fncGetGlobalVariable("trade_id"),rec_id:fncGetGlobalVariable("rec_id"),fx_type:fncGetGlobalVariable("fx_type"),contract_type:fncGetGlobalVariable("contract_type"),counter_cur_code:fncGetGlobalVariable("counter_cur_code"),fx_cur_code:fncGetGlobalVariable("fx_cur_code"),fx_amt:fncGetGlobalVariable("fx_amt"),value_date:fncGetGlobalVariable("input_value_date"),value_days:fncGetGlobalVariable("input_value_days"),value_period:fncGetGlobalVariable("input_value_period"),near_date:fncGetGlobalVariable("input_near_date"),near_days:fncGetGlobalVariable("input_near_days"),near_period:fncGetGlobalVariable("input_near_period"),near_amt:fncGetGlobalVariable("near_amt"),remarks:fncGetGlobalVariable("remarks"),option_date:fncGetGlobalVariable("input_option_date"),option_days:fncGetGlobalVariable("input_option_days"),option_period:fncGetGlobalVariable("input_option_period")},load:function(_8,_9){var _a=_8.status;switch(_a){case 5:_fncGetData(_8);fncCloseDelayDialog();validity=_8.validity;_fncCountdown(validity);fncShowDetailField();break;case 6:fncSetGlobalVariable("rec_id",_8.rec_id);_6--;misys.timer=setTimeout("_fncPerformDelayRequest('"+_6+"','"+_7+"')",(_7*1000));break;default:fncCloseDelayDialog();_fncManageErrors(_a,_8);break;}},customError:function(_b,_c){console.error("[TradeCreateFxBinding] error retrieving quote");_fncManageErrors(_b.status,_b);}});}else{_stopCountDown(misys.timer);_fncShowContinuationElement();}};_fncCancelDelayRequest=function(){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionFX"),handleAs:"json",content:{operation:"CANCEL",applicant_reference:dijit.byId("applicant_reference").get("value"),trade_id:fncGetGlobalVariable("trade_id"),rec_id:fncGetGlobalVariable("rec_id"),fx_type:fncGetGlobalVariable("fx_type"),contract_type:fncGetGlobalVariable("contract_type"),counter_cur_code:fncGetGlobalVariable("counter_cur_code"),fx_cur_code:fncGetGlobalVariable("fx_cur_code"),fx_amt:fncGetGlobalVariable("fx_amt"),value_date:fncGetGlobalVariable("input_value_date"),value_days:fncGetGlobalVariable("input_value_days"),value_period:fncGetGlobalVariable("input_value_period"),near_date:fncGetGlobalVariable("input_near_date"),near_days:fncGetGlobalVariable("input_near_days"),near_period:fncGetGlobalVariable("input_near_period"),near_amt:fncGetGlobalVariable("near_amt"),remarks:fncGetGlobalVariable("remarks"),option_date:fncGetGlobalVariable("input_option_date"),option_days:fncGetGlobalVariable("input_option_days"),option_period:fncGetGlobalVariable("input_option_period")},load:function(_d,_e){var _f=_d.status;switch(_f){case 7:misys.dialog.show("CUSTOM-NO-CANCEL",misys.getLocalization("confirmationCancelRequest"),misys.getLocalization("confirmationCancelTitle"));break;default:_fncManageErrors(_f,_d);break;}},customError:function(_10,_11){misys.dialog.show("ERROR",misys.getLocalization("technicalError"));fncPerformClear();}});};fncCancelRequest=function(){dijit.byId("buttonAcceptRequest").set("disabled",false);m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionFX"),handleAs:"json",content:{operation:"REJECT",applicant_reference:dijit.byId("applicant_reference").get("value"),trade_id:fncGetGlobalVariable("trade_id"),rec_id:fncGetGlobalVariable("rec_id"),fx_type:fncGetGlobalVariable("fx_type"),contract_type:fncGetGlobalVariable("contract_type"),counter_cur_code:fncGetGlobalVariable("counter_cur_code"),fx_cur_code:fncGetGlobalVariable("fx_cur_code"),fx_amt:fncGetGlobalVariable("fx_amt"),value_date:fncGetGlobalVariable("input_value_date"),value_days:fncGetGlobalVariable("input_value_days"),value_period:fncGetGlobalVariable("input_value_period"),near_date:fncGetGlobalVariable("input_near_date"),near_days:fncGetGlobalVariable("input_near_days"),near_period:fncGetGlobalVariable("input_near_period"),near_amt:fncGetGlobalVariable("near_amt"),remarks:fncGetGlobalVariable("remarks"),option_date:fncGetGlobalVariable("input_option_date"),option_days:fncGetGlobalVariable("input_option_days"),option_period:fncGetGlobalVariable("input_option_period")},load:fncPerformClear,customError:function(_12,_13){misys.dialog.show("ERROR",misys.getLocalization("technicalError"));fncPerformClear();}});};_fncGetData=function(_14){dojo.query("#trade_id_report_row .content")[0].innerHTML=_14.trade_id;dijit.byId("trade_id").set("value",_14.trade_id);dijit.byId("rec_id").set("value",_14.rec_id);fncSetGlobalVariable("trade_id",_14.trade_id);fncSetGlobalVariable("rec_id",_14.rec_id);dijit.byId("remarks").set("value",_14.remarks);if(fx_type=="SPOT"||fx_type=="FORWARD"){dojo.query("#rate_report_row .content")[0].innerHTML=_14.rate;dojo.query("#counter_amt_report_row .content")[0].innerHTML=_14.counter_currency+"&nbsp;"+_14.counter_amount;dojo.query("#maturity_date_report_row .content")[0].innerHTML=_14.value_date;dijit.byId("rate").set("value",_14.rate);dijit.byId("counter_cur_code").set("value",_14.counter_currency);dijit.byId("counter_amt").set("value",_14.counter_amount);dijit.byId("maturity_date").set("value",_14.value_date);dijit.byId("value_date").set("value",_14.value_date);dijit.byId("fx_cur_code").set("value",_14.currency);dijit.byId("fx_amt").set("value",_14.amount);}else{if(fx_type=="DELIVERY_OPTION"){dojo.query("#rate_report_row .content")[0].innerHTML=_14.rate;dojo.query("#counter_amt_report_row .content")[0].innerHTML=_14.counter_currency+"&nbsp;"+_14.counter_amount;dojo.query("#maturity_date_report_row .content")[0].innerHTML=_14.value_date;dojo.query("#option_date_report_row .content")[0].innerHTML=_14.option_value_date;dijit.byId("rate").set("value",_14.rate);dijit.byId("counter_cur_code").set("value",_14.counter_currency);dijit.byId("counter_amt").set("value",_14.counter_amount);dijit.byId("maturity_date").set("value",_14.value_date);dijit.byId("value_date").set("value",_14.value_date);dijit.byId("fx_cur_code").set("value",_14.currency);dijit.byId("fx_amt").set("value",_14.amount);dijit.byId("option_date").set("value",_14.option_value_date);}else{if(fx_type=="SWAP"){dojo.query("#near_amt_report_row .content")[0].innerHTML=_14.currency+"&nbsp;"+_14.near_amount;dojo.query("#near_rate_report_row .content")[0].innerHTML=_14.near_rate;dojo.query("#near_counter_amt_report_row .content")[0].innerHTML=_14.counter_currency+"&nbsp;"+_14.near_counter_amount;dojo.query("#near_date_report_row .content")[0].innerHTML=_14.near_value_date;dijit.byId("near_currency_code").set("value",_14.currency);dijit.byId("near_amt").set("value",_14.near_amount);dijit.byId("near_rate").set("value",_14.near_rate);dijit.byId("near_counter_currency_code").set("value",_14.counter_currency);dijit.byId("near_counter_amt").set("value",_14.near_counter_amount);dijit.byId("near_date").set("value",_14.near_value_date);dojo.query("#far_amt_report_row .content")[0].innerHTML=_14.currency+"&nbsp;"+_14.amount;dojo.query("#far_rate_report_row .content")[0].innerHTML=_14.rate;dojo.query("#far_counter_amt_report_row .content")[0].innerHTML=_14.counter_currency+"&nbsp;"+_14.counter_amount;dojo.query("#far_date_report_row .content")[0].innerHTML=_14.value_date;dijit.byId("fx_cur_code").set("value",_14.currency);dijit.byId("fx_amt").set("value",_14.amount);dijit.byId("counter_cur_code").set("value",_14.counter_currency);dijit.byId("rate").set("value",_14.rate);dijit.byId("counter_amt").set("value",_14.counter_amount);dijit.byId("value_date").set("value",_14.value_date);dijit.byId("maturity_date").set("value",_14.value_date);}}}};_fncManageErrors=function(_15,_16){var _17="";switch(_15){case 3:_17=misys.getLocalization("errorFXRateRejected");break;case 28:_17=misys.getLocalization("errorFXRateNoLongerValid");break;case 29:_17=misys.getLocalization("errorFXUnknownCurrency");break;case 30:_17=misys.getLocalization("errorFXUnknownCounterCurrency");break;case 31:_17=misys.getLocalization("errorFXServiceClosed");break;case 32:_17=misys.getLocalization("errorFXServiceNotAuthorized");break;case 33:_17=misys.getLocalization("errorFXDateNotValid");break;case 34:_17=misys.getLocalization("errorFXCurrencyDateNotValid");break;case 35:_17=misys.getLocalization("errorFXCounterCurrencyDateNotValid",[_16.errorParam]);break;default:_17=fncGetCommonMessageError(_15,_16);break;}fncPerformClear();misys.dialog.show("ERROR",_17);fncPerformClear();};dojo.require("misys.client.binding.cash.TradeCreateFxAjaxCall_client");}