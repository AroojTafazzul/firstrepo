/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.common.AccountPopup"]){dojo._hasResource["misys.binding.cash.common.AccountPopup"]=true;dojo.provide("misys.binding.cash.common.AccountPopup");(function(d,dj,m){function _1(_2,_3,_4){var _5=new d.data.ItemFileReadStore({data:_2});var _6=dj.byId(_3+"_Grid_"+_4);if(_6){if(_6.selection!==null){_6.selection.clear();}_6.setStore(_5);}};function _7(_8,_9,_a,_b){var _c=new d.data.ItemFileReadStore({data:_8});var _d=_8.items[0].bank_abbv_name;var _e=m.getLocalization("acct_no_header_label");var _f=m.getLocalization("description_header_label");var _10=m.getLocalization("ccy_header_label");var _11=m.getLocalization("account_type_header_label");var _12=[{field:"account_no",name:_e,width:"10em",styles:"text-align: center;"},{field:"description",name:_f,width:"14em"},{field:"cur_code",name:_10,width:"4em",styles:"text-align: center;"},{field:"type",name:_11,width:"8em",styles:"text-align: center;"}];var _13=new dojox.grid.DataGrid({query:{id:"*"},store:_c,id:_9+"_Grid"+"_"+_a,structure:_12,height:"350px",autoWidth:true,noDataMessage:"No Accounts Found",onSelected:function(_14){_15(_14,_9,_a);},selectionMode:"single"},document.createElement("div"));d.create("div",{id:_9+"_Grid_Title"+"_"+_a,innerHTML:m.getLocalization("bank_title_label")+_d},d.byId(_b));d.byId(_b).appendChild(_13.domNode);_13.startup();};function _15(_16,_17,_18){var _19=dj.byId(_17+"_Grid_"+_18).selection.getSelected();var _1a;if(_19.length){dojo.forEach(_19,function(_1b){if(_1b!==null){_1a=_1b;}});}else{_1a=dj.byId(_17+"_Grid_"+_18).get("store")._arrayOfAllItems[_16];}m.fillAccountField(_17,_1a);_1c(_17,_18);dj.byId(_17).hide();};function _1c(_1d,_1e){var _1f=d.query("#"+_1d+"_div > div").length;if(_1f===1){return;}else{for(i=0;i<_1f;i++){if(_1e!==i){dj.byId(_1d+"_Grid_"+i).selection.selectedIndex=-1;d.query("#"+_1d+"_Grid_"+i+" .dojoxGridContent div.dojoxGridRowSelected").forEach(function(_20){d.removeClass(_20,"dojoxGridRowSelected");d.removeClass(_20,"dojoxGridRowOdd");});}}}};function _21(_22,_23,_24,_25){if(dj.byId("entity")){m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/ListOfAccountsAction"),handleAs:"json",load:_26,accountType:_23,update:_25,content:{COMPANYID:dj.byId("company_id").get("value"),ENTITY:dj.byId("entity").get("value"),ACCOUNTSEARCHACTION:_22,MATCHINGCURR:_24},customError:function(_27,_28){m[_23+"PopupFirstOpening"]="true";}});}else{m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/ListOfAccountsAction"),handleAs:"json",load:_26,accountType:_23,update:_25,content:{COMPANYID:dj.byId("company_id").get("value"),ACCOUNTSEARCHACTION:_22,MATCHINGCURR:_24},customError:function(_29,_2a){m[_23+"PopupFirstOpening"]="true";}});}};function _26(_2b,_2c){var _2d=0,_2e="",_2f=400,_30=_2c.args.accountType,_31=_2c.args.update,_32;dj.byId(_30).show();for(jsonData in _2b){_32={items:_2b[_2d]};if(_31==="UPDATE"&&(_30==="fundingAccount"||_30==="receivingAccount"||_30==="orderingAccount"||_30==="beneficiaryAccount")){_1(_32,_30,_2d);}else{_2e=_30+"_div_"+_2d;d.create("div",{id:_2e},_30+"_div");_7(_32,_30,_2d,_2e);}_2f=_2f+115;_2d++;}d.style(_30,"height",_2f+"px");};d.mixin(m,{openAccountPopup:function(_33,_34,_35){firstOpening=m[_33+"PopupFirstOpening"];if(firstOpening==="true"){_21(_34,_33,_35);}else{if(_33==="fundingAccount"||_33==="receivingAccount"||_33==="orderingAccount"||_33==="beneficiaryAccount"){_21(_34,_33,_35,"UPDATE");}else{dj.byId(_33).show();}}m[_33+"PopupFirstOpening"]="false";},fillAccountField:function(_36,_37){},filteringAccount:function(_38){var _39=_38.split("_")[0];var _3a=_39+"_number_acct_search";var _3b=_39+"_desc_acct_search";var _3c=_39+"_ccy_acct_search";var _3d=_39+"_type_acct_search";var _3e=dojo.query("#"+_39+"_div > div").length;for(i=0;i<_3e;i++){m.grid.filter(dijit.byId(_39+"_Grid_"+i),["account_no","description","cur_code","type"],[_3a,_3b,_3c,_3d]);}}});})(dojo,dijit,misys);}