/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.request.TDAjaxCall"]){dojo._hasResource["misys.binding.cash.request.TDAjaxCall"]=true;dojo.provide("misys.binding.cash.request.TDAjaxCall");_fncAjaxGetRate=function(){misys.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionTD"),handleAs:"json",load:function(_1,_2){dijit.byId("loadingDialog").hide();var _3=_1.status;switch(_3){case 5:_fncGetData(_1);validity=_1.validity;_fncCountdown(validity);fncShowDetailField();break;case 6:fncSetGlobalVariable("trade_id",_1.trade_id);fncSetGlobalVariable("rec_id",_1.rec_id);misys.frequencyStore=_1.delay_frequency;misys.delayStore=_1.delay_timeout;_fncOpenDelayDialog(misys.frequencyStore,misys.delayStore);break;default:_fncManageErrors(_3);break;}},content:{operation:"REQUEST"},customError:function(_4,_5){dijit.byId("loadingDialog").hide();console.error("[TDAjaxCall] error retrieving quote");_fncManageErrors();}});};fncCancelRequest=function(){dijit.byId("buttonAcceptRequest").set("disabled",false);misys.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/RequestForQuoteSearchActionTD"),handleAs:"json",load:fncPerformClear,content:{operation:"CANCEL"},customError:function(_6,_7){console.error("[TdAjaxCall] error retrieving quote");misys.dialog.show("ERROR",misys.getLocalization("technicalError"));fncPerformClear();}});};_fncGetData=function(_8){dojo.query("#trade_id_report_row .content")[0].innerHTML=_8.trade_id;dijit.byId("trade_id").set("value",_8.trade_id);dijit.byId("rec_id").set("value",_8.rec_id);fncSetGlobalVariable("trade_id",_8.trade_id);fncSetGlobalVariable("rec_id",_8.rec_id);dojo.query("#rate_report_row .content")[0].innerHTML=_8.rate;};_fncManageErrors=function(_9,_a){var _b="";switch(_9){case 0:_b=misys.getLocalization("errorFXRateRejected");break;case 3:_b=misys.getLocalization("errorFXRateRejected");break;case 8:_b=misys.getLocalization("errorFXRateNoLongerValid",[_a.rate]);break;case 9:_b=misys.getLocalization("errorFXUnknownCurrency",[_a.currency]);break;case 10:_b=misys.getLocalization("errorFXUnknownCounterCurrency",[_a.conter_currency]);break;case 11:_b=misys.getLocalization("errorFXServiceClosed");break;case 12:_b=misys.getLocalization("errorFXServiceNotAuthorized");break;case 13:_b=misys.getLocalization("errorFXDateNotValid",[_a.value_date]);break;case 14:_b=misys.getLocalization("errorFXCurrencyDateNotValid",[_a.value_date]);break;case 15:_b=misys.getLocalization("errorFXCounterCurrencyDateNotValid",[_a.value_date]);break;default:_b=misys.getLocalization("technicalError");break;}fncPerformClear();misys.dialog.show("ERROR",_b,"",fncPerformClear);};}