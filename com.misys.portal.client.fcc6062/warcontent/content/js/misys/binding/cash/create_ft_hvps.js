/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.create_ft_hvps"]){dojo._hasResource["misys.binding.cash.create_ft_hvps"]=true;dojo.provide("misys.binding.cash.create_ft_hvps");dojo.require("dojo.parser");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("misys.form.PercentNumberTextBox");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.common");dojo.require("misys.form.file");dojo.require("misys.validation.common");dojo.require("misys.binding.cash.ft_common");dojo.require("misys.form.BusinessDateTextBox");dojo.require("misys.binding.core.beneficiary_advice_common");(function(d,dj,m){var _1=d.byId("fx-message-type");var _2="fx-section";function _3(_4){var _5=function(){var _6=dijit.byId("ft_amt");_6.set("state","Error");m.defaultBindTheFXTypes();dj.byId("ft_amt").set("value","");if(dj.byId("ft_cur_code")&&!dj.byId("ft_cur_code").get("readOnly")){dj.byId("ft_cur_code").set("value","");}};m.dialog.show("ERROR",_4,"",function(){setTimeout(_5,500);});if(d.byId(_2)&&(d.style(d.byId(_2),"display")!=="none")){m.animate("wipeOut",d.byId(_2));}};function _7(){if(dj.byId("notify_beneficiary_email")&&dj.byId("notify_beneficiary_email").get("value")!==""){var _8=dj.byId("notify_beneficiary_email").get("value");var _9=_8.split(";");if(_9.length>10){var _a=m.getLocalization("checkEmailId");dj.byId("notify_beneficiary_email").set("state","Error");dj.hideTooltip(dj.byId("notify_beneficiary_email").domNode);dj.showTooltip(_a,dj.byId("notify_beneficiary_email").domNode,0);}}};function _b(){var _c=dj.byId("cnaps_bank_code"),_d=dj.byId("cnaps_bank_name"),_e=dj.byId("product_type").get("value"),_f="";if(_c){if(!(_c.get("value")==="")){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/ValidateCNAPSBankCode"),handleAs:"json",sync:true,content:{cnaps_bank_code:_c.get("value"),sub_product_code:_e},load:function(_10,_11){if(_10.items.valid===false){_f=misys.getLocalization("invalidCNAPSBankCode",[_c.get("value")]);_d.set("value","");_c.set("state","Error");dj.hideTooltip(_c.domNode);dj.showTooltip(_f,_c.domNode,0);}else{_d.set("value",_10.items.bankName);}},error:function(_12,_13){console.error("[Could not validate CNAPS Bank Code] "+_c.get("value"));console.error(_12);}});}else{_d.set("value","");_c.set("value","");}}};function _14(){var _15=true;var _16="";var _17=dj.byId("fx_rates_type_2");var _18=dj.byId("fx_total_utilise_amt");var _19=dj.byId("ft_amt");var _1a=m._config.fxParamData[dj.byId("sub_product_code").get("value")].fxParametersData.maxNbrContracts;if(_17.get("checked")&&_18&&!isNaN(_18.get("value"))&&_19&&!isNaN(_19.get("value"))){if(_19.get("value")<_18.get("value")){_16+=m.getLocalization("FXUtiliseAmtGreaterMessage");_15=false;}}m._config.onSubmitErrorMsg=_16;if(_17.get("checked")&&_18&&_19){var _1b=0;for(var j=1;j<=_1a;j++){var _1c="fx_contract_nbr_amt_"+j;_1b=_1b+dj.byId(_1c).get("value");if(dj.byId(_1c).get("state")==="Error"||_1b.toFixed(2)>_18.get("value")){dj.byId(_1c).set("state","Error");dj.byId(_1c).focus();_15=false;}}}return _15;};var _1d,_1e={};_1e.fields=["beneficiary_name","beneficiary_account","beneficiary_act_cur_code","beneficiary_address","beneficiary_city","beneficiary_dom","cnaps_bank_code","cnaps_bank_name","cpty_bank_swift_bic_code","cpty_bank_address_line_1","cpty_bank_address_line_2","cpty_bank_dom","cpty_branch_code","cpty_branch_name","pre_approved"];_1e.toggleReadonly=function(_1f){m.toggleFieldsReadOnly(this.fields,_1f);};_1e.clear=function(){d.forEach(this.fields,function(_20,i){if(dj.byId(_20)){dj.byId(_20).set("value","");}});d.style("PAB","display","none");};function _21(){var _22=dj.byId("applicant_act_pab").get("value");if(_22=="Y"){_1e.toggleReadonly(true);}else{_1e.toggleReadonly(false);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}}d.style("PAB","display","none");_1e.clear();dj.byId("pre_approved_status").set("value","N");dj.byId("beneficiary_act_cur_code").set("value","CNY");dj.byId("beneficiary_act_cur_code").set("readOnly",true);m.clearBeneficiaryAdviceFieldsForDefaultingFromBeneMaster();};function _23(){var _24=dj.byId("regexValue");var _25=dj.byId("allowedProducts");var _26=_24?dj.byId("regexValue").get("value"):"";var _27=_25?dj.byId("allowedProducts").get("value"):"";var _28="HVPS";var _29=dj.byId("beneficiary_name");var _2a=_29?dj.byId("beneficiary_name").get("value"):"";var _2b=dj.byId("account_no");var _2c=_2b?dj.byId("account_no").get("value"):"";var _2d=new RegExp(_26);var _2e=false;var _2f=null;if(_27.indexOf(_28)<0){if(_26!==null&&_26!==""&&_2a!==""&&_2a!==null){_2e=_2d.test(_2a);if(!_2e){_2f=m.getLocalization("invalidBeneficiaryName");_29.set("state","Error");dj.hideTooltip(_29.domNode);dj.showTooltip(_2f,_29.domNode,0);}}}else{m._config.forceSWIFTValidation=false;}};function _30(){var _31=dj.byId("beneficiary_name").get("value");_23();if(_31!==""){if(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y"){if(m._config.non_pab_allowed){d.style("PAB","display","inline");}else{d.style("PAB","display","none");}if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}_1e.toggleReadonly(true);}else{d.style("PAB","display","none");if((dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")==="")||(dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")===null)){_1e.toggleReadonly(false);dj.byId("cnaps_bank_name").set("readOnly",false);dj.byId("beneficiary_act_cur_code").set("readOnly",true);}else{_1e.toggleReadonly(true);dj.byId("cnaps_bank_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}}}}};function _32(){var _33=dj.byId("applicant_act_cur_code").get("value");var _34=dj.byId("beneficiary_act_cur_code").get("value");if(_33!==""&&_34!=""&&_33!==_34){m.dialog.show("ERROR",m.getLocalization("mismatchFrom"));dj.byId("applicant_act_pab").set("value","");dj.byId("applicant_act_name").set("value","");dj.byId("applicant_act_cur_code").set("value","");dj.byId("applicant_act_no").set("value","");dj.byId("beneficiary_name").set("value","");dj.byId("beneficiary_account").set("value","");if(dj.byId("cpty_bank_name")){dj.byId("cpty_bank_name").set("value","");}dj.byId("cnaps_bank_name").set("value","");dj.byId("cnaps_bank_code").set("value","");dj.byId("business_type").set("value","");dj.byId("business_detail_type").set("value","");return;}else{dj.byId("ft_cur_code").set("value",_34);return;}};function _35(){var _36=dj.byId("notify_beneficiary").get("checked");var _37=dj.byId("notify_beneficiary_choice_1");var _38=dj.byId("notify_beneficiary_choice_2");var _39=dj.byId("notify_beneficiary_email");_37.set("disabled",!_36);_38.set("disabled",!_36);_39.set("disabled",true);_37.set("checked",_36);_38.set("checked",false);_39.set("value","");var _3a=d.byId("notify_beneficiary_email_node");var _3b=d.byId("label_notify_beneficiary_choice_1");d.place(_3a,_3b,"after");var _3c=dj.byId("bene_email_1").get("value");if(!_3c){_3c=dj.byId("bene_email_2").get("value");}if(_3c&&_36){_39.set("value",_3c);_39.set("readOnly",true);}if(!_3c&&_36){if(dj.byId("beneficiary_name")&&dj.byId("beneficiary_name").get("value")===""){m.dialog.show("ERROR",m.getLocalization("noBeneficiaryEmail"));}_38.set("checked",true);var _3d=d.byId("label_notify_beneficiary_choice_2");d.place(_3a,_3d,"after");_39.set("disabled",false);}m.toggleRequired("notify_beneficiary_email",_36);m.toggleRequired("notify_beneficiary_choice_1",_36);m.toggleRequired("notify_beneficiary_choice_2",_36);};function _3e(){var _3f=dj.byId("notify_beneficiary_choice_2").get("checked")&&!dj.byId("notify_beneficiary_choice_2").get("disabled");var _40=dj.byId("notify_beneficiary_email");var _41=dj.byId("notify_beneficiary_choice_1");var _42=dj.byId("notify_beneficiary_choice_2");var _43=d.byId("notify_beneficiary_email_node");var _44=d.byId("label_notify_beneficiary_choice_1");var _45=d.byId("label_notify_beneficiary_choice_2");var _46=dj.byId("bene_email_1").get("value");if(!_46){_46=dj.byId("bene_email_2").get("value");}if(_3f){d.place(_43,_45,"after");_40.set("disabled",false);}else{if(!_46){m.dialog.show("ERROR",m.getLocalization("noBeneficiaryEmail"));_42.set("checked",true);_40.set("disabled",false);}else{d.place(_43,_44,"after");}}if(_46&&!_3f){_40.set("value",_46);_40.set("readOnly",true);}else{_40.set("value","");_40.set("readOnly",false);_40.set("disabled",false);}};function _47(){var _48=dj.byId("applicant_act_pab").get("value");if(_48=="Y"){dj.byId("beneficiary_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",true);dj.byId("cnaps_bank_code").set("readOnly",true);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}}else{if(m._config.non_pab_allowed){dj.byId("beneficiary_name").set("readOnly",false);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",false);dj.byId("cnaps_bank_code").set("readOnly",false);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}}else{dj.byId("beneficiary_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",true);dj.byId("cnaps_bank_code").set("readOnly",true);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}}}dojo.forEach(["pre_approved","ft_amt","beneficiary_account","beneficiary_address","beneficiary_city","","beneficiary_dom","pre_approved_status","","","cpty_bank_name","cpty_bank_address_line_1","cpty_bank_address_line_2","cpty_bank_dom","cpty_branch_address_line_1","cpty_branch_address_line_2","cpty_branch_dom","","","cpty_bank_swift_bic_code","cnaps_bank_code","cpty_branch_code","cpty_branch_name","","beneficiary_name","","","bene_adv_beneficiary_id_no_send","bene_adv_mailing_name_add_1_no_send","bene_adv_mailing_name_add_2_no_send","bene_adv_mailing_name_add_3_no_send","bene_adv_mailing_name_add_4_no_send","bene_adv_mailing_name_add_5_no_send","bene_adv_mailing_name_add_6_no_send","bene_adv_postal_code_no_send","bene_adv_country_no_send","bene_email_1","bene_email_2","beneficiary_postal_code","beneficiary_country","bene_adv_fax_no_send","bene_adv_ivr_no_send","bene_adv_phone_no_send","cnaps_bank_name"],function(_49){if(dj.byId(_49)){dj.byId(_49).set("value","");}});if(d.byId(_2)&&(d.style(d.byId(_2),"display")!=="none")){m.animate("wipeOut",d.byId(_2));}d.style("PAB","display","none");if(d.byId("clear_img")){if(_48=="Y"&&d.style(d.byId("clear_img"),"display")!=="none"){m.animate("wipeOut",d.byId("clear_img"));}else{if(_48=="N"&&d.style(d.byId("clear_img"),"display")=="none"){m.animate("wipeIn",d.byId("clear_img"));}}}};function _4a(){var _4b=dj.byId("applicant_act_no").get("value");if(_4b===""){m.dialog.show("ERROR",m.getLocalization("selectDebitFirst"));return;}var _4c=dj.byId("entity")?dj.byId("entity").get("value"):"";var _4d=dijit.byId("sub_product_code").get("value");m.showSearchDialog("cnaps_beneficiary_accounts","['pre_approved','beneficiary_account','beneficiary_act_cur_code', 'beneficiary_address', 'beneficiary_city', '', 'beneficiary_dom', 'pre_approved_status','','', "+"'cpty_bank_name', 'cpty_bank_address_line_1', 'cpty_bank_address_line_2', 'cpty_bank_dom', 'cpty_branch_address_line_1', 'cpty_branch_address_line_2', 'cpty_branch_dom','','', "+"'cpty_bank_swift_bic_code', 'cpty_bank_code', 'cpty_branch_code', 'cpty_branch_name','beneficiary_name', '','','bene_adv_beneficiary_id_no_send', "+"'bene_adv_mailing_name_add_1_no_send','bene_adv_mailing_name_add_2_no_send','bene_adv_mailing_name_add_3_no_send','bene_adv_mailing_name_add_4_no_send', "+"'bene_adv_mailing_name_add_5_no_send','bene_adv_mailing_name_add_6_no_send','bene_adv_postal_code_no_send','bene_adv_country_no_send','bene_email_1',"+"'bene_email_2','beneficiary_postal_code','beneficiary_country','bene_adv_fax_no_send',  'bene_adv_phone_no_send','beneficiary_nickname', 'cnaps_bank_code', 'cnaps_bank_name', 'mailing_address']",{product_type:_4d,entity_name:_4c,pabAccStat:dijit.byId("applicant_act_pab").get("value")},"",_4d,"width:710px;height:350px;",m.getLocalization("LIST_TITLE_SDATA_LIST_OF_BANKS"),"","GetStaticData",false,"GetStaticData");if(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y"){if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}}else{d.style("PAB","display","none");}};function _4e(){var _4f=dj.byId("sub_product_code"),_50=dj.byId("beneficiary_account"),_51=dj.byId("beneficiary_act_cur_code");var _52=false;m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/ValidateBeneficiaryMasterAccount"),handleAs:"json",sync:true,content:{account_number:_50.get("value"),account_cur_code:_51.get("value"),sub_product_code:_4f.get("value")},load:function(_53,_54){switch(_53.items.StatusCode){case "OK":_51.set("value",_53.items.AcctCur);_52=true;break;case "ERR_INVALID_ACCOUNT_NUMBER":_1d=misys.getLocalization("invalidAccountNumber",[_50.get("value")]);_50.focus();_50.set("value","");_50.set("state","Error");dj.hideTooltip(_50.domNode);dj.showTooltip(_1d,_50.domNode,0);break;case "ERR_INVALID_INTERFACE_PROCESSING_ERROR":_1d=misys.getLocalization("accountValidationInterfaceError");_50.focus();_50.set("value","");_50.set("state","Error");dj.hideTooltip(_50.domNode);dj.showTooltip(_1d,_50.domNode,0);break;default:_1d=_53.items.StatusCodeMessage;_50.focus();_50.set("value","");_50.set("state","Error");dj.hideTooltip(_50.domNode);dj.showTooltip(_1d,_50.domNode,0);break;}},error:function(_55,_56){console.error("[Could not validate Beneficiary Account] "+_50.get("value"));console.error(_55);}});return _52;};d.mixin(m._config,{initReAuthParams:function(){var _57={productCode:"FT",subProductCode:dj.byId("sub_product_code")?dj.byId("sub_product_code").get("value"):"",transactionTypeCode:"01",entity:dj.byId("entity")?dj.byId("entity").get("value"):"",currency:dj.byId("ft_cur_code")?dj.byId("ft_cur_code").get("value"):"",amount:dj.byId("ft_amt")?m.trimAmount(dj.byId("ft_amt").get("value")):"",es_field1:dj.byId("ft_amt")?m.trimAmount(dj.byId("ft_amt").get("value")):"",es_field2:(dj.byId("beneficiary_account"))?dj.byId("beneficiary_account").get("value"):""};return _57;}});d.mixin(m,{fireFXAction:function(){if(m._config.fxParamData&&dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""){var _58=m._config.fxParamData[dj.byId("sub_product_code").get("value")];if(m._config.fxParamData&&_58.fxParametersData.isFXEnabled==="Y"){var _59,_5a;var _5b="";if(dj.byId("ft_cur_code")){_5b=dj.byId("ft_cur_code").get("value");}var _5c=dj.byId("ft_amt").get("value");var _5d=dj.byId("applicant_act_cur_code").get("value");var _5e=m._config.productCode;var _5f="";if(dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""){_5f=dj.byId("issuing_bank_abbv_name").get("value");}var _60=dj.byId("applicant_act_cur_code").get("value");var _61=false;if(_5b!==""&&!isNaN(_5c)&&_5e!==""&&_5f!==""){if(_5b!==_5d){_59=_5d;_5a=_5b;_60=_5d;}if(_59&&_59!==""&&_5a&&_5a!==""){if(d.byId(_2)&&(d.style(d.byId(_2),"display")==="none")){m.animate("wipeIn",d.byId(_2));}m.fetchFXDetails(_59,_5a,_5c,_5e,_5f,_60,_61);if(dj.byId("fx_rates_type_1")&&dj.byId("fx_rates_type_1").get("checked")){if(isNaN(dj.byId("fx_exchange_rate").get("value"))||dj.byId("fx_exchange_rate_cur_code").get("value")===""||isNaN(dj.byId("fx_exchange_rate_amt").get("value"))||(m._config.fxParamData[dj.byId("sub_product_code").get("value")].fxParametersData.toleranceDispInd==="Y"&&(isNaN(dj.byId("fx_tolerance_rate").get("value"))||isNaN(dj.byId("fx_tolerance_rate_amt").get("value"))||dj.byId("fx_tolerance_rate_cur_code").get("value")===""))){_3(m.getLocalization("FXDefaultErrorMessage"));}}}else{if(d.byId(_2)&&(d.style(d.byId(_2),"display")!=="none")){m.animate("wipeOut",d.byId(_2));}m.defaultBindTheFXTypes();}}}}},bind:function(){m.setValidation("iss_date",m.validateTransferDateCustomer);m.setValidation("template_id",m.validateTemplateId);m.connect("beneficiary_name","onChange",m.checkBeneficiaryNicknameDiv);m.connect("applicant_act_name","onChange",m.checkNickNameDiv);m.connect("applicant_act_no","onChange",_47);m.connect("entity","onClick",m.validateRequiredField);m.connect("applicant_act_name","onClick",m.validateRequiredField);m.connect("beneficiary_name","onClick",m.validateRequiredField);m.connect("beneficiary_act_cur_code","onClick",m.validateRequiredField);m.connect("beneficiary_account","onClick",m.validateRequiredField);m.connect("cnaps_bank_code","onClick",m.validateRequiredField);m.connect("cnaps_bank_name","onClick",m.validateRequiredField);dj.byId("sub_product_code").set("value","HVPS");m.bindRecurringFields();m.connect("ft_cur_code","onChange",function(){m.setCurrency(this,["ft_amt"]);});m.setValidation("ft_cur_code",m.validateCurrency);m.connect("beneficiary_account","onChange",_4e);m.connect("applicant_act_name","onChange",function(){_32();});m.connect("beneficiary_act_cur_code","onChange",function(){if(dj.byId("ft_cur_code")&&!dj.byId("ft_cur_code").get("readOnly")){dj.byId("ft_cur_code").set("value",dj.byId("beneficiary_act_cur_code").get("value"));}});m.connect("entity","onChange",function(){dj.byId("applicant_act_name").set("value","");});m.connect("clear_img","onClick",function(){_21();if(dj.byId("notify_beneficiary_email")){dj.byId("notify_beneficiary").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("checked",false);dj.byId("notify_beneficiary_choice_2").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("disabled",true);dj.byId("notify_beneficiary_choice_2").set("disabled",true);dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_email").set("disabled",true);dj.byId("bene_email_1").set("value","");dj.byId("bene_email_2").set("value","");}});m.connect("beneficiary_img","onClick",_4a);m.connect("beneficiary_name","onChange",function(){_30();if(dj.byId("notify_beneficiary_email")&&dj.byId("notify_beneficiary").get("checked")){if(dj.byId("notify_beneficiary_choice_1").get("checked")){if(dj.byId("bene_email_1").get("value")!==""){dj.byId("notify_beneficiary_email").set("value",dj.byId("bene_email_1").get("value"));}else{if(dj.byId("bene_email_2").get("value")!==""){dj.byId("notify_beneficiary_email").set("value",dj.byId("bene_email_2").get("value"));}else{dj.byId("notify_beneficiary").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("checked",false);dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_email").set("disabled",true);}}}else{if(dj.byId("notify_beneficiary_choice_2").get("checked")){dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_choice_2").set("disabled",true);dj.byId("notify_beneficiary_choice_2").set("checked",false);dj.byId("notify_beneficiary").set("checked",false);}}}});m.connect("cnaps_bank_code","onBlur",_b);m.connect("recurring_flag","onClick",function(){m.showRecurring();});m.connect("pre_approved_status","onChange",function(){if(dj.byId("pre_approved_status").get("value")==="N"){if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",false);}if(dj.byId("currency")){dj.byId("currency").set("disabled",false);}}var _62=dj.byId("sub_product_code");});m.connect("notify_beneficiary","onClick",_35);m.connect("notify_beneficiary_choice_1","onClick",_3e);m.connect("notify_beneficiary_choice_2","onClick",_3e);m.setValidation("notify_beneficiary_email",m.validateEmailAddr);m.connect("notify_beneficiary_email","onBlur",_7);var _63=dj.byId("sub_product_code").get("value");if(m._config.fxParamData&&m._config.fxParamData[_63].fxParametersData.isFXEnabled==="Y"){m.connect("ft_cur_code","onBlur",function(){m.setCurrency(this,["ft_amt"]);if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});m.connect("ft_cur_code","onChange",function(){m.setCurrency(this,["ft_amt"]);if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});m.connect("ft_amt","onBlur",function(){m.setTnxAmt(this.get("value"));var _64="";if(dj.byId("ft_cur_code")){_64=dj.byId("ft_cur_code").get("value");}if(!isNaN(dj.byId("ft_amt").get("value"))&&_64!==""){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});}else{if(d.byId(_2)){d.style(_2,"display","none");}}if(dijit.byId("ft_cur_code")&&dijit.byId("ft_amt")){misys.setCurrency(dijit.byId("ft_cur_code"),["ft_amt"]);}},onFormLoad:function(){m.setCurrency(dj.byId("ft_cur_code"),["ft_amt"]);if(misys._config.nickname==="true"&&dj.byId("applicant_act_nickname")&&dj.byId("applicant_act_nickname").get("value")!==""&&d.byId("nickname")){m.animate("fadeIn",d.byId("nickname"));d.style("nickname","display","inline");d.byId("nickname").innerHTML=dj.byId("applicant_act_nickname").get("value");}else{m.animate("fadeOut",d.byId("applicant_act_nickname_row"));}m.initForm();if(dj.byId("notify_beneficiary").get("checked")&&dj.byId("notify_beneficiary_choice_1").get("checked")&&(dijit.byId("mode").value==="DRAFT")){var _65=d.byId("notify_beneficiary_email_node");var _66=d.byId("label_notify_beneficiary_choice_2");_3e();if(dj.byId("notify_beneficiary_choice_2").get("checked")){d.place(_65,_66,"after");}}m.checkBeneficiaryNicknameOnFormLoad();dj.byId("free_format_text").set("required",true);if(document.getElementById("mandatorySpan")==undefined){var _67=dojo.create("span",{"id":"mandatorySpan","class":"required-field-symbol","innerHTML":"*"});d.parser.parse(_67);dojo.place(_67,dojo.byId("free_format_text"),"before");}if(dj.byId("applicant_act_product_types")&&dj.byId("applicant_act_no").get("value")!==""){m.toggleRequired("applicant_act_product_types",false);}var _68=dj.byId("notify_beneficiary_email");var _69=dj.byId("notify_beneficiary_choice");if(_68&&_68.get("value")!==""&&_69&&(_69.get("value")=="default_email")){dj.byId("bene_email_1").set("value",_68.get("value"));}if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")){dj.byId("recurring_flag").set("checked",true);m.showSavedRecurringDetails(false);}else{if(d.byId("recurring_payment_div")){d.style("recurring_payment_div","display","none");}m.hasRecurringPayment();m.showSavedRecurringDetails(false);}if(m._config.fxParamData&&dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""&&dj.byId("sub_product_code").get("value")!=="IBG"){m.initializeFX(dj.byId("sub_product_code").get("value"));if(dj.byId("applicant_act_cur_code")&&dj.byId("applicant_act_cur_code").get("value")!==""&&dj.byId("ft_cur_code")&&dj.byId("ft_cur_code").get("value")!==""&&dj.byId("applicant_act_cur_code").get("value")!==dj.byId("ft_cur_code").get("value")){m.onloadFXActions();}else{m.defaultBindTheFXTypes();}}else{m.animate("fadeOut",_1);}if(d.byId(_2)){if(dj.byId("bulk_ref_id").get("value")!==""&&dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.initializeFX(dj.byId("sub_product_code").get("value"));m.fireFXAction();}else{if((dj.byId("fx_exchange_rate_cur_code")&&dj.byId("fx_exchange_rate_cur_code").get("value")!=="")||(dj.byId("fx_total_utilise_cur_code")&&dj.byId("fx_total_utilise_cur_code").get("value")!=="")){m.animate("wipeIn",d.byId(_2));}else{d.style(_2,"display","none");}}}},initForm:function(){dj.byId("sub_product_code").set("value","HVPS");if(dj.byId("ft_cur_code")!==undefined){dj.byId("ft_cur_code").set("value","CNY");}dj.byId("beneficiary_act_cur_code").set("value","CNY");if(document.getElementById("mandatorySpan")==undefined){var _6a=dojo.create("span",{"id":"mandatorySpan","class":"required-field-symbol","innerHTML":"*"});d.parser.parse(_6a);}var _6b=dj.byId("applicant_act_pab").get("value");if(_6b==="Y"||(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y")){if(m._config.non_pab_allowed){d.style("PAB","display","inline");}else{d.style("PAB","display","none");}_1e.toggleReadonly(true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}if(dj.byId("currency")){dj.byId("currency").set("disabled",true);}}else{if((dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")==="")||(dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")===null)){_1e.toggleReadonly(false);dj.byId("beneficiary_act_cur_code").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",false);}if(dj.byId("currency")){dj.byId("currency").set("disabled",false);}}else{_1e.toggleReadonly(true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}if(dj.byId("currency")){dj.byId("currency").set("disabled",true);}}}d.forEach(d.query(".CUR"),function(_6c,i){d.style(_6c,"display","inline");});dj.byId("beneficiary_mode").set("value","02");if(d.byId("clear_img")){if(_6b=="Y"&&d.style(d.byId("clear_img"),"display")!=="none"){m.animate("wipeOut",d.byId("clear_img"));}}},beforeSaveValidations:function(){var _6d=dj.byId("entity");if(_6d&&_6d.get("value")==""){return false;}else{return true;}},beforeSubmitValidations:function(){var _6e=dijit.byId("mode")?dijit.byId("mode").get("value"):"";if(_6e==="DRAFT"){if(!_4e()){return false;}}if(dj.byId("ft_amt")){if(!m.validateAmount((dj.byId("ft_amt")))){m._config.onSubmitErrorMsg=m.getLocalization("amountcannotzero");dj.byId("ft_amt").set("value","");return false;}}if(dijit.byId("free_format_text")){if(dijit.byId("free_format_text").get("required")){var _6f=dijit.byId("free_format_text").get("value").trim();if(_6f.length===0){dj.byId("free_format_text").set("value","");dj.byId("free_format_text").set("state","Error");return false;}}}if(!m.isRecurringDetailsValidForSubmit()){return false;}if(m._config.fxParamData&&m._config.fxParamData[dj.byId("sub_product_code").get("value")].fxParametersData.isFXEnabled==="Y"){if(!m.fxBeforeSubmitValidation()){return false;}if(!_14()){return false;}}if(dj.byId("notify_beneficiary_email")&&dj.byId("notify_beneficiary_email").get("value")!==""){var _70=dj.byId("notify_beneficiary_email").get("value");var _71=_70.split(";");if(_71.length>10){m._config.onSubmitErrorMsg=m.getLocalization("checkEmailId");dj.byId("notify_beneficiary_email").set("value","");return false;}}var _72=dj.byId("applicant_act_no").get("value");var _73=m.checkAccountStatus(_72);if(!_73){m._config.onSubmitErrorMsg=misys.getLocalization("accountStatusError");return false;}if(!dj.byId("bulk_ref_id").get("value")){var _74=false;if(_6e==="DRAFT"){if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")){_74=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code",_6e,["Start Date"],["recurring_start_date"],"entity","ft_cur_code","ft_amt");}else{_74=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code",_6e,["Transfer Date"],["iss_date"],"entity","ft_cur_code","ft_amt");}}else{if(_6e==="UNSIGNED"){if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("value")==="Y"){_74=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code_unsigned",_6e,["Start Date"],["recurring_start_date_unsigned"],"display_entity_unsigned","ft_cur_code_unsigned","ft_amt_unsigned");}else{_74=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code_unsigned",_6e,["Transfer Date"],["iss_date_unsigned"],"display_entity_unsigned","ft_cur_code_unsigned","ft_amt_unsigned");}}else{m._config.onSubmitErrorMsg=m.getLocalization("technicalErrorWhileValidatingBusinessDays");_74=false;}}if(_74){m._config.holidayCutOffEnabled=false;}return _74;}else{return true;}},showListOfBanks:function(){var _75=dijit.byId("sub_product_code").get("value");m.showSearchDialog("bank","['cpty_bank_name', 'cpty_bank_address_line_1', 'cpty_bank_address_line_2', 'cpty_bank_dom', 'cpty_bank_swift_bic_code', 'cpty_bank_contact_name', 'cpty_bank_phone', 'bank_country']",{swiftcode:false,bankcode:false},"","","width:710px;height:350px;",m.getLocalization("ListOfSwiftBanksTitleMessage"));}});})(dojo,dijit,misys);}