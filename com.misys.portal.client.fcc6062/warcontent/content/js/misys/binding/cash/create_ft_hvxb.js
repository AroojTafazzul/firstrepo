/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.cash.create_ft_hvxb"]){dojo._hasResource["misys.binding.cash.create_ft_hvxb"]=true;dojo.provide("misys.binding.cash.create_ft_hvxb");dojo.require("dojo.parser");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("misys.form.common");dojo.require("misys.form.file");dojo.require("misys.validation.common");dojo.require("misys.binding.cash.ft_common");dojo.require("misys.form.BusinessDateTextBox");dojo.require("misys.binding.core.beneficiary_advice_common");(function(d,dj,m){var _1=d.byId("fx-message-type");var _2="fx-section";function _3(_4){var _5=function(){var _6=dijit.byId("ft_amt");_6.set("state","Error");m.defaultBindTheFXTypes();dj.byId("ft_amt").set("value","");if(dj.byId("ft_cur_code")&&!dj.byId("ft_cur_code").get("readOnly")){dj.byId("ft_cur_code").set("value","");}};m.dialog.show("ERROR",_4,"",function(){setTimeout(_5,500);});if(d.byId(_2)&&(d.style(d.byId(_2),"display")!=="none")){m.animate("wipeOut",d.byId(_2));}};function _7(){var _8=dj.byId("cnaps_bank_code"),_9=dj.byId("cnaps_bank_name"),_a=dj.byId("product_type").get("value"),_b="";if(_8){if(!(_8.get("value")==="")){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/ValidateCNAPSBankCode"),handleAs:"json",sync:true,content:{cnaps_bank_code:_8.get("value"),sub_product_code:_a},load:function(_c,_d){if(_c.items.valid===false){_b=misys.getLocalization("invalidCNAPSBankCode",[_8.get("value")]);_9.set("value","");_8.set("state","Error");dj.hideTooltip(_8.domNode);dj.showTooltip(_b,_8.domNode,0);}else{_9.set("value",_c.items.bankName);}},error:function(_e,_f){console.error("[Could not validate CNAPS Bank Code] "+_8.get("value"));console.error(_e);}});}else{_9.set("value","");_8.set("value","");}}};function _10(){var _11=true;var _12="";var _13=dj.byId("fx_rates_type_2");var _14=dj.byId("fx_total_utilise_amt");var _15=dj.byId("ft_amt");var _16=m._config.fxParamData[dj.byId("sub_product_code").get("value")].fxParametersData.maxNbrContracts;if(_13.get("checked")&&_14&&!isNaN(_14.get("value"))&&_15&&!isNaN(_15.get("value"))){if(_15.get("value")<_14.get("value")){_12+=m.getLocalization("FXUtiliseAmtGreaterMessage");_11=false;}}m._config.onSubmitErrorMsg=_12;if(_13.get("checked")&&_14&&_15){var _17=0;for(var j=1;j<=_16;j++){var _18="fx_contract_nbr_amt_"+j;_17=_17+dj.byId(_18).get("value");if(dj.byId(_18).get("state")==="Error"||_17.toFixed(2)>_14.get("value")){dj.byId(_18).set("state","Error");dj.byId(_18).focus();_11=false;}}}return _11;};var _19,_1a={};_1a.fields=["beneficiary_name","beneficiary_account","beneficiary_act_cur_code","beneficiary_address","beneficiary_city","beneficiary_dom","cnaps_bank_code","cnaps_bank_name","cpty_bank_swift_bic_code","cpty_bank_address_line_1","cpty_bank_address_line_2","cpty_bank_dom","cpty_branch_code","cpty_branch_name","pre_approved"];_1a.toggleReadonly=function(_1b){m.toggleFieldsReadOnly(this.fields,_1b);};_1a.clear=function(){d.forEach(this.fields,function(_1c,i){if(dj.byId(_1c)){dj.byId(_1c).set("value","");}});d.style("PAB","display","none");};function _1d(){var _1e=dj.byId("applicant_act_pab").get("value");if(_1e=="Y"){_1a.toggleReadonly(true);}else{_1a.toggleReadonly(false);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}}d.style("PAB","display","none");_1a.clear();dj.byId("pre_approved_status").set("value","N");dj.byId("beneficiary_act_cur_code").set("value","CNY");dj.byId("beneficiary_act_cur_code").set("readOnly",true);m.clearBeneficiaryAdviceFieldsForDefaultingFromBeneMaster();};function _1f(){var _20=dj.byId("regexValue");var _21=dj.byId("allowedProducts");var _22=_20?dj.byId("regexValue").get("value"):"";var _23=_21?dj.byId("allowedProducts").get("value"):"";var _24="HVXB";var _25=dj.byId("beneficiary_name");var _26=_25?dj.byId("beneficiary_name").get("value"):"";var _27=dj.byId("account_no");var _28=_27?dj.byId("account_no").get("value"):"";var _29=new RegExp(_22);var _2a=false;var _2b=null;if(_23.indexOf(_24)<0){if(_22!==null&&_22!==""&&_26!==""&&_26!==null){_2a=_29.test(_26);if(!_2a){_2b=m.getLocalization("invalidBeneficiaryName");_25.set("state","Error");dj.hideTooltip(_25.domNode);dj.showTooltip(_2b,_25.domNode,0);}}}else{m._config.forceSWIFTValidation=false;}};function _2c(){var _2d=dj.byId("beneficiary_name").get("value");_1f();if(_2d!==""){if(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y"){if(m._config.non_pab_allowed){d.style("PAB","display","inline");}else{d.style("PAB","display","none");}if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}_1a.toggleReadonly(true);}else{d.style("PAB","display","none");if((dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")==="")||(dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")===null)){_1a.toggleReadonly(false);dj.byId("cnaps_bank_name").set("readOnly",false);dj.byId("beneficiary_act_cur_code").set("readOnly",true);}else{_1a.toggleReadonly(true);dj.byId("cnaps_bank_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}}}}};function _2e(){var _2f=dj.byId("applicant_act_cur_code").get("value");var _30=dj.byId("beneficiary_act_cur_code").get("value");if(_2f!==""&&_30!=""&&_2f!==_30){m.dialog.show("ERROR",m.getLocalization("mismatchFrom"));dj.byId("applicant_act_name").set("value","");dj.byId("applicant_act_pab").set("value","");dj.byId("applicant_act_cur_code").set("value","");dj.byId("applicant_act_no").set("value","");dj.byId("beneficiary_name").set("value","");dj.byId("beneficiary_account").set("value","");if(dj.byId("cpty_bank_name")){dj.byId("cpty_bank_name").set("value","");}dj.byId("cnaps_bank_name").set("value","");dj.byId("cnaps_bank_code").set("value","");dj.byId("business_type").set("value","");dj.byId("business_detail_type").set("value","");return;}else{dj.byId("ft_cur_code").set("value",_30);return;}};function _31(){var _32=dj.byId("notify_beneficiary").get("checked");var _33=dj.byId("notify_beneficiary_choice_1");var _34=dj.byId("notify_beneficiary_choice_2");var _35=dj.byId("notify_beneficiary_email");_33.set("disabled",!_32);_34.set("disabled",!_32);_35.set("disabled",true);_33.set("checked",_32);_34.set("checked",false);_35.set("value","");var _36=d.byId("notify_beneficiary_email_node");var _37=d.byId("label_notify_beneficiary_choice_1");d.place(_36,_37,"after");var _38=dj.byId("bene_email_1").get("value");if(!_38){_38=dj.byId("bene_email_2").get("value");}if(_38&&_32){_35.set("value",_38);_35.set("readOnly",true);}if(!_38&&_32){if(dj.byId("beneficiary_name")&&dj.byId("beneficiary_name").get("value")===""){m.dialog.show("ERROR",m.getLocalization("noBeneficiaryEmail"));}_34.set("checked",true);var _39=d.byId("label_notify_beneficiary_choice_2");d.place(_36,_39,"after");_35.set("disabled",false);}m.toggleRequired("notify_beneficiary_email",_32);m.toggleRequired("notify_beneficiary_choice_1",_32);m.toggleRequired("notify_beneficiary_choice_2",_32);};function _3a(){var _3b=dj.byId("notify_beneficiary_choice_2").get("checked")&&!dj.byId("notify_beneficiary_choice_2").get("disabled");var _3c=dj.byId("notify_beneficiary_email");var _3d=dj.byId("notify_beneficiary_choice_1");var _3e=dj.byId("notify_beneficiary_choice_2");var _3f=d.byId("notify_beneficiary_email_node");var _40=d.byId("label_notify_beneficiary_choice_1");var _41=d.byId("label_notify_beneficiary_choice_2");var _42=dj.byId("bene_email_1").get("value");if(!_42){_42=dj.byId("bene_email_2").get("value");}if(_3b){d.place(_3f,_41,"after");}else{if(!_42){m.dialog.show("ERROR",m.getLocalization("noBeneficiaryEmail"));_3e.set("checked",true);}else{d.place(_3f,_40,"after");}}if(_42&&!_3b){_3c.set("value",_42);_3c.set("readOnly",true);}else{_3c.set("value","");_3c.set("disabled",false);_3c.set("readOnly",false);}};function _43(){var _44=dj.byId("applicant_act_pab").get("value");if(_44=="Y"){dj.byId("beneficiary_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",true);dj.byId("cnaps_bank_code").set("readOnly",true);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}}else{if(m._config.non_pab_allowed){dj.byId("beneficiary_name").set("readOnly",false);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",false);dj.byId("cnaps_bank_code").set("readOnly",false);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}}else{dj.byId("beneficiary_name").set("readOnly",true);dj.byId("beneficiary_act_cur_code").set("readOnly",true);dj.byId("beneficiary_account").set("readOnly",true);dj.byId("cnaps_bank_code").set("readOnly",true);dj.byId("cnaps_bank_name").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}}}dojo.forEach(["pre_approved","ft_amt","beneficiary_account","beneficiary_address","beneficiary_city","","beneficiary_dom","pre_approved_status","","","cpty_bank_name","cpty_bank_address_line_1","cpty_bank_address_line_2","cpty_bank_dom","cpty_branch_address_line_1","cpty_branch_address_line_2","cpty_branch_dom","","","cpty_bank_swift_bic_code","cnaps_bank_code","cpty_branch_code","cpty_branch_name","","beneficiary_name","","","bene_adv_beneficiary_id_no_send","bene_adv_mailing_name_add_1_no_send","bene_adv_mailing_name_add_2_no_send","bene_adv_mailing_name_add_3_no_send","bene_adv_mailing_name_add_4_no_send","bene_adv_mailing_name_add_5_no_send","bene_adv_mailing_name_add_6_no_send","bene_adv_postal_code_no_send","bene_adv_country_no_send","bene_email_1","bene_email_2","beneficiary_postal_code","beneficiary_country","bene_adv_fax_no_send","bene_adv_ivr_no_send","bene_adv_phone_no_send","cnaps_bank_name"],function(_45){if(dj.byId(_45)){dj.byId(_45).set("value","");}});if(d.byId(_2)&&(d.style(d.byId(_2),"display")!=="none")){m.animate("wipeOut",d.byId(_2));}d.style("PAB","display","none");if(d.byId("clear_img")){if(_44=="Y"&&d.style(d.byId("clear_img"),"display")!=="none"){m.animate("wipeOut",d.byId("clear_img"));}else{if(_44=="N"&&d.style(d.byId("clear_img"),"display")=="none"){m.animate("wipeIn",d.byId("clear_img"));}}}};function _46(){var _47=dj.byId("applicant_act_no").get("value");if(_47===""){m.dialog.show("ERROR",m.getLocalization("selectDebitFirst"));return;}var _48=dj.byId("entity")?dj.byId("entity").get("value"):"";var _49=dijit.byId("sub_product_code").get("value");m.showSearchDialog("cnaps_beneficiary_accounts","['pre_approved','beneficiary_account','beneficiary_act_cur_code', 'beneficiary_address', 'beneficiary_city', '', 'beneficiary_dom', 'pre_approved_status','','', "+"'cpty_bank_name', 'cpty_bank_address_line_1', 'cpty_bank_address_line_2', 'cpty_bank_dom', 'cpty_branch_address_line_1', 'cpty_branch_address_line_2', 'cpty_branch_dom','','', "+"'cpty_bank_swift_bic_code', 'cpty_bank_code', 'cpty_branch_code', 'cpty_branch_name','beneficiary_name', '','','bene_adv_beneficiary_id_no_send', "+"'bene_adv_mailing_name_add_1_no_send','bene_adv_mailing_name_add_2_no_send','bene_adv_mailing_name_add_3_no_send','bene_adv_mailing_name_add_4_no_send', "+"'bene_adv_mailing_name_add_5_no_send','bene_adv_mailing_name_add_6_no_send','bene_adv_postal_code_no_send','bene_adv_country_no_send','bene_email_1',"+"'bene_email_2','beneficiary_postal_code','beneficiary_country','bene_adv_fax_no_send',  'bene_adv_phone_no_send','beneficiary_nickname', 'cnaps_bank_code', 'cnaps_bank_name', 'mailing_address']",{product_type:_49,entity_name:_48,pabAccStat:dijit.byId("applicant_act_pab").get("value")},"",_49,"width:710px;height:350px;",m.getLocalization("LIST_TITLE_SDATA_LIST_OF_BANKS"),"","GetStaticData",false,"GetStaticData");if(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y"){if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}}else{d.style("PAB","display","none");}};function _4a(){var _4b=dj.byId("sub_product_code"),_4c=dj.byId("beneficiary_account"),_4d=dj.byId("beneficiary_act_cur_code");var _4e=false;m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/ValidateBeneficiaryMasterAccount"),handleAs:"json",sync:true,content:{account_number:_4c.get("value"),account_cur_code:_4d.get("value"),sub_product_code:_4b.get("value")},load:function(_4f,_50){switch(_4f.items.StatusCode){case "OK":_4d.set("value",_4f.items.AcctCur);_4e=true;break;case "ERR_INVALID_ACCOUNT_NUMBER":_19=misys.getLocalization("invalidAccountNumber",[_4c.get("value")]);_4c.focus();_4c.set("value","");_4c.set("state","Error");dj.hideTooltip(_4c.domNode);dj.showTooltip(_19,_4c.domNode,0);break;case "ERR_INVALID_INTERFACE_PROCESSING_ERROR":_19=misys.getLocalization("accountValidationInterfaceError");_4c.focus();_4c.set("value","");_4c.set("state","Error");dj.hideTooltip(_4c.domNode);dj.showTooltip(_19,_4c.domNode,0);break;default:_19=_4f.items.StatusCodeMessage;_4c.focus();_4c.set("value","");_4c.set("state","Error");dj.hideTooltip(_4c.domNode);dj.showTooltip(_19,_4c.domNode,0);break;}},error:function(_51,_52){console.error("[Could not validate Beneficiary Account] "+_4c.get("value"));console.error(_51);}});return _4e;};d.mixin(m._config,{initReAuthParams:function(){var _53={productCode:"FT",subProductCode:dj.byId("sub_product_code")?dj.byId("sub_product_code").get("value"):"",transactionTypeCode:"01",entity:dj.byId("entity")?dj.byId("entity").get("value"):"",currency:dj.byId("ft_cur_code")?dj.byId("ft_cur_code").get("value"):"",amount:dj.byId("ft_amt")?m.trimAmount(dj.byId("ft_amt").get("value")):"",es_field1:dj.byId("ft_amt")?m.trimAmount(dj.byId("ft_amt").get("value")):"",es_field2:(dj.byId("beneficiary_account"))?dj.byId("beneficiary_account").get("value"):""};return _53;}});d.mixin(m,{fireFXAction:function(){if(m._config.fxParamData&&dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""){var _54=m._config.fxParamData[dj.byId("sub_product_code").get("value")];if(m._config.fxParamData&&_54.fxParametersData.isFXEnabled==="Y"){var _55,_56;var _57="";if(dj.byId("ft_cur_code")){_57=dj.byId("ft_cur_code").get("value");}var _58=dj.byId("ft_amt").get("value");var _59=dj.byId("applicant_act_cur_code").get("value");var _5a=m._config.productCode;var _5b="";if(dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""){_5b=dj.byId("issuing_bank_abbv_name").get("value");}var _5c=dj.byId("applicant_act_cur_code").get("value");var _5d=false;if(_57!==""&&!isNaN(_58)&&_5a!==""&&_5b!==""){if(_57!==_59){_55=_59;_56=_57;_5c=_59;}if(_55&&_55!==""&&_56&&_56!==""){if(d.byId(_2)&&(d.style(d.byId(_2),"display")==="none")){m.animate("wipeIn",d.byId(_2));}m.fetchFXDetails(_55,_56,_58,_5a,_5b,_5c,_5d);if(dj.byId("fx_rates_type_1")&&dj.byId("fx_rates_type_1").get("checked")){if(isNaN(dj.byId("fx_exchange_rate").get("value"))||dj.byId("fx_exchange_rate_cur_code").get("value")===""||isNaN(dj.byId("fx_exchange_rate_amt").get("value"))||(m._config.fxParamData[dj.byId("sub_product_code").get("value")].fxParametersData.toleranceDispInd==="Y"&&(isNaN(dj.byId("fx_tolerance_rate").get("value"))||isNaN(dj.byId("fx_tolerance_rate_amt").get("value"))||dj.byId("fx_tolerance_rate_cur_code").get("value")===""))){_3(m.getLocalization("FXDefaultErrorMessage"));}}}else{if(d.byId(_2)&&(d.style(d.byId(_2),"display")!=="none")){m.animate("wipeOut",d.byId(_2));}m.defaultBindTheFXTypes();}}}}},bind:function(){m.setValidation("iss_date",m.validateTransferDateCustomer);m.setValidation("template_id",m.validateTemplateId);m.connect("beneficiary_name","onChange",m.checkBeneficiaryNicknameDiv);m.connect("applicant_act_name","onChange",m.checkNickNameDiv);m.connect("applicant_act_no","onChange",_43);m.connect("entity","onClick",m.validateRequiredField);m.connect("applicant_act_name","onClick",m.validateRequiredField);m.connect("beneficiary_name","onClick",m.validateRequiredField);m.connect("beneficiary_act_cur_code","onClick",m.validateRequiredField);m.connect("beneficiary_account","onClick",m.validateRequiredField);m.connect("cnaps_bank_code","onClick",m.validateRequiredField);m.connect("cnaps_bank_name","onClick",m.validateRequiredField);dj.byId("sub_product_code").set("value","HVXB");m.bindRecurringFields();m.connect("ft_cur_code","onChange",function(){m.setCurrency(this,["ft_amt"]);});m.setValidation("ft_cur_code",m.validateCurrency);m.connect("beneficiary_account","onChange",_4a);m.connect("applicant_act_name","onChange",function(){_2e();});m.connect("beneficiary_act_cur_code","onChange",function(){if(dj.byId("ft_cur_code")&&!dj.byId("ft_cur_code").get("readOnly")){dj.byId("ft_cur_code").set("value",dj.byId("beneficiary_act_cur_code").get("value"));}});m.connect("entity","onChange",function(){dj.byId("applicant_act_name").set("value","");});m.connect("clear_img","onClick",function(){_1d();if(dj.byId("notify_beneficiary_email")){dj.byId("notify_beneficiary_email").set("value","");dj.byId("bene_email_1").set("value","");dj.byId("bene_email_2").set("value","");}});m.connect("beneficiary_img","onClick",_46);m.connect("beneficiary_name","onChange",function(){_2c();if(dj.byId("notify_beneficiary_email")&&dj.byId("notify_beneficiary").get("checked")){if(dj.byId("notify_beneficiary_choice_1").get("checked")){if(dj.byId("bene_email_1").get("value")!==""){dj.byId("notify_beneficiary_email").set("value",dj.byId("bene_email_1").get("value"));}else{if(dj.byId("bene_email_2").get("value")!==""){dj.byId("notify_beneficiary_email").set("value",dj.byId("bene_email_2").get("value"));}else{dj.byId("notify_beneficiary").set("checked",false);dj.byId("notify_beneficiary_choice_1").set("checked",false);dj.byId("notify_beneficiary_email").set("value","");dj.byId("notify_beneficiary_email").set("disabled",true);}}}else{if(dj.byId("notify_beneficiary_choice_2").get("checked")){dj.byId("notify_beneficiary_email").set("value","");}}}});m.connect("cnaps_bank_code","onBlur",_7);m.connect("recurring_flag","onClick",function(){m.showRecurring();});m.connect("pre_approved_status","onChange",function(){if(dj.byId("pre_approved_status").get("value")==="N"){if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",false);}if(dj.byId("currency")){dj.byId("currency").set("disabled",false);}}var _5e=dj.byId("sub_product_code");});m.connect("notify_beneficiary","onClick",_31);m.connect("notify_beneficiary_choice_1","onClick",_3a);m.connect("notify_beneficiary_choice_2","onClick",_3a);m.setValidation("notify_beneficiary_email",m.validateEmailAddr);var _5f=dj.byId("sub_product_code").get("value");if(m._config.fxParamData&&m._config.fxParamData[_5f].fxParametersData.isFXEnabled==="Y"){m.connect("ft_cur_code","onBlur",function(){m.setCurrency(this,["ft_amt"]);if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});m.connect("ft_cur_code","onChange",function(){m.setCurrency(this,["ft_amt"]);if(dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});m.connect("ft_amt","onBlur",function(){m.setTnxAmt(this.get("value"));var _60="";if(dj.byId("ft_cur_code")){_60=dj.byId("ft_cur_code").get("value");}if(!isNaN(dj.byId("ft_amt").get("value"))&&_60!==""){m.fireFXAction();}else{m.defaultBindTheFXTypes();}});}else{if(d.byId(_2)){d.style(_2,"display","none");}}if(dijit.byId("ft_cur_code")&&dijit.byId("ft_amt")){misys.setCurrency(dijit.byId("ft_cur_code"),["ft_amt"]);}},onFormLoad:function(){m.setCurrency(dj.byId("ft_cur_code"),["ft_amt"]);if(misys._config.nickname==="true"&&dj.byId("applicant_act_nickname")&&dj.byId("applicant_act_nickname").get("value")!==""&&d.byId("nickname")){m.animate("fadeIn",d.byId("nickname"));d.style("nickname","display","inline");d.byId("nickname").innerHTML=dj.byId("applicant_act_nickname").get("value");}else{m.animate("fadeOut",d.byId("applicant_act_nickname_row"));}m.initForm();if(dj.byId("notify_beneficiary").get("checked")&&dj.byId("notify_beneficiary_choice_1").get("checked")&&(dijit.byId("mode").value==="DRAFT")){var _61=d.byId("notify_beneficiary_email_node");var _62=d.byId("label_notify_beneficiary_choice_2");_3a();if(dj.byId("notify_beneficiary_choice_2").get("checked")){d.place(_61,_62,"after");}}m.checkBeneficiaryNicknameOnFormLoad();dj.byId("free_format_text").set("required",true);if(document.getElementById("mandatorySpan")==undefined){var _63=dojo.create("span",{"id":"mandatorySpan","class":"required-field-symbol","innerHTML":"*"});d.parser.parse(_63);dojo.place(_63,dojo.byId("free_format_text"),"before");}if(dj.byId("applicant_act_product_types")&&dj.byId("applicant_act_no").get("value")!==""){m.toggleRequired("applicant_act_product_types",false);}var _64=dj.byId("notify_beneficiary_email");var _65=dj.byId("notify_beneficiary_choice");if(_64&&_64.get("value")!==""&&_65&&(_65.get("value")=="default_email")){dj.byId("bene_email_1").set("value",_64.get("value"));}if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")){dj.byId("recurring_flag").set("checked",true);m.showSavedRecurringDetails(false);}else{if(d.byId("recurring_payment_div")){d.style("recurring_payment_div","display","none");}m.hasRecurringPayment();m.showSavedRecurringDetails(false);}if(m._config.fxParamData&&dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""&&dj.byId("sub_product_code").get("value")!=="IBG"){m.initializeFX(dj.byId("sub_product_code").get("value"));if(dj.byId("applicant_act_cur_code")&&dj.byId("applicant_act_cur_code").get("value")!==""&&dj.byId("ft_cur_code")&&dj.byId("ft_cur_code").get("value")!==""&&dj.byId("applicant_act_cur_code").get("value")!==dj.byId("ft_cur_code").get("value")){m.onloadFXActions();}else{m.defaultBindTheFXTypes();}}else{m.animate("fadeOut",_1);}if(d.byId(_2)){if(dj.byId("bulk_ref_id").get("value")!==""&&dj.byId("ft_cur_code").get("value")!==""&&!isNaN(dj.byId("ft_amt").get("value"))){m.initializeFX(dj.byId("sub_product_code").get("value"));m.fireFXAction();}else{if((dj.byId("fx_exchange_rate_cur_code")&&dj.byId("fx_exchange_rate_cur_code").get("value")!=="")||(dj.byId("fx_total_utilise_cur_code")&&dj.byId("fx_total_utilise_cur_code").get("value")!=="")){m.animate("wipeIn",d.byId(_2));}else{d.style(_2,"display","none");}}}},initForm:function(){dj.byId("sub_product_code").set("value","HVXB");dj.byId("ft_cur_code").set("value","CNY");dj.byId("beneficiary_act_cur_code").set("value","CNY");if(document.getElementById("mandatorySpan")==undefined){var _66=dojo.create("span",{"id":"mandatorySpan","class":"required-field-symbol","innerHTML":"*"});d.parser.parse(_66);}var _67=dj.byId("applicant_act_pab").get("value");if(_67==="Y"||(dj.byId("pre_approved_status")&&dj.byId("pre_approved_status").get("value")==="Y")){if(m._config.non_pab_allowed){d.style("PAB","display","inline");}else{d.style("PAB","display","none");}_1a.toggleReadonly(true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}if(dj.byId("currency")){dj.byId("currency").set("disabled",true);}}else{if((dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")==="")||(dj.byId("pre_approved")&&dj.byId("pre_approved").get("value")===null)){_1a.toggleReadonly(false);dj.byId("beneficiary_act_cur_code").set("readOnly",true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",false);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",false);}if(dj.byId("currency")){dj.byId("currency").set("disabled",false);}}else{_1a.toggleReadonly(true);if(dj.byId("bank_img")){dj.byId("bank_img").set("disabled",true);}if(dj.byId("bank_iso_img")){dj.byId("bank_iso_img").set("disabled",true);}if(dj.byId("currency")){dj.byId("currency").set("disabled",true);}}}d.forEach(d.query(".CUR"),function(_68,i){d.style(_68,"display","inline");});dj.byId("beneficiary_mode").set("value","02");if(d.byId("clear_img")){if(_67=="Y"&&d.style(d.byId("clear_img"),"display")!=="none"){m.animate("wipeOut",d.byId("clear_img"));}}},beforeSaveValidations:function(){var _69=dj.byId("entity");if(_69&&_69.get("value")==""){return false;}else{return true;}},beforeSubmitValidations:function(){var _6a=dijit.byId("mode")?dijit.byId("mode").get("value"):"";if(_6a==="DRAFT"){if(!_4a()){return false;}}if(dj.byId("ft_amt")){if(!m.validateAmount((dj.byId("ft_amt")))){m._config.onSubmitErrorMsg=m.getLocalization("amountcannotzero");dj.byId("ft_amt").set("value","");return false;}}if(dijit.byId("free_format_text")){if(dijit.byId("free_format_text").get("required")){var _6b=dijit.byId("free_format_text").get("value").trim();if(_6b.length===0){dj.byId("free_format_text").set("value","");dj.byId("free_format_text").set("state","Error");return false;}}}if(!m.isRecurringDetailsValidForSubmit()){return false;}if(m._config.fxParamData&&m._config.fxParamData[dj.byId("sub_product_code").get("value")].fxParametersData.isFXEnabled==="Y"){if(!m.fxBeforeSubmitValidation()){return false;}if(!_10()){return false;}}var _6c=dj.byId("applicant_act_no").get("value");var _6d=m.checkAccountStatus(_6c);if(!_6d){m._config.onSubmitErrorMsg=misys.getLocalization("accountStatusError");return false;}if(!dj.byId("bulk_ref_id").get("value")){var _6e=false;if(_6a==="DRAFT"){if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("checked")){_6e=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code",_6a,["Start Date"],["recurring_start_date"],"entity","ft_cur_code","ft_amt");}else{_6e=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code",_6a,["Transfer Date"],["iss_date"],"entity","ft_cur_code","ft_amt");}}else{if(_6a==="UNSIGNED"){if(dj.byId("recurring_payment_enabled")&&dj.byId("recurring_payment_enabled").get("value")==="Y"){_6e=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code_unsigned",_6a,["Start Date"],["recurring_start_date_unsigned"],"display_entity_unsigned","ft_cur_code_unsigned","ft_amt_unsigned");}else{_6e=m.validateHolidaysAndCutOffTime("issuing_bank_abbv_name","sub_product_code_unsigned",_6a,["Transfer Date"],["iss_date_unsigned"],"display_entity_unsigned","ft_cur_code_unsigned","ft_amt_unsigned");}}else{m._config.onSubmitErrorMsg=m.getLocalization("technicalErrorWhileValidatingBusinessDays");_6e=false;}}if(_6e){m._config.holidayCutOffEnabled=false;}return _6e;}else{return true;}},showListOfBanks:function(){var _6f=dijit.byId("sub_product_code").get("value");m.showSearchDialog("bank","['cpty_bank_name', 'cpty_bank_address_line_1', 'cpty_bank_address_line_2', 'cpty_bank_dom', 'cpty_bank_swift_bic_code', 'cpty_bank_contact_name', 'cpty_bank_phone', 'bank_country']",{swiftcode:false,bankcode:false},"","","width:710px;height:350px;",m.getLocalization("ListOfSwiftBanksTitleMessage"));}});})(dojo,dijit,misys);}