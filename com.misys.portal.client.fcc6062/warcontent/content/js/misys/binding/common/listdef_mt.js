/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.common.listdef_mt"]){dojo._hasResource["misys.binding.common.listdef_mt"]=true;dojo.provide("misys.binding.common.listdef_mt");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojo.data.ItemFileWriteStore");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.SortedFilteringSelect");dojo.require("misys.form.MultiSelect");dojo.require("dijit.layout.TabContainer");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.RadioButton");dojo.require("misys.binding.common.reauth_listdef_common");dojo.require("misys.binding.system.reauth");dojo.require("misys.binding.common.reauth_listdef");dojo.require("misys.common");dojo.require("misys.binding.loan.ln_tnxdropdown_validation_list");(function(d,dj,m){function _1(){if(dj.byId("account_no")){dj.byId("account_no").set("disabled",true);}};function _2(){if(dj.byId("account_no")){dj.byId("account_no").set("disabled",false);}};function _3(){if(d.byId("account_search_id")){d.style(d.byId("account_search_id"),"display","none");dj.byId("account_no").set("value","");}};function _4(){if(d.byId("account_search_id")){d.style(d.byId("account_search_id"),"display","");}};function _5(){if(dj.byId("cur_code").value!==""){dj.byId("AmountRangevisible").set("disabled",false);dj.byId("AmountRange2visible").set("disabled",false);}else{if(dj.byId("cur_code").value===""){dj.byId("AmountRangevisible").set("disabled",true);dj.byId("AmountRange2visible").set("disabled",true);dj.byId("AmountRangevisible").reset();dj.byId("AmountRange2visible").reset();}}};function _6(){if(d.byId("upload_file_id")){dj.byId("upload_file_id").set("disabled",true);}};function _7(){if(d.byId("upload_file_id")){dj.byId("upload_file_id").set("disabled",false);}};function _8(){if(dj.byId("account_no")){dj.byId("account_no").set("value","");}if(dj.byId("tnx_stat_code")){dj.byId("tnx_stat_code").set("value","");}if(dj.byId("cust_ref_id")){dj.byId("cust_ref_id").set("value","");}if(dj.byId("cur_code")){dj.byId("cur_code").set("value","");}if(dj.byId("AmountRangevisible")){dj.byId("AmountRangevisible").set("value","");}if(dj.byId("AmountRange2visible")){dj.byId("AmountRange2visible").set("value","");}if(dj.byId("counterparty_name")){dj.byId("counterparty_name").set("value","");}if(dj.byId("create_date")&&dj.byId("create_date").get("value")!==""){dj.byId("create_date").set("value","");dj.byId("create_date").set("displayedValue","");}if(dj.byId("create_date2")&&dj.byId("create_date2").get("value")!==""){dj.byId("create_date2").set("value","");dj.byId("create_date2").set("displayedValue","");}if(dj.byId("maturity_date")&&dj.byId("maturity_date").get("value")!==""){dj.byId("maturity_date").set("value","");dj.byId("maturity_date").set("displayedValue","");}if(dj.byId("maturity_date2")&&dj.byId("maturity_date2").get("value")!==""){dj.byId("maturity_date2").set("value","");dj.byId("maturity_date2").set("displayedValue","");}if(dj.byId("ref_id")){dj.byId("ref_id").set("value","*");}if(dj.byId("entity")){dj.byId("entity").set("value","");}};function _9(){var _a=this.get("value"),_b=this;m._config=m._config||{};m._config.effFromAmountValidationInprocess=false;var _c=dj.byId("AmountRange2visible").get("value");var _d;if(!m._config.effToAmountValidationInprocess){if(_a<0||_a>_c){m._config.effFromAmountValidationInprocess=true;var _e=dj.byId("AmountRangevisible");if(_a>_c){_d=misys.getLocalization("invalidMinAmountValueError");}if(_a<0){_d=misys.getLocalization("invalidAmountValueError");}_e.focus();_e.set("state","Error");dj.hideTooltip(_e.domNode);dj.showTooltip(_d,_e.domNode,0);dj.showTooltip(_d,domNode,0);return false;}}m._config.effFromAmountValidationInprocess=false;return true;};function _f(){var _10=this.get("value"),_11=this;m._config=m._config||{};m._config.effToAmountValidationInprocess=false;var _12=dj.byId("AmountRangevisible").get("value");var _13;if(!m._config.effFromAmountValidationInprocess){if(_10<0||_10<_12){m._config.effToAmountValidationInprocess=true;var _14=dj.byId("AmountRange2visible");if(_10<_12){_13=misys.getLocalization("invalidMaxAmountValueError");}if(_10<0){_13=misys.getLocalization("invalidAmountValueError");}_14.focus();_14.set("state","Error");dj.hideTooltip(_14.domNode);dj.showTooltip(_13,_14.domNode,0);dj.showTooltip(_13,domNode,0);return false;}}m._config.effToAmountValidationInprocess=false;return true;};function _15(_16,_17,_18,_19){if(_16.get("value")==null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _1a;var _1b=dj.byId(_17);var _1c=function(){dj.hideTooltip(_16.domNode);};if(!m._config.effToDateValidationInprocess){if(!m.compareDateFields(_16,_1b)){m._config.effFromDateValidationInprocess=true;_1a=misys.getLocalization(_18,[_19,_1d(_16),_1d(_1b)]);_16.set("state","Error");dj.showTooltip(_1a,_16.domNode,0);setTimeout(_1c,5000);return false;}}m._config.effFromDateValidationInprocess=false;return true;};function _1d(_1e){if(_1e.get("type")==="hidden"){return d.date.locale.format(m.localizeDate(_1e),{selector:"date"});}return _1e.get("displayedValue");};function _1f(_20,_21,_22,_23){var _24;m._config=m._config||{};m._config.effToDateValidationInprocess=false;var _25=dj.byId(_21);var _26=function(){dj.hideTooltip(_20.domNode);};if(!m._config.effFromDateValidationInprocess){if(!m.compareDateFields(_25,_20)){m._config.effToDateValidationInprocess=true;_24=misys.getLocalization(_22,[_23,_1d(_20),_1d(_25)]);_20.set("state","Error");dj.showTooltip(_24,_20.domNode,0);setTimeout(_26,5000);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _27(){var _28=this;if(_28.get("value")===null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _29=dj.byId("create_date2");if(!m._config.effToDateValidationInprocess){if(!m.compareDateFields(_28,_29)){m._config.effFromDateValidationInprocess=true;var _2a=dj.byId("create_date");var _2b=misys.getLocalization("LastModifiedDateFromLesserThanLastModifiedDateTo");_2a.set("state","Error");dj.hideTooltip(_2a.domNode);dj.showTooltip(_2b,_2a.domNode,0);}}m._config.effFromDateValidationInprocess=false;return true;};function _2c(){var _2d=this;m._config=m._config||{};m._config.effToDateValidationInprocess=false;if(_2d.get("value")===null){return true;}var _2e=dj.byId("create_date");if(!m._config.effFromDateValidationInprocess){m._config.effToDateValidationInprocess=true;if(!m.compareDateFields(_2e,_2d)){var _2f=dj.byId("create_date2");var _30=misys.getLocalization("LastModifiedDateToGreaterThanLastModifiedDateFrom");_2f.set("state","Error");dj.hideTooltip(_2f.domNode);dj.showTooltip(_30,_2f.domNode,0);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _31(){var _32=this;if(_32.get("value")===null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _33=dj.byId("maturity_date2");if(!m._config.effToDateValidationInprocess){if(!m.compareDateFields(_32,_33)){m._config.effFromDateValidationInprocess=true;var _34=dj.byId("maturity_date"),_35=misys.getLocalization("maturityFromGreaterThanMaturityTo");var _36=function(){dj.hideTooltip(_34.domNode);};_34.set("state","Error");dj.showTooltip(_35,_34.domNode,0);setTimeout(_36,5000);return false;}}m._config.effFromDateValidationInprocess=false;return true;};function _37(){var _38=this;m._config=m._config||{};m._config.effToDateValidationInprocess=false;if(_38.get("value")===null){return true;}var _39=dj.byId("maturity_date");if(!m._config.effFromDateValidationInprocess){if(!m.compareDateFields(_39,_38)){m._config.effToDateValidationInprocess=true;var _3a=dj.byId("maturity_date2");var _3b=misys.getLocalization("maturityToLesserThanMaturityFrom");var _3c=function(){dj.hideTooltip(_3a.domNode);};_3a.set("state","Error");dj.showTooltip(_3b,_3a.domNode,0);setTimeout(_3c,5000);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _3d(){var _3e=this;if(_3e.get("value")===null){return true;}var _3f=dj.byId("last_modified_date2");if(!m.compareDateFields(_3e,_3f)){var _40=dj.byId("last_modified_date"),_41=misys.getLocalization("LastModifiedFromGreaterThanLastModifiedTo");_40.set("displayedValue","");_40.set("state","Error");dj.hideTooltip(_40.domNode);dj.showTooltip(_41,_40.domNode,0);return false;}var _42=new Date();_42.setHours(0,0,0,0);var _43=d.date.compare(m.localizeDate(_3e),_42)>0?false:true;if(!_43){_41=misys.getLocalization("LastModifiedDateGreaterThanCurrentDate");_3e.set("state","Error");dj.hideTooltip(_3e.domNode);dj.showTooltip(_41,_3e.domNode,0);return false;}return true;};function _44(){var _45=this;if(_45.get("value")===null){return true;}var _46=dj.byId("last_modified_date");if(!m.compareDateFields(_46,_45)){var _47=dj.byId("last_modified_date2");var _48=misys.getLocalization("LastModifiedToLesserThanLastModifiedFrom");_47.set("displayedValue","");_47.set("state","Error");dj.hideTooltip(_47.domNode);dj.showTooltip(_48,_47.domNode,0);}return true;};function _49(){if(dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""){dj.byId("sub_product_code").set("value","");}var _4a=dj.byId("parameter1").get("value"),_4b=new Array();_4b=_4a.split("Tnx");var _4c=dj.byId("sub_product_code"),_4d=m._config.SubProductsByProductsByCollection[_4b[0]];_4c.store=null;_4c.store=new dojo.data.ItemFileReadStore({data:{identifier:"ID",label:"name",items:_4d}});};function _4e(){if(dj.byId("migrate_all").get("value")==="Y"){if(d.byId("SubmitButtonDiv")){d.byId("SubmitButtonDiv").style.display="block";}}else{if(d.byId("SubmitButtonDiv")){d.byId("SubmitButtonDiv").style.display="none";}}};function _4f(){d.byId("batchContainer").style.display="none";};function _50(){if(dj.byId("status").get("value")==="Y"){if(dj.byId("company_name_display")){if(dj.byId("company_name_display").get("value")==="ALL"){dj.byId("status").set("disabled",true);}else{dj.byId("status").set("disabled",false);}}dj.byId("migrate_all").set("value","Y");d.byId("ref_id_row").style.display="none";d.byId("entity_row").style.display="none";d.byId("applicant_name_row").style.display="none";d.byId("bo_ref_id_row").style.display="none";d.byId("beneficiary_name_row").style.display="none";d.byId("cur_code_row").style.display="none";d.byId("exp_date_row").style.display="none";d.byId("submitButton_row").style.display="none";d.byId("batchContainer").style.display="none";}else{dj.byId("migrate_all").set("value","N");d.byId("ref_id_row").style.display="block";d.byId("entity_row").style.display="block";d.byId("applicant_name_row").style.display="block";d.byId("bo_ref_id_row").style.display="block";d.byId("beneficiary_name_row").style.display="block";d.byId("cur_code_row").style.display="block";d.byId("exp_date_row").style.display="block";d.byId("submitButton_row").style.display="block";d.byId("batchContainer").style.display="block";}};function _51(url,key,_52){key=encodeURI(key);_52=encodeURI(_52);var _53;if(url.indexOf("?")===-1){_53=url+"?"+key+"="+_52;}else{var _54=url.split("?")[0];var _55=url.split("?")[1].split("&");var i=_55.length;var x;while(i--){x=_55[i].split("=");if(x[0]==key){x[1]=_52;_55[i]=x.join("=");break;}}if(i<0){_55[_55.length]=[key,_52].join("=");}_53=_54+"?"+_55.join("&");}return _53;};function _56(_57){if(!_57){_57="TopForm";}var _58=document.forms[_57];var _59=_58.elements["select_all_box"].checked;for(var i=0;i<_58.length;i++){if((_58.elements[i].type=="checkbox")&&(_58.elements[i].name!="select_all_box")){_58.elements[i].checked=_59;}}};d.mixin(m,{bind:function(){m.setValidation("cur_code",m.validateCurrency);m.connect("submitButton","onClick",_4e);m.connect("status","onChange",_50);m.connect("submitButton","onClick",_4f);m.connect("maturity_date","onBlur",_31);m.connect("maturity_date2","onBlur",_37);if(dj.byId("company_name_display")){if(dj.byId("company_name_display").get("value")==="ALL"){dj.byId("status").set("disabled",true);}else{dj.byId("status").set("disabled",false);}}d.byId("ref_id_row").style.display="none";d.byId("entity_row").style.display="none";d.byId("applicant_name_row").style.display="none";d.byId("bo_ref_id_row").style.display="none";d.byId("beneficiary_name_row").style.display="none";d.byId("cur_code_row").style.display="none";d.byId("exp_date_row").style.display="none";d.byId("submitButton_row").style.display="none";},onFormLoad:function(){},setFSCMAmountValue:function(_5a){if(dj.byId(_5a+"visible")){var _5b=dj.byId(_5a+"visible").value;var _5c=isNaN(_5b)?0:_5b;dj.byId(_5a).set("value",_5b);var _5d=dj.byId(_5a+"2visible").value;dj.byId(_5a+"2").set("value",_5d);}}});d.mixin(m._config,{doReauthSubmit:function(_5e){var _5f={};if(d.isFunction(m._config.initReAuthParams)){_5f=m._config.initReAuthParams();m._config.reauthXhrParams=m._config.reauthXhrParams||{};m._config.reauthXhrParams=_5e;_5f.list_keys="";if(_5e.content){_5f.list_keys=_5e.content.list_keys?_5e.content.list_keys:"";}m._config.executeReauthentication(_5f);}},initReAuthParams:function(){var _60=m._config.getAmountAccountArray("tnx_amt;amt","Counterparty@counterparty_act_no",true),_61={productCode:"MB",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:m.trimAmount(m._config.getAmountSum(_60)),es_field2:m._config.getESIGNFeildForBulk(_60)};if(dj.byId("doReauthentication")){dj.byId("doReauthentication").set("disabled",false);}return _61;},reauthSubmit:function(){var _62=dj.byId("reauth_password").get("value");if(dj.byId("doReauthentication")){dj.byId("doReauthentication").set("disabled",true);}d.mixin(m._config.reauthXhrParams.content,{reauth_otp_response:misys.encryptText(_62)});m.xhrPost(m._config.reauthXhrParams);setTimeout(d.hitch(dijit.byId(m._config.getGridId()),"render"),10000);dj.byId("reauth_password").set("value","");dj.byId("reauth_dialog").hide();},nonReauthSubmit:function(){m.xhrPost(m._config.reauthXhrParams);setTimeout(d.hitch(dijit.byId(m._config.getGridId()),"render"),10000);}});d.mixin(m.grid,{confirmSubmitRecords:function(_63,url){if(misys.grid.client&&misys.grid.client.confirmSubmitRecords){misys.grid.client.confirmSubmitRecords(_63,url);}else{var _64=_63.selection.getSelected().length;var _65=_63.store._items.length;var _66=dj.byId("status").value;var _67=dj.byId("product_code").value;var _68=dj.byId("company_name").value;var _69=dj.byId("company_id").value;if(_69==="*"||_69==="0"){_68="ALL";}var _6a=dj.byId("company_name_display").get("value")+","+_67+","+_66+","+_69;if(_64>0&&_65>0){m.dialog.show("CONFIRMATION",m.getLocalization("submitMigrateAllTransactionsConfirmation",[_67,_68]),"",function(){m.grid.processRecords(_63,_51(url,"otherParams",_6a));});}else{if(dj.byId("migrate_all").get("value")==="Y"){dj.byId("dijit_form_Button_1").set("disabled",true);m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/RunMigrationTransaction"),handleAs:"json",sync:true,content:{"otherParams":_6a},load:function(_6b,_6c){var _6d=m.getLocalization("submitMigrattionSuccess",[_67,_68]);m.dialog.show("Alert",_6d);dj.byId("dijit_form_Button_1").set("disabled",false);},error:function(_6e,_6f){m.dialog.show("ERROR",m.getLocalization("submitMigrattionFailure"),[_67,_68]);dj.byId("dijit_form_Button_1").set("disabled",false);}});}else{m.dialog.show("ERROR",m.getLocalization("noTransactionsSelectedError"));}}}}});})(dojo,dijit,misys);dojo.require("misys.client.binding.common.listdef_mt_client");}