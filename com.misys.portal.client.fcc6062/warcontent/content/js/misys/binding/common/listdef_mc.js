/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.common.listdef_mc"]){dojo._hasResource["misys.binding.common.listdef_mc"]=true;dojo.provide("misys.binding.common.listdef_mc");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojo.data.ItemFileWriteStore");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.SortedFilteringSelect");dojo.require("misys.form.MultiSelect");dojo.require("dijit.layout.TabContainer");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.RadioButton");dojo.require("misys.binding.common.reauth_listdef_common");dojo.require("misys.binding.system.reauth");dojo.require("misys.binding.common.reauth_listdef");dojo.require("misys.common");dojo.require("misys.binding.loan.ln_tnxdropdown_validation_list");(function(d,dj,m){function _1(){if(dj.byId("account_no")){dj.byId("account_no").set("disabled",true);}};function _2(){if(dj.byId("account_no")){dj.byId("account_no").set("disabled",false);}};function _3(){if(d.byId("account_search_id")){d.style(d.byId("account_search_id"),"display","none");dj.byId("account_no").set("value","");}};function _4(){if(d.byId("account_search_id")){d.style(d.byId("account_search_id"),"display","");}};function _5(){if(dj.byId("cur_code").value!==""){dj.byId("AmountRangevisible").set("disabled",false);dj.byId("AmountRange2visible").set("disabled",false);}else{if(dj.byId("cur_code").value===""){dj.byId("AmountRangevisible").set("disabled",true);dj.byId("AmountRange2visible").set("disabled",true);dj.byId("AmountRangevisible").reset();dj.byId("AmountRange2visible").reset();}}};function _6(){if(d.byId("upload_file_id")){dj.byId("upload_file_id").set("disabled",true);}};function _7(){if(d.byId("upload_file_id")){dj.byId("upload_file_id").set("disabled",false);}};function _8(){if(dj.byId("account_no")){dj.byId("account_no").set("value","");}if(dj.byId("tnx_stat_code")){dj.byId("tnx_stat_code").set("value","");}if(dj.byId("cust_ref_id")){dj.byId("cust_ref_id").set("value","");}if(dj.byId("cur_code")){dj.byId("cur_code").set("value","");}if(dj.byId("AmountRangevisible")){dj.byId("AmountRangevisible").set("value","");}if(dj.byId("AmountRange2visible")){dj.byId("AmountRange2visible").set("value","");}if(dj.byId("counterparty_name")){dj.byId("counterparty_name").set("value","");}if(dj.byId("create_date")&&dj.byId("create_date").get("value")!==""){dj.byId("create_date").set("value","");dj.byId("create_date").set("displayedValue","");}if(dj.byId("create_date2")&&dj.byId("create_date2").get("value")!==""){dj.byId("create_date2").set("value","");dj.byId("create_date2").set("displayedValue","");}if(dj.byId("maturity_date")&&dj.byId("maturity_date").get("value")!==""){dj.byId("maturity_date").set("value","");dj.byId("maturity_date").set("displayedValue","");}if(dj.byId("maturity_date2")&&dj.byId("maturity_date2").get("value")!==""){dj.byId("maturity_date2").set("value","");dj.byId("maturity_date2").set("displayedValue","");}if(dj.byId("ref_id")){dj.byId("ref_id").set("value","*");}if(dj.byId("entity")){dj.byId("entity").set("value","");}};function _9(){var _a=this.get("value"),_b=this;m._config=m._config||{};m._config.effFromAmountValidationInprocess=false;var _c=dj.byId("AmountRange2visible").get("value");if(!m._config.effToAmountValidationInprocess){if(_a<0||_a>_c){m._config.effFromAmountValidationInprocess=true;var _d=dj.byId("AmountRangevisible");if(_a>_c){displayMessage=misys.getLocalization("invalidMinAmountValueError");}if(_a<0){displayMessage=misys.getLocalization("invalidAmountValueError");}_d.focus();_d.set("state","Error");dj.hideTooltip(_d.domNode);dj.showTooltip(displayMessage,_d.domNode,0);dj.showTooltip(displayMessage,domNode,0);return false;}}m._config.effFromAmountValidationInprocess=false;return true;};function _e(){var _f=this.get("value"),_10=this;m._config=m._config||{};m._config.effToAmountValidationInprocess=false;var _11=dj.byId("AmountRangevisible").get("value");if(!m._config.effFromAmountValidationInprocess){if(_f<0||_f<_11){m._config.effToAmountValidationInprocess=true;var _12=dj.byId("AmountRange2visible");if(_f<_11){displayMessage=misys.getLocalization("invalidMaxAmountValueError");}if(_f<0){displayMessage=misys.getLocalization("invalidAmountValueError");}_12.focus();_12.set("state","Error");dj.hideTooltip(_12.domNode);dj.showTooltip(displayMessage,_12.domNode,0);dj.showTooltip(displayMessage,domNode,0);return false;}}m._config.effToAmountValidationInprocess=false;return true;};function _13(_14,_15,_16,_17){if(_14.get("value")==null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _18;var _19=dj.byId(_15);var _1a=function(){dj.hideTooltip(_14.domNode);};if(!m._config.effToDateValidationInprocess){if(!m.compareDateFields(_14,_19)){m._config.effFromDateValidationInprocess=true;_18=misys.getLocalization(_16,[_17,_1b(_14),_1b(_19)]);_14.set("state","Error");dj.showTooltip(_18,_14.domNode,0);setTimeout(_1a,5000);return false;}}m._config.effFromDateValidationInprocess=false;return true;};function _1b(_1c){if(_1c.get("type")==="hidden"){return d.date.locale.format(m.localizeDate(_1c),{selector:"date"});}return _1c.get("displayedValue");};function _1d(_1e,_1f,_20,_21){var _22;m._config=m._config||{};m._config.effToDateValidationInprocess=false;var _23=dj.byId(_1f);var _24=function(){dj.hideTooltip(_1e.domNode);};if(!m._config.effFromDateValidationInprocess){if(!m.compareDateFields(_23,_1e)){m._config.effToDateValidationInprocess=true;_22=misys.getLocalization(_20,[_21,_1b(_1e),_1b(_23)]);_1e.set("state","Error");dj.showTooltip(_22,_1e.domNode,0);setTimeout(_24,5000);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _25(){var _26=this;if(_26.get("value")===null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _27=dj.byId("create_date2");if(!m._config.effToDateValidationInprocess){if(!m.compareDateFields(_26,_27)){m._config.effFromDateValidationInprocess=true;var _28=dj.byId("create_date");displayMessage=misys.getLocalization("LastModifiedDateFromLesserThanLastModifiedDateTo");_28.set("state","Error");dj.hideTooltip(_28.domNode);dj.showTooltip(displayMessage,_28.domNode,0);}}m._config.effFromDateValidationInprocess=false;return true;};function _29(){var _2a=this;m._config=m._config||{};m._config.effToDateValidationInprocess=false;if(_2a.get("value")===null){return true;}var _2b=dj.byId("create_date");if(!m._config.effFromDateValidationInprocess){m._config.effToDateValidationInprocess=true;if(!m.compareDateFields(_2b,_2a)){var _2c=dj.byId("create_date2");displayMessage=misys.getLocalization("LastModifiedDateToGreaterThanLastModifiedDateFrom");_2c.set("state","Error");dj.hideTooltip(_2c.domNode);dj.showTooltip(displayMessage,_2c.domNode,0);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _2d(){var _2e=this;if(_2e.get("value")===null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _2f=dj.byId("maturity_date2");if(!m._config.effToDateValidationInprocess){if(!m.compareDateFields(_2e,_2f)){m._config.effFromDateValidationInprocess=true;var _30=dj.byId("maturity_date"),_31=misys.getLocalization("maturityFromGreaterThanMaturityTo");var _32=function(){dj.hideTooltip(_30.domNode);};_30.set("state","Error");dj.showTooltip(_31,_30.domNode,0);setTimeout(_32,5000);return false;}}m._config.effFromDateValidationInprocess=false;return true;};function _33(){var _34=this;m._config=m._config||{};m._config.effToDateValidationInprocess=false;if(_34.get("value")===null){return true;}var _35=dj.byId("maturity_date");if(!m._config.effFromDateValidationInprocess){if(!m.compareDateFields(_35,_34)){m._config.effToDateValidationInprocess=true;var _36=dj.byId("maturity_date2");displayMessage=misys.getLocalization("maturityToLesserThanMaturityFrom");var _37=function(){dj.hideTooltip(_36.domNode);};_36.set("state","Error");dj.showTooltip(displayMessage,_36.domNode,0);setTimeout(_37,5000);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _38(){var _39=this;if(_39.get("value")===null){return true;}var _3a=dj.byId("last_modified_date2");if(!m.compareDateFields(_39,_3a)){var _3b=dj.byId("last_modified_date"),_3c=misys.getLocalization("LastModifiedFromGreaterThanLastModifiedTo");_3b.set("displayedValue","");_3b.set("state","Error");dj.hideTooltip(_3b.domNode);dj.showTooltip(_3c,_3b.domNode,0);return false;}var _3d=new Date();_3d.setHours(0,0,0,0);isValid=d.date.compare(m.localizeDate(_39),_3d)>0?false:true;if(!isValid){_3c=misys.getLocalization("LastModifiedDateGreaterThanCurrentDate");_39.set("state","Error");dj.hideTooltip(_39.domNode);dj.showTooltip(_3c,_39.domNode,0);return false;}return true;};function _3e(){var _3f=this;if(_3f.get("value")===null){return true;}var _40=dj.byId("last_modified_date");if(!m.compareDateFields(_40,_3f)){var _41=dj.byId("last_modified_date2");displayMessage=misys.getLocalization("LastModifiedToLesserThanLastModifiedFrom");_41.set("displayedValue","");_41.set("state","Error");dj.hideTooltip(_41.domNode);dj.showTooltip(displayMessage,_41.domNode,0);}return true;};function _42(){if(dj.byId("sub_product_code")&&dj.byId("sub_product_code").get("value")!==""){dj.byId("sub_product_code").set("value","");}var _43=dj.byId("parameter1").get("value"),_44=new Array();_44=_43.split("Tnx");var _45=dj.byId("sub_product_code"),_46=m._config.SubProductsByProductsByCollection[_44[0]];_45.store=null;_45.store=new dojo.data.ItemFileReadStore({data:{identifier:"ID",label:"name",items:_46}});};function _47(){if(dj.byId("AmountRangevisible")){var _48=dj.byId("AmountRangevisible").value;var _49=isNaN(_48)?0:_48;dj.byId("AmountRange").set("value",_48);var _4a=dj.byId("AmountRange2visible").value;dj.byId("AmountRange2").set("value",_4a);}};d.mixin(m,{bind:function(){m.setValidation("cur_code",m.validateCurrency);m.connect("AmountRangevisible","onBlur",_9);m.connect("AmountRange2visible","onBlur",_e);m.connect("maturity_date","onBlur",_2d);m.connect("maturity_date2","onBlur",_33);m.connect("last_modified_date","onBlur",_38);m.connect("last_modified_date2","onBlur",_3e);m.connect("entity","onChange",function(){var _4b=dj.byId("account_no");if(_4b){_4b.set("value","");}});m.connect("submitButton","onClick",function(){_47();});m.connect("parameter1","onChange",_42);m.connect("tnx_type_code_dropdown","onChange",m.validateLoanTransactionTypeDropDown);m.connect("create_date","onBlur",function(){var _4c=this;_13(_4c,"create_date2","generalFromDateGreaterThanToDate",misys.getLocalization("ApplicationDate"));});m.connect("create_date2","onBlur",function(){var _4d=this;_1d(_4d,"create_date","generalToDateGreaterThanFromDate",misys.getLocalization("ApplicationDate"));});m.connect("transfer_date","onBlur",function(){var _4e=this;_13(_4e,"transfer_date2","generalFromDateGreaterThanToDate",misys.getLocalization("TransferDate"));});m.connect("transfer_date2","onBlur",function(){var _4f=this;_1d(_4f,"transfer_date","generalToDateGreaterThanFromDate",misys.getLocalization("TransferDate"));});m.connect("upload_date","onBlur",function(){var _50=this;_13(_50,"upload_date2","generalFromDateGreaterThanToDate",misys.getLocalization("upload"));});m.connect("upload_date2","onBlur",function(){var _51=this;_1d(_51,"upload_date","generalToDateGreaterThanFromDate",misys.getLocalization("upload"));});},setFSCMAmountValue:function(_52){if(dj.byId(_52+"visible")){var _53=dj.byId(_52+"visible").value;var _54=isNaN(_53)?0:_53;dj.byId(_52).set("value",_53);var _55=dj.byId(_52+"2visible").value;dj.byId(_52+"2").set("value",_55);}}});d.mixin(m._config,{doReauthSubmit:function(_56){var _57={};if(d.isFunction(m._config.initReAuthParams)){_57=m._config.initReAuthParams();m._config.reauthXhrParams=m._config.reauthXhrParams||{};m._config.reauthXhrParams=_56;_57.list_keys="";if(_56.content){_57.list_keys=_56.content.list_keys?_56.content.list_keys:"";}m._config.executeReauthentication(_57);}},initReAuthParams:function(){var _58=m._config.getAmountAccountArray("tnx_amt;amt","Counterparty@counterparty_act_no",true),_59={productCode:"MB",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:m.trimAmount(m._config.getAmountSum(_58)),es_field2:m._config.getESIGNFeildForBulk(_58)};if(dj.byId("doReauthentication")){dj.byId("doReauthentication").set("disabled",false);}return _59;},reauthSubmit:function(){var _5a=dj.byId("reauth_password").get("value");if(dj.byId("doReauthentication")){dj.byId("doReauthentication").set("disabled",true);}d.mixin(m._config.reauthXhrParams.content,{reauth_otp_response:misys.encryptText(_5a)});m.xhrPost(m._config.reauthXhrParams);setTimeout(d.hitch(dijit.byId(m._config.getGridId()),"render"),10000);dj.byId("reauth_password").set("value","");dj.byId("reauth_dialog").hide();},nonReauthSubmit:function(){m.xhrPost(m._config.reauthXhrParams);setTimeout(d.hitch(dijit.byId(m._config.getGridId()),"render"),10000);}});d.mixin(m.grid,{confirmSubmitRecords:function(_5b,url){if(misys.grid.client&&misys.grid.client.confirmSubmitRecords){misys.grid.client.confirmSubmitRecords(_5b,url);}else{var _5c=_5b.selection.getSelected().length;var _5d=_5b.store._items.length;if(_5c>0&&_5d>0){m.dialog.show("CONFIRMATION",m.getLocalization("submitTransactionsConfirmation",[_5b.selection.getSelected().length]),"",function(){m.grid.processRecordsWithHolidayCutOffValidation(_5b,url);});}else{m.dialog.show("ERROR",m.getLocalization("noTransactionsSelectedError"));}}}});})(dojo,dijit,misys);dojo.require("misys.client.binding.common.listdef_mc_client");}