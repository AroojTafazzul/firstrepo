/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.core.merge_demerge_bk"]){dojo._hasResource["misys.binding.core.merge_demerge_bk"]=true;dojo.provide("misys.binding.core.merge_demerge_bk");(function(d,dj,m){d.subscribe("ready",function(){if(dj.byId("gridBulkTransactionForDemerge")){m.connect(dj.byId("gridBulkTransactionForDemerge").selection,"onSelected",function(_1){_2("gridBulkTransactionForDemerge");});}});function _3(_4){var _5=dj.byId(_4),_6="",_7=0,_8=dj.byId("list_keys"),_9,_a=_5.selection.getSelected();if(_a.length){d.forEach(_a,function(_b){_9=_5.store.getValues(_b,"ref_id");if(_7!==0){_6+=",";}_6+=_9;_7++;});}if(_8!=null){_8.set("value",_6);}};function _2(_c){var _d=dj.byId(_c),_e,_f,_10,_11,_12,_13=_d.selection.getSelected(),_14=function(){_16(_10,_11);};if(_13.length){d.forEach(_13,function(_15){_e=_d.store.getValues(_15,"ref_id");_f=_d.store.getValues(_15,"tnx_id");});}if(dj.byId("destination_bulk_ref_id")){dj.byId("destination_bulk_ref_id").set("value",_e);}if(dj.byId("destination_bulk_tnx_id")){dj.byId("destination_bulk_tnx_id").set("value",_f);}_10=dj.byId("ref_id").get("value");_11=dj.byId("tnx_id").get("value");_12=misys.getLocalization("confirmForDeMergeBulk",[dj.byId("merge_fts").get("value")]);if(_13.length>=1){m.dialog.show("CONFIRMATION",_12,"",_14);}};function _16(_17,_18){m.goToTransaction("existingForm",{tnxtype:"01",option:"DE-MERGE",mode:"DRAFT",operation:"SAVE",referenceid:_17,tnxid:_18});};function _19(_1a,_1b){m.goToTransaction("existingForm",{tnxtype:"01",option:"DE-MERGE",mode:"DRAFT",operation:"NEW",referenceid:_1a,tnxid:_1b});};d.mixin(m,{moveItems:function(_1c){var _1d=dj.byId(_1c),_1e=_1d.selection.getSelected(),_1f=dijit.byId("referenceid").get("value"),_20=dijit.byId("tnxid").get("value");if(_1e.length){_3(_1c);m.goToTransaction("existingForm",{tnxtype:"01",option:"DE-MERGE",mode:"DRAFT",referenceid:_1f,tnxid:_20});}else{m.dialog.show("CUSTOM-NO-CANCEL",m.getLocalization("selectAtleastOneTnxToMove"),"");}},onBeforeLoad:function(){m.excludedMethods.push({object:m,method:"moveItemsToNewBulk"},{object:m,method:"goToTransaction"});},moveItemsToNewBulk:function(_21){var _22=dj.byId(_21),_23,_24,_25,_26=function(){_19(_23,_24);};_23=dj.byId("ref_id").get("value");_24=dj.byId("tnx_id").get("value");_25=misys.getLocalization("confirmForDeMergeBulkForNewBulk",[dj.byId("merge_fts").get("value")]);m.dialog.show("CONFIRMATION",_25,"",_26);},goToTransaction:function(_27,_28){var _29=dj.byId(_27);var _2a=d.byId(_27);for(var x in _28){if(!_2a[x]){d.create("input",{type:"hidden",name:x,value:_28[x]},_2a);}else{_2a[x].value=_28[x];}}if(dj.byId("token")){d.create("input",{type:"hidden",name:"token",value:dj.byId("token").get("value")},_2a);}_29.connectChildren();_29.set("action",misys.getServletURL("/screen/BulkScreen"));_29.startup();_29.submit();}});})(dojo,dijit,misys);dojo.require("misys.client.binding.core.merge_demerge_bk_client");}