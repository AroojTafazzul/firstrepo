/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.trade.message_transfer_sr"]){dojo._hasResource["misys.binding.trade.message_transfer_sr"]=true;dojo.provide("misys.binding.trade.message_transfer_sr");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.form.file");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.binding.trade.ls_common");(function(d,dj,m){var _1="deletegridrecord";d.mixin(m._config,{initReAuthParams:function(){var _2={productCode:"SR",subProductCode:"",transactionTypeCode:"13",entity:"",currency:"",amount:"",es_field1:"",es_field2:""};return _2;}});d.mixin(m,{bind:function(){m.setValidation("free_format_text",m.validateFreeFormatMessage);m.connect("full_trf_flag","onClick",function(){var _3=dj.byId("tnx_amt");if(this.get("checked")){m.setTnxAmt(dj.byId("org_lc_amt").get("value"));_3.set("readOnly",true);}else{_3.reset();_3.set("readOnly",false);}});m.connect("advise_mode_code_1","onClick",function(){m.toggleFields(!this.get("checked"),["advise_thru_bank_name","advise_thru_bank_address_line_1","advise_thru_bank_address_line_2","advise_thru_bank_dom"],null);});m.connect("advise_mode_code_2","onClick",function(){m.toggleFields(this.get("checked"),["advise_thru_bank_name","advise_thru_bank_address_line_1","advise_thru_bank_address_line_2","advise_thru_bank_dom"],null);});m.connect("tnx_amt","onFocus",function(){this.set("readOnly",dj.byId("full_trf_flag").get("checked"));});m.connect("advise_mode_code","onChange",function(){m.toggleFields(this.get("value")==="02",["advise_thru_bank_name","advise_thru_bank_address_line_1","advise_thru_bank_address_line_2","advise_thru_bank_dom"],["advise_thru_bank_name","advise_thru_bank_address_line_1"]);if(this.get("value")=="02"){m.animate("wipeIn",d.byId("advise_thru_bank_name_img"));}else{m.animate("wipeOut",d.byId("advise_thru_bank_name_img"));}});m.connect("delv_org","onChange",function(){m.toggleFields((this.get("value")==="99"),null,["delv_org_text"]);});m.connect("license_lookup","onClick",function(){m.getLicenses("el");});m.connect("applicable_rules","onChange",function(){m.toggleFields((this.get("value")=="99"),null,["applicable_rules_text"]);});m.connect("delivery_to","onChange",function(){if(this.get("value")===""||this.get("value")==="01"||this.get("value")==="03"){m.toggleFields((this.get("value")===""||this.get("value")==="01"||this.get("value")==="03"),null,["narrative_delivery_to"]);m.toggleRequired("narrative_delivery_to",false);dj.byId("narrative_delivery_to").set("value","");dj.byId("narrative_delivery_to").set("disabled",true);document.getElementById("narrative_delivery_to_img").style.display="none";}else{dj.byId("narrative_delivery_to").set("disabled",false);dj.byId("narrative_delivery_to").set("value","");m.toggleRequired("narrative_delivery_to",true);document.getElementById("narrative_delivery_to_img").style.display="block";}});m.connect("tnx_amt","onChange",function(){var _4=dj.byId("tnx_amt")?dj.byId("tnx_amt").get("value"):"";var _5=dj.byId("utilized_amt")?dj.byId("utilized_amt").get("value"):"";var _6=dj.byId("utilized_amt_cur_code")?dj.byId("utilized_amt_cur_code").get("value"):"";var _7=dj.byId("org_lc_amt")?dj.byId("org_lc_amt").get("value"):"";var _8=0;if(_4!==""){_8=(_7-_5);if(_4>_8){_8=_8<0?dojo.currency.format(0):dojo.currency.format(_8);var _9=m.getLocalization("transferAmtGreaterThanAvailableLCAmtWarning",[_6,_8]);dj.byId("tnx_amt").focus();dj.byId("tnx_amt").set("state","Error");dj.showTooltip(_9,dj.byId("tnx_amt").domNode,0);}}});m.connect("sec_beneficiary_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("sec_beneficiary_address_line_4").get("displayedValue"),dj.byId("sec_beneficiary_address_line_4").get("value")]),d.byId("sec_beneficiary_address_line_4"),["right"],5000);});m.connect("assignee_address_line_4","onFocus",function(){m.showTooltip(m.getLocalization("addressLine4ToolTip",[dj.byId("assignee_address_line_4").get("displayedValue"),dj.byId("assignee_address_line_4").get("value")]),d.byId("assignee_address_line_4"),["right"],5000);});},onFormLoad:function(){var _a=dj.byId("advising_bank_abbv_name").get("value");var _b=m._config.customerBanksMT798Channel[_a]===true;m.setCurrency(dj.byId("lc_cur_code"),["tnx_amt","org_lc_amt"]);if(_b){if(dj.byId("delivery_channel").get("value")===""){m.animate("fadeIn",d.byId("bankInst"));dj.byId("delivery_channel").set("disabled",true);}else{m.animate("fadeIn",d.byId("bankInst"));}if(dj.byId("delivery_channel")){m.animate("fadeIn","delivery_channel_row");m.connect("delivery_channel","onChange",function(){if(dj.byId("attachment-file")){if(dj.byId("delivery_channel").get("value")==="FACT"){dj.byId("attachment-file").displayFileAct(true);}else{dj.byId("attachment-file").displayFileAct(false);}}});dj.byId("delivery_channel").onChange();}}else{m.animate("fadeOut",d.byId("bankInst"));}var _c=dojo.subscribe(_1,function(){m.toggleFields(m._config.customerBanksMT798Channel[dj.byId("advising_bank_abbv_name")]===true&&m.hasAttachments(),null,["delivery_channel"],false,false);});if(dj.byId("advise_mode_code")){m.toggleFields(dj.byId("advise_mode_code").get("value")==="02",["advise_thru_bank_name","advise_thru_bank_address_line_1","advise_thru_bank_address_line_2","advise_thru_bank_dom"],["advise_thru_bank_name","advise_thru_bank_address_line_1"]);if(dj.byId("advise_mode_code").get("value")=="02"){m.animate("wipeIn",d.byId("advise_thru_bank_name_img"));}else{m.animate("wipeOut",d.byId("advise_thru_bank_name_img"));}}if(dj.byId("sec_beneficiary_country")){dj.byId("sec_beneficiary_country").set("required",false);}m.animate("wipeOut",d.byId("sec_beneficiary_country_row"));if(dj.byId("delivery_to")&&dj.byId("narrative_delivery_to")){if(dj.byId("delivery_to").get("value")===""||dj.byId("delivery_to").get("value")==="01"||dj.byId("delivery_to").get("value")==="03"){m.toggleFields((dj.byId("delivery_to").get("value")===""||dj.byId("delivery_to").get("value")==="01"||dj.byId("delivery_to").get("value")==="03"),null,["narrative_delivery_to"]);m.toggleRequired("narrative_delivery_to",false);dj.byId("narrative_delivery_to").set("value","");dj.byId("narrative_delivery_to").set("disabled",true);document.getElementById("narrative_delivery_to_img").style.display="none";}else{if(dj.byId("delivery_to").get("value")!==""){dj.byId("narrative_delivery_to").set("disabled",false);m.toggleRequired("narrative_delivery_to",true);document.getElementById("narrative_delivery_to_img").style.display="block";}}}if(dj.byId("full_trf_flag")){var _d=dj.byId("tnx_amt");if(dj.byId("full_trf_flag").get("checked")){m.setTnxAmt(dj.byId("org_lc_amt").get("value"));_d.set("readOnly",true);}else{_d.reset();_d.set("readOnly",false);}}var _e=dj.byId("applicable_rules");if(_e){m.toggleFields(_e.get("value")=="99",null,["applicable_rules_text"]);}},beforeSaveValidations:function(){var _f=dj.byId("tnx_amt")?dj.byId("tnx_amt").get("value"):"";if(isNaN(_f)||(_f===0)){m._config.onSubmitErrorMsg=m.getLocalization("transferAmountEmptyZero");dj.byId("tnx_amt").set("value","");return false;}if(_f!==""){var _10=dj.byId("org_lc_amt").get("value");if(_10<_f){m._config.onSubmitErrorMsg=m.getLocalization("transferAmtGreaterThanLCAmtError");dj.byId("tnx_amt").focus();return false;}}var _11=dj.byId("utilized_amt")?dj.byId("utilized_amt").get("value"):"";var _12=dj.byId("utilized_amt_cur_code")?dj.byId("utilized_amt_cur_code").get("value"):"";var _13=dj.byId("org_lc_amt")?dj.byId("org_lc_amt").get("value"):"";var _14=0;if(_f!==""){_14=(_13-_11);if(_f>_14){_14=_14<0?dojo.currency.format(0):dojo.currency.format(_14);m._config.onSubmitErrorMsg=m.getLocalization("transferAmtGreaterThanAvailableLCAmtWarning",[_12,_14]);dj.byId("tnx_amt").focus();return false;}}if(m._config.swift2018Enabled){if(dj.byId("narrative_period_presentation_nosend")&&dj.byId("narrative_period_presentation_nosend").get("value")!==""){var _15=dj.byId("narrative_period_presentation_nosend").get("value");if(_15.indexOf("\n")!=-1){m._config.onSubmitErrorMsg=m.getLocalization("periodOfPresentaionError");return false;}}}return true;},beforeSubmitValidations:function(){var _16=dj.byId("tnx_amt")?dj.byId("tnx_amt").get("value"):"";if(isNaN(_16)||(_16===0)){m._config.onSubmitErrorMsg=m.getLocalization("transferAmountEmptyZero");dj.byId("tnx_amt").set("value","");return false;}if(_16!==""){var _17=dj.byId("org_lc_amt").get("value");if(_17<_16){dj.byId("tnx_amt").reset();m._config.onSubmitErrorMsg=m.getLocalization("transferAmtGreaterThanLCAmtError");return false;}}var _18=dj.byId("utilized_amt")?dj.byId("utilized_amt").get("value"):"";var _19=dj.byId("utilized_amt_cur_code")?dj.byId("utilized_amt_cur_code").get("value"):"";var _1a=dj.byId("org_lc_amt")?dj.byId("org_lc_amt").get("value"):"";var _1b=0;if(_16!==""){_1b=(_1a-_18);if(_16>_1b){_1b=_1b<0?dojo.currency.format(0):dojo.currency.format(_1b);m._config.onSubmitErrorMsg=m.getLocalization("transferAmtGreaterThanAvailableLCAmtWarning",[_19,_1b]);dj.byId("tnx_amt").focus();return false;}}if(m._config.swift2018Enabled){if(dj.byId("narrative_period_presentation_nosend")&&dj.byId("narrative_period_presentation_nosend").get("value")!==""){var _1c=dj.byId("narrative_period_presentation_nosend").get("value");if(_1c.indexOf("\n")!=-1){m._config.onSubmitErrorMsg=m.getLocalization("periodOfPresentaionError");return false;}}}return true;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.trade.message_transfer_sr_client");}