/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.trade.create_ec"]){dojo._hasResource["misys.binding.trade.create_ec"]=true;dojo.provide("misys.binding.trade.create_ec");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.form.file");dojo.require("misys.form.addons");dojo.require("misys.validation.common");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.common");dojo.require("misys.widget.NoCloseDialog");dojo.require("misys.binding.trade.ls_common");(function(d,dj,m){var _1="label[for=tenor_period_label]";m._config=m._config||{};m._config.ecCurCode=m._config.ecCurCode||{};m._config.drawer=m._config.drawer||{entity:"",name:"",addressLine1:"",addressLine2:"",dom:""};m._config.drawee=m._config.drawee||{name:"",addressLine1:"",addressLine2:"",dom:""};function _2(){dj.byId("drawer_reference").set("value",this.get("value"));};function _3(){dj.byId("principal_act_no").set("value","");dj.byId("fee_act_no").set("value","");};function _4(_5){var _6=null;var _7;if(dj.byId(_5)){var _8=dj.byId(_5).get("value");if((_8.indexOf("<")!=-1)||(_8.indexOf(">")!=-1)){_6=m.getLocalization("invalidContent");dj.byId(_5).set("state","Error");dj.hideTooltip(dj.byId(_5).domNode);dj.showTooltip(_6,dj.byId(_5).domNode,0);var _9=function(){dj.hideTooltip(dj.byId(_5).domNode);};setTimeout(_9,1500);return false;}if(dj.byId(_5).get("required")&&dj.byId(_5).id!=="documents_details_second_mail_send"){if(_8<=0&&_5!=="documents_details_second_mail_send"){if((d.number.parse(dj.byId(_5).get("value"))>0||d.number.parse(dj.byId("documents_details_second_mail_send").get("value"))>0)&&dj.byId("documents_details_code_nosend").get("value")!=="01"){dj.byId(_5).set("state","");dj.hideTooltip(dj.byId(_5).domNode);dj.byId("documents_details_second_mail_send").set("state","");dj.hideTooltip(dj.byId("documents_details_second_mail_send").domNode);return true;}else{if(d.number.parse(dj.byId(_5).get("value"))<=0){_6=m.getLocalization("valueShouldBeGreaterThanZero");dj.byId(_5).set("state","Error");dj.hideTooltip(dj.byId(_5).domNode);dj.showTooltip(_6,dj.byId(_5).domNode,0);_7=function(){dj.hideTooltip(dj.byId(_5).domNode);};setTimeout(_7,1500);return false;}}}}if(dj.byId(_5).get("required")&&dj.byId(_5).id!=="documents_details_first_mail_send"){if((d.number.parse(dj.byId(_5).get("value"))>0||d.number.parse(dj.byId("documents_details_first_mail_send").get("value"))>0)&&dj.byId("documents_details_code_nosend").get("value")!=="01"){dj.byId(_5).set("state","");dj.hideTooltip(dj.byId(_5).domNode);dj.byId("documents_details_first_mail_send").set("state","");dj.hideTooltip(dj.byId("documents_details_first_mail_send").domNode);return true;}else{if(dj.byId("documents_details_code_nosend").get("value")!=="01"){_6=m.getLocalization("valueShouldBeGreaterThanZero");dj.byId(_5).set("state","Error");dj.hideTooltip(dj.byId(_5).domNode);dj.showTooltip(_6,dj.byId(_5).domNode,0);_7=function(){dj.hideTooltip(dj.byId(_5).domNode);};setTimeout(_7,1500);return false;}else{if(d.number.parse(dj.byId("documents_details_first_mail_send").get("value"))<=0){_6=m.getLocalization("valueShouldBeGreaterThanZero");dj.byId("documents_details_first_mail_send").set("state","Error");dj.hideTooltip(dj.byId("documents_details_first_mail_send").domNode);dj.showTooltip(_6,dj.byId("documents_details_first_mail_send").domNode,0);_7=function(){dj.hideTooltip(dj.byId("documents_details_first_mail_send").domNode);};setTimeout(_7,1500);return false;}}}}}};function _a(){var _b=dijit.byId("attachment-file");var _c=true;var _d=[];var _e=[];var _f=[];if(_b&&_b.store&&_b.store._arrayOfAllItems&&_b.store._arrayOfAllItems.length){d.forEach(_b.store._arrayOfAllItems,function(_10,_11){if(_10&&_10.attachment_id&&_10.file_name){_e.push(_10.attachment_id.toString());_f.push(_10.file_name.toString());}});}d.query("*[id^='documents_details_mapped_attachment_id_']").forEach(function(_12,_13){var _14=dijit.byId("documents_details_mapped_attachment_id_"+_13);var _15=_14?_14.get("value"):"";var _16=dijit.byId("documents_details_mapped_attachment_name_"+_13);var _17=_16?_16.get("value"):"";var _18=(_e&&_15!==""&&_e.indexOf(_15)==-1&&_f&&_17!==""&&_f.indexOf(_17)==-1);var _19=dojo.byId("document_row_"+_13);if(_14&&_16&&_18){_14.set("value","");_16.set("value","");_19.cells[6].innerHTML="";_c=false;}});if(!_c){m._config.onSubmitErrorMsg=m.getLocalization("incorrectDocumentMappingError");}return _c;};function _1a(_1b){if(_1c(_1b)){var _1d=dj.byId("documents_details_total_send");var _1e=d.number.parse(dj.byId("documents_details_first_mail_send").get("value"));var _1f=d.number.parse(dj.byId("documents_details_second_mail_send").get("value"));_1e=!isNaN(_1e)?_1e:0;_1f=!isNaN(_1f)?_1f:0;_1d.set("value",_1e+_1f);_1d.set("readOnly",true);return true;}};function _1c(_20){if(dj.byId(_20)){var _21=dj.byId(_20).get("value");var _22=new RegExp("^[0-9]+$");if(_21!=""&&!_22.test(_21)){var _23=m.getLocalization("invalidContent");dj.byId(_20).set("state","Error");dj.hideTooltip(dj.byId(_20).domNode);dj.showTooltip(_23,dj.byId(_20).domNode,0);var _24=function(){dj.hideTooltip(dj.byId(_20).domNode);};setTimeout(_24,1500);return false;}return true;}};function _25(){if(misys._config.isDocumentMandatory){var _26=false;var _27=d.query("#document-master-table > tbody > tr").length;if(_27==0){return _26;}for(var i=0;i<_27;i++){if(dojo.query("#document-master-table > tbody > tr")[i].id){_26=true;return _26;}}return _26;}return true;};d.mixin(m._config,{initReAuthParams:function(){var _28={productCode:"EC",subProductCode:"",transactionTypeCode:"01",entity:dj.byId("entity")?dj.byId("entity").get("value"):"",currency:dj.byId("ec_cur_code")?dj.byId("ec_cur_code").get("value"):"",amount:dj.byId("ec_amt")?m.trimAmount(dj.byId("ec_amt").get("value")):"",es_field1:dj.byId("ec_amt")?m.trimAmount(dj.byId("ec_amt").get("value")):"",es_field2:""};return _28;},xmlTransform:function(xml){var _29="<ec_tnx_record>";if(xml.indexOf(_29)!=-1){var _2a=m._config.xmlTagName,_2b=_2a?["<",_2a,">"]:[],_2c="</ec_tnx_record>",_2d="",_2e=-1;_2d=xml.substring(_29.length,(xml.length-_2c.length));_2b.push(_2d);if(dj.byId("gridLicense")&&dj.byId("gridLicense").store&&dj.byId("gridLicense").store!==null&&dj.byId("gridLicense").store._arrayOfAllItems.length>0){_2b.push("<linked_licenses>");dj.byId("gridLicense").store.fetch({query:{REFERENCEID:"*"},onComplete:dojo.hitch(dj.byId("gridLicense"),function(_2f,_30){dojo.forEach(_2f,function(_31){_2b.push("<license>");_2b.push("<ls_ref_id>",_31.REFERENCEID,"</ls_ref_id>");_2b.push("<bo_ref_id>",_31.BO_REF_ID,"</bo_ref_id>");_2b.push("<ls_number>",_31.LS_NUMBER,"</ls_number>");_2b.push("<ls_allocated_amt>",_31.LS_ALLOCATED_AMT,"</ls_allocated_amt>");_2b.push("<ls_amt>",_31.LS_AMT,"</ls_amt>");_2b.push("<ls_os_amt>",_31.LS_OS_AMT,"</ls_os_amt>");_2b.push("<converted_os_amt>",_31.CONVERTED_OS_AMT,"</converted_os_amt>");_2b.push("<allow_overdraw>",_31.ALLOW_OVERDRAW,"</allow_overdraw>");_2b.push("</license>");});})});_2b.push("</linked_licenses>");}if(_2a){_2b.push("</",_2a,">");}return _2b.join("");}else{return xml;}}});d.mixin(m,{bind:function(){m.setValidation("template_id",m.validateTemplateId);m.setValidation("ec_cur_code",m.validateCurrency);m.setValidation("drawee_country",m.validateCountry);m.setValidation("presenting_bank_phone",m.validatePhoneOrFax);if(dj.byId("tenor_base_date")){m.setValidation("tenor_base_date",m.validateBaseDateWithCurrentSystemDate);}if(dj.byId("tenor_maturity_date")){m.setValidation("tenor_maturity_date",m.validateMaturityDateWithSystemDate);}m.connect("remitting_bank_abbv_name","onChange",m.populateReferences);m.connect("remitting_bank_abbv_name","onChange",m.updateBusinessDate);if(dj.byId("remitting_bank_abbv_name")){m.connect("entity","onChange",function(){dj.byId("remitting_bank_abbv_name").onChange();});}m.connect("remitting_bank_customer_reference","onChange",_2);m.connect("corr_chrg_brn_by_code_1","onClick",function(){dj.byId("waive_chrg_flag").set("checked",true);dj.byId("waive_chrg_flag").set("disabled",true);});m.connect("corr_chrg_brn_by_code_2","onClick",function(){dj.byId("waive_chrg_flag").set("disabled",false);dj.byId("waive_chrg_flag").set("checked",false);});m.connect("term_code","onChange",function(){if(this.get("value")!="01"){dj.byId("accpt_adv_send_mode").set("disabled",false);}else{if(this.get("value")==="01"){dj.byId("accpt_adv_send_mode").set("value","");dj.byId("accpt_adv_send_mode").set("disabled",true);}}if(dj.byId("protest_non_accpt").get("checked",true)){dj.byId("protest_non_accpt").set("checked",false);}if(dj.byId("accpt_defd_flag").get("checked",true)){dj.byId("accpt_defd_flag").set("checked",false);}if(dj.byId("boe_flag")){if(this.get("value")!=="01"){m.animate("fadeIn",d.byId("boe"));}else{m.animate("fadeOut",d.byId("boe"));dj.byId("boe_flag").set("checked",false);}}if(this.get("value")==="01"){m.toggleFields(true,null,["tenor_type_1"],false);dj.byId("tenor_type_1").set("checked",true);dj.byId("tenor_type_2").set("disabled",true);dj.byId("tenor_type_2").set("checked",false);dj.byId("tenor_type_3").set("disabled",true);dj.byId("tenor_type_3").set("checked",false);dj.byId("tenor_desc").set("disabled",true);dj.byId("tenor_desc").set("value","");m.toggleRequired("tenor_desc",false);m.toggleAllTenorFields();dj.byId("tenor_maturity_date").set("disabled",true);dj.byId("tenor_maturity_date").set("readOnly",true);}else{if(this.get("value")==="02"){dj.byId("tenor_type_2").set("disabled",false);dj.byId("tenor_type_2").set("checked",true);dj.byId("tenor_type_3").set("disabled",true);dj.byId("tenor_type_3").set("checked",false);dj.byId("tenor_type_1").set("disabled",true);dj.byId("tenor_type_1").set("checked",false);dj.byId("tenor_desc").set("disabled",true);dj.byId("tenor_desc").set("value","");m.toggleRequired("tenor_desc",false);m.toggleAllTenorFields();dj.byId("tenor_maturity_date").set("disabled",false);dj.byId("tenor_maturity_date").set("readOnly",false);}else{if(this.get("value")==="04"){dj.byId("tenor_type_2").set("disabled",true);dj.byId("tenor_type_2").set("checked",false);dj.byId("tenor_type_3").set("disabled",false);dj.byId("tenor_type_3").set("checked",true);dj.byId("tenor_type_1").set("disabled",true);dj.byId("tenor_type_1").set("checked",false);dj.byId("tenor_desc").set("disabled",true);dj.byId("tenor_desc").set("value","");m.toggleRequired("tenor_desc",false);m.toggleAllTenorFields();dj.byId("tenor_maturity_date").set("disabled",false);dj.byId("tenor_maturity_date").set("readOnly",false);}else{if(this.get("value")==="03"){dj.byId("tenor_type_1").set("disabled",false);dj.byId("tenor_type_2").set("disabled",false);dj.byId("tenor_type_3").set("disabled",false);dj.byId("tenor_type_1").set("checked",true);dj.byId("tenor_type_2").set("checked",false);dj.byId("tenor_desc").set("disabled",false);m.toggleRequired("tenor_desc",true);m.toggleAllTenorFields();dj.byId("tenor_maturity_date").set("disabled",true);dj.byId("tenor_maturity_date").set("readOnly",true);if(dj.byId("tenor_type_1").get("checked")&&dj.byId("boe_flag")){m.animate("fadeOut",d.byId("boe"));dj.byId("boe_flag").set("checked",false);}else{m.animate("fadeIn",d.byId("boe"));}}}}}});m.connect("tenor_maturity_date","onBlur",function(){var _32=dj.byId("term_code")?dj.byId("term_code").get("value"):"";if((_32==="02"||_32==="04"||_32==="03")&&dj.byId("tenor_maturity_date")){if(dj.byId("tenor_maturity_date").get("value")){dj.byId("tenor_days").set("value","");dj.byId("tenor_desc").set("value","");dj.byId("tenor_period").set("value","");dj.byId("tenor_from_after").set("value","");dj.byId("tenor_days_type").set("value","");dj.byId("tenor_base_date").set("displayedValue","");dj.byId("tenor_days").set("disabled",true);dj.byId("tenor_period").set("disabled",true);dj.byId("tenor_from_after").set("disabled",true);dj.byId("tenor_days_type").set("disabled",true);m.toggleRequired("tenor_days_type",false);dj.byId("tenor_type_details").set("disabled",true);dj.byId("tenor_base_date").set("disabled",true);m.toggleRequired("tenor_base_date",false);m.toggleRequired(dojo.query(_1)[0].innerHTML=m.getLocalization("tenorPeriod"),false);}else{if(!dj.byId("tenor_maturity_date").get("value")){dj.byId("tenor_days").set("disabled",false);dj.byId("tenor_period").set("disabled",false);dj.byId("tenor_from_after").set("disabled",false);dj.byId("tenor_days_type").set("disabled",false);m.toggleRequired("tenor_days_type",true);dj.byId("tenor_type_details").set("disabled",false);dj.byId("tenor_base_date").set("disabled",false);m.toggleAllTenorFields();}}}});m.connect("tenor_days","onBlur",function(){var _33=dj.byId("term_code")?dj.byId("term_code").get("value"):"";if((_33==="02"||_33==="04"||_33==="03")&&dj.byId("tenor_days")){if(dj.byId("tenor_days").get("value")){dj.byId("tenor_maturity_date").set("displayedValue","");dj.byId("tenor_maturity_date").set("disabled",true);}else{if(!dj.byId("tenor_days").get("value")){dj.byId("tenor_maturity_date").set("disabled",false);m.toggleAllTenorFields();}}}});m.connect("tenor_days_type","onChange",function(){m.toggleFields((this.get("value")==="O"),null,["tenor_type_details"]);var _34=dj.byId("term_code")?dj.byId("term_code").get("value"):"";if(_34){if(_34==="04"){if((this.get("value")==="O")||(this.get("value")==="G")||(this.get("value")==="S")){dj.byId("tenor_base_date").set("disabled",true);}else{dj.byId("tenor_base_date").set("disabled",false);}}}else{dj.byId("tenor_desc").set("disabled",true);dj.byId("tenor_type_1").set("disabled",true);dj.byId("tenor_type_2").set("disabled",true);dj.byId("tenor_type_3").set("disabled",true);dj.byId("tenor_days").set("disabled",true);dj.byId("tenor_period").set("disabled",true);dj.byId("tenor_from_after").set("disabled",true);dj.byId("tenor_days_type").set("disabled",true);dj.byId("tenor_type_details").set("disabled",true);dj.byId("tenor_base_date").set("disabled",true);}});m.connect("protest_non_accpt","onClick",m.disableNonAcceptanceFields);m.connect("accpt_defd_flag","onClick",m.disableNonAcceptanceFields);m.connect("tenor_type_1","onClick",m.toggleAllTenorFields);m.connect("tenor_type_2","onClick",m.toggleAllTenorFields);m.connect("tenor_type_3","onClick",m.toggleAllTenorFields);m.connect("ec_cur_code","onChange",function(){m.setCurrency(this,["ec_amt"]);});m.connect("ec_amt","onBlur",function(){m.setTnxAmt(this.get("value"));});m.connect("presenting_bank_name","onChange",function(){m.toggleFields(dj.byId("presenting_bank_name").get("value")&&dj.byId("presenting_bank_address_line_1").get("value"),["presenting_bank_contact_name","presenting_bank_phone"],null);return false;});m.connect("presenting_bank_address_line_1","onChange",function(){m.toggleFields(dj.byId("presenting_bank_name").get("value")&&dj.byId("presenting_bank_address_line_1").get("value"),["presenting_bank_contact_name","presenting_bank_phone"],null);return false;});m.connect("remitting_bank_abbv_name","onChange",function(){if(dj.byId("remitting_bank_abbv_name").get("value")!=""){m.getIncoYear();}});m.connect("inco_term_year","onChange",m.getIncoTerm);m.connect("inco_term_year","onChange",function(){m.toggleFields(this.get("value"),null,["inco_term"],false,true);});m.connect("inco_term_year","onClick",function(){if(dj.byId("remitting_bank_abbv_name").get("value")==""&&(this.store._arrayOfAllItems==undefined||this.store._arrayOfAllItems.length==0)){m.dialog.show("ERROR",m.getLocalization("selectBankToProceed"),"","");}});m.connect("inco_term","onClick",function(){if(dj.byId("remitting_bank_abbv_name").get("value")==""&&(this.store._arrayOfAllItems==undefined||this.store._arrayOfAllItems.length==0)){m.dialog.show("ERROR",m.getLocalization("selectBankToProceed"),"","");}else{if(dj.byId("inco_term_year").get("value")==""&&(this.store._arrayOfAllItems==undefined||this.store._arrayOfAllItems.length==0)){m.dialog.show("ERROR",m.getLocalization("selectIncoYearToProceed"),"","");}}});m.connect("inco_term","onChange",function(){m.toggleFields(this.get("value"),null,["inco_place"],false,false);});m.connect("entity_img_label","onClick",_3);m.connect("license_lookup","onClick",function(){m.getLicenses("ec");});m.connect("ec_cur_code","onChange",function(){m.clearLicenseGrid(this,m._config.ecCurCode,"ec");});m.connect("entity","onChange",function(){m.clearLicenseGrid(this,m._config.drawer,"ec");});m.connect("drawee_name","onChange",function(){m.clearLicenseGrid(this,m._config.drawee,"ec");});m.connect("documents_details_second_mail_send","onBlur",function(){_4("documents_details_second_mail_send");});m.connect("documents_details_first_mail_send","onBlur",function(){_4("documents_details_first_mail_send");});m.connect("documents_details_total_send","onBlur",function(){_4("documents_details_total_send");});m.connect("documents_details_name_nosend","onBlur",function(){_4("documents_details_name_nosend");});m.connect("documents_details_doc_no_send","onBlur",function(){_4("documents_details_doc_no_send");});m.connect("documents_details_first_mail_send","onBlur",function(){_1a("documents_details_first_mail_send");});m.connect("documents_details_second_mail_send","onBlur",function(){_1a("documents_details_second_mail_send");});m.connect("documents_details_code_nosend","onChange",function(){if(dj.byId("documents_details_code_nosend").get("value")==="01"&&d.number.parse(dj.byId("documents_details_first_mail_send").get("value"))<=0){var _35=null;_35=m.getLocalization("valueShouldBeGreaterThanZero");dj.byId("documents_details_first_mail_send").set("state","Error");dj.hideTooltip(dj.byId("documents_details_first_mail_send").domNode);dj.showTooltip(_35,dj.byId("documents_details_first_mail_send").domNode,0);var _36=function(){dj.hideTooltip(dj.byId("documents_details_first_mail_send").domNode);};setTimeout(_36,1500);return false;}else{dj.byId("documents_details_first_mail_send").set("state","");dj.hideTooltip(dj.byId("documents_details_first_mail_send").domNode);return true;}});},onFormLoad:function(){m._config.ecCurCode=dj.byId("ec_cur_code").get("value");m._config.isBank=false;m._config.drawee.name=dj.byId("drawee_name").get("value");m._config.drawee.addressLine1=dj.byId("drawee_address_line_1").get("value");m._config.drawee.addressLine2=dj.byId("drawee_address_line_2").get("value");m._config.drawee.dom=dj.byId("drawee_dom").get("value");m._config.drawer.entity=dj.byId("entity")?dj.byId("entity").get("value"):"";m._config.drawer.name=dj.byId("drawer_name").get("value");m._config.drawer.addressLine1=dj.byId("drawer_address_line_1").get("value");m._config.drawer.addressLine2=dj.byId("drawer_address_line_2").get("value");m._config.drawer.dom=dj.byId("drawer_dom").get("value");dj.byId("tenor_maturity_date").set("disabled",true);var _37=dj.byId("term_code")?dj.byId("term_code").get("value"):"";if(_37){if(_37!="01"){dj.byId("accpt_adv_send_mode").set("disabled",false);}else{if(_37==="01"){dj.byId("accpt_adv_send_mode").set("value","");dj.byId("accpt_adv_send_mode").set("disabled",true);}}if(_37==="01"){m.toggleFields(true,null,["tenor_type_1"]);dj.byId("tenor_type_1").set("checked",true);dj.byId("tenor_type_2").set("disabled",true);dj.byId("tenor_type_3").set("disabled",true);dj.byId("tenor_days").set("disabled",true);dj.byId("tenor_desc").set("disabled",true);dj.byId("tenor_period").set("disabled",true);dj.byId("tenor_from_after").set("disabled",true);dj.byId("tenor_days_type").set("disabled",true);dj.byId("tenor_type_details").set("disabled",true);dj.byId("tenor_base_date").set("disabled",true);dj.byId("tenor_days").set("value","");dj.byId("tenor_desc").set("value","");dj.byId("tenor_period").set("value","");dj.byId("tenor_from_after").set("value","");dj.byId("tenor_days_type").set("value","");dj.byId("tenor_base_date").set("displayedValue","");dj.byId("tenor_maturity_date").set("displayedValue","");}else{if(_37==="02"){dj.byId("tenor_type_3").set("disabled",true);dj.byId("tenor_type_2").set("disabled",false);dj.byId("tenor_type_1").set("disabled",true);dj.byId("tenor_type_3").set("checked",false);dj.byId("tenor_type_1").set("checked",false);dj.byId("tenor_type_2").set("checked",true);dj.byId("tenor_desc").set("disabled",true);m.toggleAllTenorFields();if(dj.byId("tenor_maturity_date").get("value")){dj.byId("tenor_days").set("disabled",true);dj.byId("tenor_period").set("disabled",true);dj.byId("tenor_from_after").set("disabled",true);dj.byId("tenor_days_type").set("disabled",true);m.toggleRequired("tenor_days_type",false);dj.byId("tenor_type_details").set("disabled",true);dj.byId("tenor_base_date").set("disabled",true);m.toggleRequired("tenor_base_date",false);m.toggleRequired(dojo.query(_1)[0].innerHTML=m.getLocalization("tenorPeriod"),false);}else{if(dj.byId("tenor_days")&&dj.byId("tenor_days").get("value")){dj.byId("tenor_maturity_date").set("displayedValue","");m.toggleRequired("tenor_maturity_date",false);dj.byId("tenor_maturity_date").set("disabled",true);}else{dj.byId("tenor_days").set("disabled",false);dj.byId("tenor_period").set("disabled",false);dj.byId("tenor_from_after").set("disabled",false);dj.byId("tenor_days_type").set("disabled",false);m.toggleRequired("tenor_days_type",true);dj.byId("tenor_type_details").set("disabled",false);dj.byId("tenor_base_date").set("disabled",false);m.toggleAllTenorFields();}}}else{if(_37==="04"){dj.byId("tenor_type_3").set("disabled",false);dj.byId("tenor_type_2").set("disabled",true);dj.byId("tenor_type_1").set("disabled",true);dj.byId("tenor_type_1").set("checked",false);dj.byId("tenor_type_2").set("checked",false);dj.byId("tenor_type_3").set("checked",true);dj.byId("tenor_desc").set("disabled",true);m.toggleAllTenorFields();if(dj.byId("tenor_maturity_date").get("value")){dj.byId("tenor_days").set("disabled",true);dj.byId("tenor_period").set("disabled",true);dj.byId("tenor_from_after").set("disabled",true);dj.byId("tenor_days_type").set("disabled",true);m.toggleRequired("tenor_days_type",false);dj.byId("tenor_type_details").set("disabled",true);dj.byId("tenor_base_date").set("disabled",true);m.toggleRequired("tenor_base_date",false);m.toggleRequired(dojo.query(_1)[0].innerHTML=m.getLocalization("tenorPeriod"),false);}else{if(dj.byId("tenor_days")&&dj.byId("tenor_days").get("value")){dj.byId("tenor_maturity_date").set("displayedValue","");m.toggleRequired("tenor_maturity_date",false);dj.byId("tenor_maturity_date").set("disabled",true);}else{dj.byId("tenor_days").set("disabled",false);dj.byId("tenor_period").set("disabled",false);dj.byId("tenor_from_after").set("disabled",false);dj.byId("tenor_days_type").set("disabled",false);m.toggleRequired("tenor_days_type",true);dj.byId("tenor_type_details").set("disabled",false);dj.byId("tenor_base_date").set("disabled",false);m.toggleAllTenorFields();}}}else{dj.byId("tenor_type_1").set("disabled",false);dj.byId("tenor_type_2").set("disabled",false);dj.byId("tenor_type_3").set("disabled",false);dj.byId("tenor_desc").set("disabled",false);m.toggleRequired("tenor_desc",true);if(dj.byId("tenor_type_2").get("checked")||dj.byId("tenor_type_3").get("checked")){m.toggleAllTenorFields();}else{dj.byId("tenor_days").set("disabled",true);dj.byId("tenor_period").set("disabled",true);dj.byId("tenor_from_after").set("disabled",true);dj.byId("tenor_days_type").set("disabled",true);dj.byId("tenor_type_details").set("disabled",true);dj.byId("tenor_base_date").set("disabled",true);dj.byId("tenor_maturity_date").set("disabled",true);m.toggleRequired("tenor_maturity_date",false);m.toggleRequired("tenor_days",false);m.toggleRequired("tenor_period",false);m.toggleRequired("tenor_from_after",false);m.animate("fadeOut",d.byId("boe"));}}}}var _38=dj.byId("tenor_days_type")?dj.byId("tenor_days_type").get("value"):"";if(_38==="O"){dj.byId("tenor_type_details").set("disabled",false);m.toggleRequired("tenor_type_details",true);}else{dj.byId("tenor_type_details").set("disabled",true);}}else{dj.byId("tenor_desc").set("disabled",true);dj.byId("tenor_type_1").set("disabled",true);dj.byId("tenor_type_2").set("disabled",true);dj.byId("tenor_type_3").set("disabled",true);dj.byId("tenor_days").set("disabled",true);dj.byId("tenor_period").set("disabled",true);dj.byId("tenor_from_after").set("disabled",true);dj.byId("tenor_days_type").set("disabled",true);dj.byId("tenor_type_details").set("disabled",true);dj.byId("tenor_base_date").set("disabled",true);}m.setCurrency(dj.byId("ec_cur_code"),["ec_amt"]);var _39=dj.byId("remitting_bank_abbv_name");if(_39){_39.onChange();}var _3a=dj.byId("remitting_bank_customer_reference");if(_3a){_3a.onChange();_3a.set("value",dj.byId("remitting_bank_customer_reference").value);}m.populateGridOnLoad("ec");if(dj.byId("ec_type_code")&&dj.byId("ec_type_code").get("value")==="03"&&dj.byId("dir_coll_letter_flag")){dj.byId("dir_coll_letter_flag").set("value","Y");}if(dj.byId("boe_flag")){if(dj.byId("term_code").get("value")!=="01"){m.animate("fadeIn",d.byId("boe"));}else{m.animate("fadeOut",d.byId("boe"));dj.byId("boe_flag").set("checked",false);}}if(dj.byId("documents_details_total_send")){dj.byId("documents_details_total_send").set("readOnly",true);}if(dj.byId("inco_term_year")){m.getIncoYear();dijit.byId("inco_term_year").set("value",dj.byId("org_term_year").get("value"));}if(dj.byId("inco_term")){if(dj.byId("remitting_bank_abbv_name")&&dj.byId("remitting_bank_abbv_name").get("value")!=""&&dj.byId("inco_term_year")&&dj.byId("inco_term_year").get("value")!=""){m.getIncoTerm();}dijit.byId("inco_term").set("value",dj.byId("org_inco_term").get("value"));}var _3b=dj.byId("inco_term")?dj.byId("inco_term").get("value"):"";if(_3b){m.toggleFields(_3b,null,["inco_place"],false,true);}else{m.toggleFields(_3b,null,["inco_place"],false,false);}},beforeSaveValidations:function(){var _3c=dj.byId("entity");if(_3c&&_3c.get("value")===""){return false;}else{return true;}},beforeSubmitValidations:function(){var _3d=_a();if(_3d){var _3e=dj.byId("boe_flag");var _3f=dj.byId("dir_coll_letter_flag");var _40=dj.byId("ec_amt");if(_3f&&!(_3f.get("checked"))){_3f.set("value","N");}if(_3e&&!(_3e.get("checked"))){_3e.set("value","N");}if(_40){if(!m.validateAmount(_40)){m._config.onSubmitErrorMsg=m.getLocalization("amountcannotzero");_40.set("value","");return false;}}_3d=m.validateLSAmtSumAgainstTnxAmt("ec");}if(!_25()){m._config.onSubmitErrorMsg=m.getLocalization("documentattachedMustError");return false;}if(!(m.validateLength(["drawer","drawee","presenting_bank","collecting_bank"]))){return false;}if(dj.byId("remitting_bank_abbv_name")&&!m.validateApplDate(dj.byId("remitting_bank_abbv_name").get("value"))){m._config.onSubmitErrorMsg=m.getLocalization("changeInApplicationDates");m.goToTop();return false;}return _3d;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.trade.create_ec_client");}