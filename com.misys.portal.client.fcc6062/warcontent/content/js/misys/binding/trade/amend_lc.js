/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.trade.amend_lc"]){dojo._hasResource["misys.binding.trade.amend_lc"]=true;dojo.provide("misys.binding.trade.amend_lc");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.file");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.widget.Collaboration");dojo.require("misys.binding.trade.ls_common");(function(d,dj,m){var _1="deletegridrecord";m._config=m._config||{};m._config.expDate=m._config.expDate||{};m._config.lastShipDate=m._config.lastShipDate||{};d.mixin(m._config,{initReAuthParams:function(){var _2={productCode:"LC",subProductCode:"",transactionTypeCode:"03",entity:dj.byId("entity")?dj.byId("entity").get("value"):"",currency:dj.byId("lc_cur_code")?dj.byId("lc_cur_code").get("value"):"",amount:dj.byId("lc_amt")?m.trimAmount(dj.byId("lc_amt").get("value")):"",es_field1:dj.byId("lc_amt")?m.trimAmount(dj.byId("lc_amt").get("value")):"",es_field2:""};return _2;},xmlTransform:function(_3){var _4="<lc_tnx_record>";if(_3.indexOf(_4)!=-1){var _5=m._config.xmlTagName,_6=_5?["<",_5,">"]:[],_7="</lc_tnx_record>",_8="",_9=-1;_8=_3.substring(_4.length,(_3.length-_7.length));_6.push(_8);if(dj.byId("gridLicense")&&dj.byId("gridLicense").store&&dj.byId("gridLicense").store!==null&&dj.byId("gridLicense").store._arrayOfAllItems.length>0){_6.push("<linked_licenses>");dj.byId("gridLicense").store.fetch({query:{REFERENCEID:"*"},onComplete:dojo.hitch(dj.byId("gridLicense"),function(_a,_b){dojo.forEach(_a,function(_c){_6.push("<license>");_6.push("<ls_ref_id>",_c.REFERENCEID,"</ls_ref_id>");_6.push("<bo_ref_id>",_c.BO_REF_ID,"</bo_ref_id>");_6.push("<ls_number>",_c.LS_NUMBER,"</ls_number>");_6.push("<ls_allocated_amt>",_c.LS_ALLOCATED_AMT,"</ls_allocated_amt>");_6.push("<ls_amt>",_c.LS_AMT,"</ls_amt>");_6.push("<ls_os_amt>",_c.LS_OS_AMT,"</ls_os_amt>");_6.push("<converted_os_amt>",_c.CONVERTED_OS_AMT,"</converted_os_amt>");_6.push("<allow_overdraw>",_c.ALLOW_OVERDRAW,"</allow_overdraw>");_6.push("</license>");});})});_6.push("</linked_licenses>");}if(_5){_6.push("</",_5,">");}return _6.join("");}else{return _3;}}});function _d(){if(dj.byId("pstv_tol_pct")&&dj.byId("org_pstv_tol_pct")&&((dj.byId("pstv_tol_pct").get("value")==dj.byId("org_pstv_tol_pct").get("value"))||(isNaN(dj.byId("pstv_tol_pct").get("value"))&&dj.byId("org_pstv_tol_pct").get("value")==""))&&isNaN(dj.byId("dec_amt").get("value"))&&isNaN(dj.byId("inc_amt").get("value"))){m.animate("wipeOut",d.byId("facilityLimitDetail"));if(dj.byId("booking_amt")){dj.byId("booking_amt").set("value",0);m.toggleFields(false,null,["limit_id","booking_amt","facility_id","booking_cur_code"],true,false);}}if(dj.byId("inc_amt")&&!isNaN(dj.byId("inc_amt").get("value"))){dj.byId("inc_amt").onBlur();}else{if(dj.byId("dec_amt")&&!isNaN(dj.byId("dec_amt").get("value"))){dj.byId("dec_amt").onBlur();}}};function _e(_f){var _10=dj.byId("pstv_tol_pct"),_11=dj.byId("org_pstv_tol_pct"),_12=_10.get("value"),_13=_11.get("value"),_14;if(isNaN(dj.byId("dec_amt").get("value"))&&isNaN(dj.byId("inc_amt").get("value"))){if(dj.byId("booking_amt")&&_10&&_11){if(_13>_12){_14=_f*dj.byId("org_lc_amt").get("value")*((_13-_12)/100);}else{if(_13<_12){_14=_f*dj.byId("org_lc_amt").get("value")*((_12-_13)/100);}else{_14=0;}}dj.byId("tol_booking_amt").attr("value",_14,false);}if((isNaN(_12)&&(!isNaN(_13))&&_13!=="")){_14=_f*dj.byId("org_lc_amt").get("value")*((_13)/100);dj.byId("tol_booking_amt").attr("value",_14,false);dj.byId("booking_amt").attr("value",_14,false);}}};function _15(_16,_17){var _18=dj.byId("pstv_tol_pct"),_19=dj.byId("org_pstv_tol_pct"),_1a=_18.get("value"),_1b=_19.get("value"),_1c=_16*_17,_1d=_1c;if(_18&&_19){if((!isNaN(_1b))&&_1b!==""){if((!isNaN(_1a))&&_1a!==""){if(_1b>_1a){_1d=_1c+(_1a/100)*_1c-dj.byId("org_lc_amt").get("value")*((_1b-_1a)/100);}else{if(_1b<_1a){_1d=_1c+(_1a/100)*_1c+dj.byId("org_lc_amt").get("value")*((_1a-_1b)/100);}else{_1d=_1c+(_1b/100)*_1c;}}}else{_1d=_1c-dj.byId("org_lc_amt").get("value")*((_1b)/100);}}else{if((!isNaN(_1a))&&_1a!==""){_1d=_1c+(_1a/100)*(_1c+dj.byId("org_lc_amt").get("value"));}}}dj.byId("tol_booking_amt").attr("value",_1d,false);};function _1e(_1f,_20){var _21=dj.byId("pstv_tol_pct"),_22=dj.byId("org_pstv_tol_pct"),_23=_21.get("value"),_24=_22.get("value"),_25=_1f*_20,_26=_25;if(_21&&_22){if((!isNaN(_24))&&_24!==""){if((!isNaN(_23))&&_23!==""){if(_24>_23){_26=_25+(_23/100)*_25+dj.byId("org_lc_amt").get("value")*((_24-_23)/100);}else{if(_24<_23){_26=_25+(_24/100)*_25-(dj.byId("org_lc_amt").get("value")-_25)*((_23-_24)/100);}else{_26=_25+(_24/100)*_25;}}}else{_26=_25+dj.byId("org_lc_amt").get("value")*((_24)/100);}}else{if((!isNaN(_23))&&_23!==""){_26=_25-(dj.byId("org_lc_amt").get("value")-_25)*(_23/100);}}}dj.byId("tol_booking_amt").attr("value",_26,false);};function _27(){if(dj.byId("lc_liab_amt")&&dj.byId("lc_liab_amt").get("value")!==null&&dj.byId("dec_amt")&&dj.byId("dec_amt").get("value")!==null){if(d.number.parse(dijit.byId("lc_liab_amt").get("value"))<dijit.byId("dec_amt").get("value")){var _28=dj.byId("lc_cur_code").get("value");var _29=dojo.number.parse(dj.byId("lc_liab_amt").get("value"));dj.byId("dec_amt").invalidMessage=m.getLocalization("decAmountLessThanOutstandingAmt",[_28,_29.toFixed(2)]);misys.dialog.show("ERROR",dj.byId("dec_amt").invalidMessage,"",function(){dj.byId("dec_amt").focus();dj.byId("dec_amt").set("state","Error");});return false;}else{if(d.number.parse(dijit.byId("org_lc_amt").get("value"))<dijit.byId("dec_amt").get("value")){dijit.byId("dec_amt").invalidMessage=m.getLocalization("decreaseAmountShouldBeLessThanLCAmount");misys.dialog.show("ERROR",dj.byId("dec_amt").invalidMessage,"",function(){dj.byId("dec_amt").focus();dj.byId("dec_amt").set("state","Error");});return false;}}return true;}};function _2a(){var _2b=d.byId("facilityLimitDetail");if(!isNaN(this.get("value"))&&_2b){m.animate("wipeIn",_2b);if(this.id==="inc_amt"){_2c(this);m.toggleFields(false,null,["limit_id","booking_amt","facility_id"],true,false);m.toggleFields(true,null,["booking_amt"],true,false);}else{if(dj.byId("orginal_facility_id")&&dj.byId("orginal_limit_id")&&dj.byId("facility_id")&&dj.byId("limit_id")){dj.byId("facility_id").set("value",dj.byId("orginal_facility_id").get("value"));dj.byId("limit_id").set("value",dj.byId("orginal_limit_id").get("value"));}_2c(this);m.toggleFields(false,null,["limit_id","booking_amt","facility_id"],true,false);}m.toggleFields(true,null,["limit_id","booking_amt","facility_id","booking_cur_code"],true,true);}else{if((dj.byId("pstv_tol_pct")&&dj.byId("org_pstv_tol_pct")&&((isNaN(dj.byId("pstv_tol_pct").get("value"))&&dj.byId("org_pstv_tol_pct").get("value")!="")||(!isNaN(dj.byId("pstv_tol_pct").get("value"))&&dj.byId("org_pstv_tol_pct").get("value")=="")))&&_2b){m.animate("wipeIn",_2b);_e(1);dj.byId("booking_amt").attr("value",dj.byId("tol_booking_amt").get("value"),false);m.toggleFields(true,null,["limit_id","booking_amt","facility_id","booking_cur_code"],true,true);}else{if((dj.byId("pstv_tol_pct")&&dj.byId("org_pstv_tol_pct")&&dj.byId("pstv_tol_pct").get("value")!=dj.byId("org_pstv_tol_pct").get("value"))&&_2b){_d();}else{if(_2b){m.animate("wipeOut",_2b);dj.byId("booking_amt").set("value",0);m.toggleFields(false,null,["limit_id","booking_amt","facility_id","booking_cur_code"],true,false);}}}}};function _2c(_2d){var _2e=dj.byId("lc_cur_code"),_2f=dj.byId("limit_outstanding_cur_code"),_30=dj.byId("limit_outstanding_amount"),_31=dj.byId("facility_outstanding_cur_code"),_32=dj.byId("facility_outstanding_amount"),_33=dj.byId("booking_amt"),_34="";if(_2d&&_2d.id==="inc_amt"&&_33){_33.set("displayedValue","");}if(_2e&&_2f&&_30&&_31&&_32&&_33){var _35=_30.get("value"),_36=_32.get("value"),_37=_2f.get("value"),_38=_2e.get("value"),_39=_31.get("value"),_3a=_33.get("value"),_3b=true,_3c=_2d&&_2d.id!=="pstv_tol_pct"?_2d.get("value"):"",_3d="";if(_37!==""&&_38!==""&&_39!==""&&_37!==""){if(_37!==_38){_34=_38+"_"+_37+"_limit,";}if(_39!==_37){_34=_34+_39+"_"+_37+"_facility";}if(_34+"S"!=="S"){m.getCurrencyRateForFacility(_34);if(_2d&&_2d.id==="inc_amt"){if(m._config.limitRate&&_3c!==""){_3a=_3c*m._config.limitRate;_15(_3c,m._config.limitRate);_3a=dj.byId("tol_booking_amt").get("value");}_33.attr("value",_3a,false);if(_3a>_35){_3b=false;if(m._config.limitRate!==1){_3d=m.getLocalization("invalidBookingAmountCurrency",["Limit",_38+"/"+_37]);}else{if(m._config.limitRate!==1){_3d=m.getLocalization("invalidBookingAmountCurrency",["Facility",_39+"/"+_37]);}else{_3d=m.getLocalization("invalidBookingAmount",["Limit"]);}}}if(_3b&&_3a>_36*m._config.facilityRate){_3b=false;_3d=m.getLocalization("invalidBookingAmountCurrency",["Facility",_39+"/"+_37]);}}else{if(_2d&&_2d.id==="dec_amt"){if(m._config.limitRate&&_3c!==""){_3a=_3c*m._config.limitRate;_1e(_3c,m._config.limitRate);_3a=dj.byId("tol_booking_amt").get("value");}_33.attr("value",_3a,false);}else{if(m._config.limitRate&&_3c!==""){_3a=_3c*m._config.limitRate;}else{if(_3c===""){_e(m._config.limitRate);_3a=dj.byId("tol_booking_amt").get("value");}}_33.attr("value",_3a,false);}}}else{if(_3c!==""){_3a=_3c;}if(_2d&&_2d.id==="inc_amt"){_15(_3c,1);_3a=dj.byId("tol_booking_amt").get("value");_33.attr("value",_3a,false);}else{if(_2d&&_2d.id==="dec_amt"){_3a=_3c;_1e(_3c,1);_3a=dj.byId("tol_booking_amt").get("value");_33.attr("value",_3a,false);}else{if(_3c!==""){_3a=_3c;}else{_e(1);_3a=dj.byId("tol_booking_amt").get("value");}_33.attr("value",_3a,false);}}}}if(!_2d||_2d.id!=="dec_amt"){if(_3a>dj.byId("tol_booking_amt").get("value")){_3b=false;_3d=m.getLocalization("invalidBookingAmountTnx");}if(_3b&&_3a>_35){_3b=false;_3d=m.getLocalization("invalidBookingAmount",["Limit"]);}if(_3b&&_3a>_36){_3b=false;_3d=m.getLocalization("invalidBookingAmount",["Facility"]);}}if(!_3b){if(_2d){_33.focus();}_33.set("state","Error");dj.hideTooltip(_33.domNode);dj.showTooltip(_3d,_33.domNode,100);}}};d.mixin(m,{bind:function(){m.setValidation("exp_date",m.validateTradeExpiryDate);m.setValidation("amd_date",m.validateAmendmentDate);m.setValidation("alt_applicant_country",m.validateCountry);m.setValidation("next_revolve_date",m.validateNextRevolveDate);m.connect("inc_amt","onBlur",function(){m.validateAmendAmount(true,this,"lc");if(dj.byId("dec_amt")){dj.byId("dec_amt").set("value","");}});m.connect("dec_amt","onBlur",function(){_27();m.validateAmendAmount(true,this,"lc");if(dj.byId("inc_amt")){dj.byId("inc_amt").set("value","");}});m.setValidation("pstv_tol_pct",m.validateTolerance);m.setValidation("neg_tol_pct",m.validateTolerance);m.setValidation("max_cr_desc_code",m.validateMaxCreditTerm);m.setValidation("last_ship_date",m.validateLastShipmentDate);m.connect("inc_amt","onBlur",m.amendTransaction);m.connect("inc_amt","onBlur",_2a);m.connect("pstv_tol_pct","onChange",_2a);m.connect("pstv_tol_pct","onChange",function(){if(d.byId("facilityLimitDetail")){_d();}});m.connect("limit_id","onChange",m.setLimitFieldsValue);m.connect("booking_amt","onBlur",function(){_2c();});m.connect("facility_id","onChange",function(){m.getLimitDetails(true);if(dj.byId("booking_amt")){dj.byId("booking_amt").set("displayedValue","");}});m.connect("limit_id","onChange",function(){if(dj.byId("inc_amt")&&!isNaN(dj.byId("inc_amt").get("value"))){_2c(dj.byId("inc_amt"));}else{if(dj.byId("dec_amt")&&!isNaN(dj.byId("dec_amt").get("value"))){_2c(dj.byId("dec_amt"));}}});m.connect("dec_amt","onBlur",_2a);m.connect("dec_amt","onBlur",m.amendTransaction);m.connect("narrative_shipment_period","onChange",function(){m.toggleDependentFields(this,dj.byId("last_ship_date"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));});m.connect("narrative_shipment_period","onClick",function(){m.toggleDependentFields(this,dj.byId("last_ship_date"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));});m.connect("last_ship_date","onChange",function(){m.toggleDependentFields(this,dj.byId("narrative_shipment_period"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));});m.connect("last_ship_date","onClick",function(){m.toggleDependentFields(this,dj.byId("narrative_shipment_period"),m.getLocalization("shipmentDateOrPeriodExclusivityError"));});m.connect("adv_send_mode","onChange",function(){m.toggleMT798Fields("issuing_bank_abbv_name");});m.connect("license_lookup","onClick",function(){m.getLicenses("lc");});m.connect("exp_date","onChange",function(){m.clearLicenseGrid(this,m._config.expDate,"lc");});m.connect("last_ship_date","onChange",function(){m.clearLicenseGrid(this,m._config.lastShipDate,"lc");});m.connect("delivery_channel","onChange",function(){if(dj.byId("delivery_channel")&&dj.byId("delivery_channel").get("value")==="FACT"){deliveryChannelFileAct=true;}else{deliveryChannelFileAct=false;}});m.connect("for_account_flag","onChange",function(){if(this.get("checked")){m.animate("fadeIn",d.byId("alternate-party-details"));}else{m.animate("fadeOut",d.byId("alternate-party-details"));dj.byId("alt_applicant_name").set("value","");dj.byId("alt_applicant_address_line_1").set("value","");dj.byId("alt_applicant_address_line_2").set("value","");dj.byId("alt_applicant_dom").set("value","");dj.byId("alt_applicant_country").set("value","");}});m.connect("for_account_flag","onChange",function(){m.toggleFields((this.get("value")==="on"),["alt_applicant_address_line_2","alt_applicant_dom"],["alt_applicant_name","alt_applicant_address_line_1","alt_applicant_country"]);});},onFormLoad:function(){m.xhrPost({url:misys.getServletURL("/screen/AjaxScreen/action/GetAmendmentWarning"),handleAs:"json",sync:true,content:{refId:dj.byId("ref_id").get("value"),companyId:dj.byId("company_id").get("value"),productCode:"LC"},load:function(_3e,_3f){m._config.showWarningBene=_3e.showWarningBene?_3e.showWarningBene:false;}});if(m._config.showWarningBene){m.dialog.show("CONFIRMATION",m.getLocalization("warningMsgAmendLC"),"","","","","",function(){var _40="/screen/LetterOfCreditScreen?option=EXISTING&tnxtype=03";window.location.href=misys.getServletURL(_40);return;});}m._config.expDate=dj.byId("exp_date").get("displayedValue");m._config.lastShipDate=dj.byId("last_ship_date").get("displayedValue");m.setCurrency(dj.byId("lc_cur_code"),["inc_amt","dec_amt","org_lc_amt","lc_amt","tnx_amt"]);var _41=dj.byId("issuing_bank_abbv_name").get("value");var _42=m._config.customerBanksMT798Channel[_41]===true;var _43=dojo.subscribe(_1,function(){m.toggleFields(m._config.customerBanksMT798Channel[_41]===true&&m.hasAttachments(),null,null,false,false);});var _44=dj.byId("adv_send_mode");if(_44){_44.onChange();}if(dj.byId("adv_send_mode").value=="01"){dj.byId("delivery_channel").set("disabled",true);dj.byId("delivery_channel").set("readOnly",true);dj.byId("delivery_channel").onChange();}if(_42){m.animate("wipeOut",d.byId("adv_send_mode_row"));m.toggleRequired("adv_send_mode",false);}else{m.animate("wipeIn",d.byId("adv_send_mode_row"));m.toggleRequired("adv_send_mode",true);}if(dj.byId("for_account_flag")){if(dj.byId("for_account_flag").get("checked")){m.animate("fadeIn",d.byId("alternate-party-details"));}else{m.animate("fadeOut",d.byId("alternate-party-details"));dj.byId("alt_applicant_name").set("value","");dj.byId("alt_applicant_address_line_1").set("value","");dj.byId("alt_applicant_address_line_2").set("value","");dj.byId("alt_applicant_dom").set("value","");dj.byId("alt_applicant_country").set("value","");}}var _45=dj.byId("for_account_flag");if(_45){m.toggleFields(_45.get("value")==="on",["alt_applicant_address_line_2","alt_applicant_dom"],["alt_applicant_name","alt_applicant_address_line_1","alt_applicant_country"]);}if(dj.byId("facility_id")){dj.byId("facility_id").onChange();if(dj.byId("inc_amt")&&!isNaN(dj.byId("inc_amt").get("value"))){m.toggleFields(false,null,["limit_id","booking_amt","facility_id"],true,false);m.toggleFields(true,null,["booking_amt"],true,false);}else{if(dj.byId("dec_amt")&&!isNaN(dj.byId("dec_amt").get("value"))){m.toggleFields(false,null,["limit_id","booking_amt","facility_id"],true,false);}}m.toggleFields(true,null,["limit_id","booking_amt","facility_id","booking_cur_code"],true,true);}if(dj.byId("inc_amt")&&isNaN(dj.byId("inc_amt").get("value"))&&dj.byId("dec_amt")&&isNaN(dj.byId("dec_amt").get("value"))){if(dj.byId("booking_amt")){dj.byId("booking_amt").set("required",false);dj.byId("booking_amt").set("value",0);}m.animate("wipeOut",d.byId("facilityLimitDetail"));}m.populateGridOnLoad("lc");},beforeSaveValidations:function(){var _46=dj.byId("fee_act_no");var _47=dj.byId("principal_act_no");if(_47&&_47.get("value")!==""){if(!m.validatePricipleAccount()){m._config.onSubmitErrorMsg=m.getLocalization("invalidPrincipleAccountError",[_47.get("displayedValue")]);m.showTooltip(m.getLocalization("invalidPrincipleAccountError",[_47.get("displayedValue")]),_47.domNode);_47.focus();return false;}}if(_46&&_46.get("value")!==""){if(!m.validateFeeAccount()){m._config.onSubmitErrorMsg=m.getLocalization("invalidFeeAccountError",[_46.get("displayedValue")]);m.showTooltip(m.getLocalization("invalidFeeAccountError",[_46.get("displayedValue")]),_46.domNode);_46.focus();return false;}}},beforeSubmitValidations:function(){var _48=["exp_date","org_exp_date","pstv_tol_pct","org_pstv_tol_pct","neg_tol_pct","org_neg_tol_pct","ship_from","ship_loading","ship_discharge","ship_to","last_ship_date","narrative_shipment_period","narrative_additional_amount","org_narrative_additional_amount","inc_amt","dec_amt","amd_details","file","revolve_time_no","revolve_period","revolve_frequency","notice_days","charge_upto","next_revolve_date"];var _49=d.every(_48,function(id){if(d.byId(id)){return true;}return false;});if(_49){var _4a=m.trim(dj.byId("narrative_shipment_period").get("value"));var _4b=m.trim(dj.byId("org_narrative_shipment_period").get("value"));var _4c=m.trim(dj.byId("narrative_additional_amount").get("value"));var _4d=m.trim(dj.byId("org_narrative_additional_amount").get("value"));var _4e=["pstv_tol_pct","neg_tol_pct","ship_from","ship_loading","ship_discharge","ship_to","revolve_time_no","revolve_period","revolve_frequency","notice_days","charge_upto"];var _4f=d.every(_4e,function(id){var _50=dj.byId(id).get("value")+"";var _51=dj.byId("org_"+id).get("value")+"";if(_50=="NaN"||_50=="null"||_50=="undefined"){_50="";}if(_50==_51){return true;}return false;});var _52=["exp_date","last_ship_date","next_revolve_date"];var _53=d.every(_52,function(id){var _54=dj.byId(id).get("value")+"";var _55=d.date.locale.parse(dj.byId("org_"+id).get("displayedValue"),{selector:"date",datePattern:m.getLocalization("g_strGlobalDateFormat")})+"";if(_54==="null"||_54===_55){return true;}return false;});var _56=(d.query("#edit [id^='file_row_']").length>1);if(_4f&&_53&&!_56&&(_4a==_4b)&&(_4c==_4d)&&!dj.byId("inc_amt").get("value")&&!dj.byId("dec_amt").get("value")&&(dj.byId("amd_details").get("value")==="")){m._config.onSubmitErrorMsg=m.getLocalization("noAmendmentError");return false;}}var _57=dj.byId("principal_act_no");if(_57&&_57.get("value")!==""){if(!m.validatePricipleAccount()){m._config.onSubmitErrorMsg=m.getLocalization("invalidPrincipleAccountError",[_57.get("displayedValue")]);m.showTooltip(m.getLocalization("invalidPrincipleAccountError",[_57.get("displayedValue")]),_57.domNode);_57.focus();return false;}}var _58=dj.byId("fee_act_no");if(_58&&_58.get("value")!==""){if(!m.validateFeeAccount()){m._config.onSubmitErrorMsg=m.getLocalization("invalidFeeAccountError",[_58.get("displayedValue")]);m.showTooltip(m.getLocalization("invalidFeeAccountError",[_58.get("displayedValue")]),_58.domNode);_58.focus();return false;}}if(dj.byId("revolve_period")&&dj.byId("org_revolve_period")&&dj.byId("revolve_period").get("value")===""){dj.byId("revolve_period").set("value",dj.byId("org_revolve_period").get("value"));}if(dj.byId("revolve_frequency")&&dj.byId("org_revolve_frequency")&&dj.byId("revolve_frequency").get("value")===""){dj.byId("revolve_frequency").set("value",dj.byId("org_revolve_frequency").get("value"));}if(dj.byId("revolve_time_no")&&dj.byId("org_revolve_time_no")&&dj.byId("revolve_time_no").get("value")===""){dj.byId("revolve_time_no").set("value",dj.byId("org_revolve_time_no").get("value"));}if(dj.byId("next_revolve_date")&&dj.byId("org_next_revolve_date")&&dj.byId("next_revolve_date").get("value")===""){dj.byId("next_revolve_date").set("value",dj.byId("org_next_revolve_date").get("value"));}if(dj.byId("notice_days")&&dj.byId("org_notice_days")&&dj.byId("notice_days").get("value")===""){dj.byId("notice_days").set("value",dj.byId("org_notice_days").get("value"));}if(dj.byId("charge_upto")&&dj.byId("org_charge_upto")&&dj.byId("charge_upto").get("value")===""){dj.byId("charge_upto").set("value",dj.byId("org_charge_upto").get("value"));}if(dj.byId("inc_amt")&&dj.byId("dec_amt")&&(!isNaN(dj.byId("inc_amt").get("value"))||!isNaN(dj.byId("dec_amt").get("value")))&&dj.byId("limit_review_date")&&dj.byId("facility_date")){if(d.date.compare(dj.byId("limit_review_date").get("value"),new Date(),"date")<0){m._config.onSubmitErrorMsg=m.getLocalization("amendLimitDateExpiry");return false;}}if(dj.byId("pstv_tol_pct")&&dj.byId("org_pstv_tol_pct")&&dijit.byId("org_pstv_tol_pct").get("value")!==""&&dijit.byId("max_cr_desc_code").get("value")===""&&isNaN(dijit.byId("pstv_tol_pct").get("value"))){dj.byId("pstv_tol_pct").set("value",dj.byId("org_pstv_tol_pct").get("value"));}if(dj.byId("neg_tol_pct")&&dj.byId("org_neg_tol_pct")&&dijit.byId("org_neg_tol_pct").get("value")!==""&&dijit.byId("max_cr_desc_code").get("value")===""&&isNaN(dijit.byId("neg_tol_pct").get("value"))){dj.byId("neg_tol_pct").set("value",dj.byId("org_neg_tol_pct").get("value"));}if(dj.byId("ship_to")&&dj.byId("org_ship_to")&&dj.byId("org_ship_to").get("value")!==""&&dijit.byId("ship_to").get("value")===""){dj.byId("ship_to").set("value",dj.byId("org_ship_to").get("value"));}if(dj.byId("ship_from")&&dj.byId("org_ship_from")&&dj.byId("org_ship_from").get("value")!==""&&dijit.byId("ship_from").get("value")===""){dj.byId("ship_from").set("value",dj.byId("org_ship_from").get("value"));}if(dj.byId("ship_discharge")&&dj.byId("org_ship_discharge")&&dj.byId("org_ship_discharge").get("value")!==""&&dijit.byId("ship_discharge").get("value")===""){dj.byId("ship_discharge").set("value",dj.byId("org_ship_discharge").get("value"));}if(dj.byId("ship_loading")&&dj.byId("org_ship_loading")&&dj.byId("org_ship_loading").get("value")!==""&&dijit.byId("ship_loading").get("value")===""){dj.byId("ship_loading").set("value",dj.byId("org_ship_loading").get("value"));}if(dj.byId("last_ship_date")&&dj.byId("org_last_ship_date")&&dj.byId("org_last_ship_date").get("value")!==""&&dijit.byId("last_ship_date").get("value")==null){dj.byId("last_ship_date").set("value",dj.byId("org_last_ship_date").get("value"));}if(dj.byId("narrative_shipment_period")&&dj.byId("org_narrative_shipment_period")&&dj.byId("org_narrative_shipment_period").get("value")!==""&&dijit.byId("narrative_shipment_period").get("value")===""){dj.byId("narrative_shipment_period").set("value",dj.byId("org_narrative_shipment_period").get("value"));}return m.validateLSAmtSumAgainstTnxAmt("lc");},beforeSubmit:function(){m.updateSubTnxTypeCode("lc");}});})(dojo,dijit,misys);dojo.require("misys.client.binding.trade.amend_lc_client");}