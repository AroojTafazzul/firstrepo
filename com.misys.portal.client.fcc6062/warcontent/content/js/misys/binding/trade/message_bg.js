/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.trade.message_bg"]){dojo._hasResource["misys.binding.trade.message_bg"]=true;dojo.provide("misys.binding.trade.message_bg");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.TooltipDialog");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dijit.form.FilteringSelect");dojo.require("dojo.data.ItemFileReadStore");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.form.file");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("misys.widget.Collaboration");(function(d,dj,m){var _1="deletegridrecord";d.mixin(m._config,{initReAuthParams:function(){var _2={productCode:"BG",subProductCode:"",transactionTypeCode:"13",entity:dj.byId("entity")?dj.byId("entity").get("value"):"",currency:"",amount:"",es_field1:"",es_field2:""};return _2;}});function _3(_4){var _5="bg",_6=dj.byId("sub_tnx_type_code").get("value")==="62",_7,_8,_9;_7=function(){m.toggleFields(_6,["principal_act_no","fee_act_no"],["tnx_amt"],_4);if(dj.byId("is_amt_editable")&&dj.byId("is_amt_editable").get("value")==="true"){dj.byId("tnx_amt").set("readOnly",false);}else{dj.byId("tnx_amt").set("readOnly",true);}};_9=(_6)?"fadeIn":"fadeOut";m.animate(_9,d.byId("settlement-details"),_7);};d.mixin(m,{bind:function(){m.setValidation("exp_date",m.validateMessageTradeExpiryDate);m.connect("tnx_amt","onBlur",function(){if(!m.validateTnxAmount()){dj.byId("tnx_amt").set("value","");var _a=function(){dj.hideTooltip(dj.byId("tnx_amt").domNode);};dj.showTooltip(this.invalidMessage,dj.byId("tnx_amt").domNode,0);setTimeout(_a,10000);}});m.connect("sub_tnx_type_code","onChange",function(){_3(false);if(dj.byId("tnx_amt")&&dj.byId("claim_amt")&&dj.byId("claim_amt").get("value")!==""){dj.byId("tnx_amt").set("value",dj.byId("claim_amt").get("value"));}});m.connect("sub_tnx_type_code","onChange",function(){var _b=dj.byId("tnx_amt");var _c=dj.byId("exp_date");var _d=dj.byId("sub_tnx_type_code");var _e=dojo.date.locale.format(new Date(dj.byId("org_exp_date").get("displayedValue")),{datePattern:m.getLocalization("g_strGlobalDateFormat"),selector:"date"});if(_c){_c.set("value"," ");if(_d.get("value")=="20"){_b.set("disabled",true);m.toggleRequired(_b,false);_b.set("value","");_c.set("disabled",false);m.toggleRequired(_c,true);_c.set("value"," ");}else{if(_d.get("value")=="21"){_b.set("disabled",false);m.toggleRequired(_b,true);_b.set("value","");_c.set("value",new Date(_e));m.toggleRequired(_c,false);_c.set("disabled",true);}}}});},onFormLoad:function(){if(dj.byId("bg_cur_code")&&dj.byId("tnx_amt")){m.setCurrency(dj.byId("bg_cur_code"),["tnx_amt"]);}var _f=dj.byId("sub_tnx_type_code");var _10=dj.byId("tnx_amt");var _11=dj.byId("exp_date");var _12=dojo.date.locale.format(new Date(dj.byId("org_exp_date").get("displayedValue")),{datePattern:m.getLocalization("g_strGlobalDateFormat"),selector:"date"});var _13=dj.byId("issuing_bank_abbv_name")?dj.byId("issuing_bank_abbv_name").get("value"):"";var _14=m._config.customerBanksMT798Channel[_13]===true;if(_f){if(dj.byId("sub_tnx_type_code").get("value")==="25"||dj.byId("sub_tnx_type_code").get("value")==="62"){m.animate("fadeIn",d.byId("settlement-details"));m.toggleRequired("tnx_amt",true);}else{m.animate("fadeOut",d.byId("settlement-details"));}if(_14&&dj.byId("adv_send_mode")&&dj.byId("adv_send_mode").get("value")=="01"){m.animate("fadeIn",d.byId("bankInst"));m.connectDeliveryChannelOnChange();}else{m.animate("fadeOut",d.byId("bankInst"));}if(_10&&_11){if(_f.get("value")=="20"){_10.set("disabled",true);m.toggleRequired(_10,false);_10.set("value","");_11.set("disabled",false);m.toggleRequired(_11,true);_11.set("displayedValue",_11.get("displayedValue"));}else{if(_f.get("value")=="21"){_10.set("disabled",false);m.toggleRequired(_10,true);_10.set("value",_10.get("value"));_11.set("value"," ");m.toggleRequired(_11,false);_11.set("disabled",true);}}}}var _15=dojo.subscribe(_1,function(){m.toggleFields(m._config.customerBanksMT798Channel[_13]===true&&m.hasAttachments(),null,["delivery_channel"],false,false);});},connectDeliveryChannelOnChange:function(){var _16=dj.byId("issuing_bank_abbv_name")?dj.byId("issuing_bank_abbv_name").get("value"):"";if(dj.byId("delivery_channel")){if(!m.hasAttachments()){dj.byId("delivery_channel").set("disabled",true);dj.byId("delivery_channel").set("value",null);}else{m.toggleFields(m._config.customerBanksMT798Channel[_16]===true&&m.hasAttachments(),null,["delivery_channel"],false,false);}m.animate("fadeIn","delivery_channel_row");m.connect("delivery_channel","onChange",function(){if(dj.byId("attachment-file")){if(dj.byId("delivery_channel").get("value")==="FACT"){dj.byId("attachment-file").displayFileAct(true);}else{dj.byId("attachment-file").displayFileAct(false);}}});dj.byId("delivery_channel").onChange();}},beforeSubmitValidations:function(){if(dj.byId("sub_tnx_type_code")&&dj.byId("sub_tnx_type_code").get("value")=="21"){var _17=dj.byId("exp_date");_17.set("value",dj.byId("org_exp_date").get("value"));}if(dj.byId("sub_tnx_type_code")&&dj.byId("sub_tnx_type_code").get("value")!=="21"&&dj.byId("sub_tnx_type_code").get("value")!=="25"&&dj.byId("sub_tnx_type_code").get("value")!=="62"&&dj.byId("tnx_amt")){dj.byId("tnx_amt").set("value","");}return true;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.trade.message_bg_client");}