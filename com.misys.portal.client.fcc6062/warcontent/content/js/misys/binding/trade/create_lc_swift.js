/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.trade.create_lc_swift"]){dojo._hasResource["misys.binding.trade.create_lc_swift"]=true;dojo.provide("misys.binding.trade.create_lc_swift");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.form.DateTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("misys.widget.Dialog");dojo.require("dijit.ProgressBar");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.common");dojo.require("misys.form.file");dojo.require("misys.validation.common");dojo.require("misys.binding.SessionTimer");dojo.require("misys.binding.trade.ls_common");(function(d,dj,m){var _1=false;function _2(){var _3=false,_4=false;var _5,_6,_7,_8,_9,_a="",_b="",_c,_d,_e,_f;if(dj.byId("narrative_description_goods")&&dj.byId("narrative_documents_required")&&dj.byId("narrative_additional_instructions")&&dj.byId("narrative_special_beneficiary")){if(dj.byId("narrative_description_goods")){_5=dj.byId("narrative_description_goods").get("value")!==""?dj.byId("narrative_description_goods").get("value")+"\n":"";}if(dj.byId("narrative_documents_required")){_6=dj.byId("narrative_documents_required").get("value")!==""?dj.byId("narrative_documents_required").get("value")+"\n":"";}if(dj.byId("narrative_additional_instructions")){_7=dj.byId("narrative_additional_instructions").get("value")!==""?dj.byId("narrative_additional_instructions").get("value")+"\n":"";}if(dj.byId("narrative_special_beneficiary")){_8=dj.byId("narrative_special_beneficiary").get("value")!==""?dj.byId("narrative_special_beneficiary").get("value")+"\n":"";}if(dj.byId("narrative_special_recvbank")){_9=dj.byId("narrative_special_recvbank").get("value")!==""?dj.byId("narrative_special_recvbank").get("value")+"\n":"";}if(!m._config.isBank){_a=_5+_6+_7+_8;var _10=[_5,_6,_7,_8];_11(_10);}else{_a=_5+_6+_7+_8+_9;var _12=[_5,_6,_7,_8,_9];_11(_12);}if(dj.byId(this.id)){_c=800*this.cols;_b=dj.byId(this.id).get("value")!==""?dj.byId(this.id).get("value")+"\n":"";_d=_b.length;singleLines=_b.trim().split(/\r*\n/).length;_3=m.validateRowExtNarrativeSwiftInit2018(_b,true);}if(_1){_4=m.validateRowExtNarrativeSwiftInit2018(_a,false);}if(_4){combinedLines=_a.trim().split(/\r*\n/).length;_e=1000*this.cols;_f=_a.length;if(combinedLines>1000){this.invalidMessage=m.getLocalization("invalidLineError",[1000,combinedLines]);}else{if(_f>_e){this.invalidMessage=m.getLocalization("invalidFieldSizeError",[_e,_f]);}}}else{if(_3){if(singleLines>800){this.invalidMessage=m.getLocalization("invalidSinglelineLength",[800,singleLines]);}else{if(_d>_c){this.invalidMessage=m.getLocalization("invalidSingleFieldLength",[_c,_d]);}}}}if(_3&&_4){_3=false;}if(!_3&&!_4){_3=true;_4=true;}return _3&&_4;}};function _11(_13){for(var i=0;i<_13.length;i++){for(var j=i+1;j<_13.length;j++){if((_13[i]!="")&&(_13[i]!="undefined")&&(_13[j]!="")&&(_13[j]!="undefined")){_1=true;break;}}if(_1){break;}}};d.mixin(m,{_bindSwift2018:function(){m.connect("cfm_inst_code_1","onClick",m.resetConfirmationChargesLC);m.connect("cfm_inst_code_2","onClick",m.resetConfirmationChargesLC);m.connect("cfm_inst_code_3","onClick",m.resetConfirmationChargesLC);m.setValidation("advising_bank_iso_code",m.validateBICFormat);m.setValidation("advise_thru_bank_iso_code",m.validateBICFormat);m.setValidation("requested_confirmation_party_iso_code",m.validateBICFormat);if(misys._config.swiftExtendedNarrativeEnabled){m.setValidation("narrative_additional_instructions",_2);m.setValidation("narrative_documents_required",_2);m.setValidation("narrative_description_goods",_2);m.setValidation("narrative_special_beneficiary",_2);if(dj.byId("narrative_special_recvbank")){m.setValidation("narrative_special_recvbank",_2);}}m.connect("advising_bank_iso_code","onChange",function(){var _14=this.get("value");if(_14.length>0){m.setRequiredFields(["advising_bank_name","advising_bank_address_line_1"],false);}});m.connect("advise_thru_bank_iso_code","onChange",function(){var _15=this.get("value");if(_15.length>0){m.setRequiredFields(["advise_thru_bank_name","advise_thru_bank_address_line_1"],false);}});m.connect("requested_confirmation_party_iso_code","onChange",function(){var _16=this.get("value");if(_16.length>0){m.setRequiredFields(["requested_confirmation_party_name","requested_confirmation_party_address_line_1"],false);}});m.connect("req_conf_party_flag","onChange",m.resetBankRequiredFields);m.connect("narrative_period_presentation","onBlur",function(){var _17=dj.byId("narrative_period_presentation").get("value");dj.byId("narrative_period_presentation_nosend").set("value",_17);});m.setValidation("period_presentation_days",m.validatePeriodPresentationDays);},_onFormLoadSwift2018:function(){var _18=dj.byId("CREATE_OPTION").get("value");if(_18==="EXISTING"||_18==="BACK_TO_BACK"){m.dialog.show("CONFIRMATION",m.getLocalization("warningMsgCreateLC"),"","","","","",function(){var _19="/screen/LetterOfCreditScreen?option="+_18+"&tnxtype=01";window.location.href=misys.getServletURL(_19);return;});}var _1a=dj.byId("tran_ship_detl").value;var _1b=dj.byId("part_ship_detl").value;var _1c=m._config.displayMode;if(_1c==="edit"){m.resetRequestedConfirmationParty();}if((_1a!=""&&_1a!="ALLOWED"&&_1a!="NOT ALLOWED"&&_1a!="NONE")&&_1c==="edit"){d.byId("infoMessageTranshipment").style.display="block";d.byId("infoMessageTranshipment").style.paddingLeft="250px";}else{d.byId("infoMessageTranshipment").style.display="none";}if((_1b!=""&&_1b!="ALLOWED"&&_1b!="NOT ALLOWED"&&_1b!="NONE")&&_1c==="edit"){d.byId("infoMessagePartialShipment").style.display="block";d.byId("infoMessagePartialShipment").style.paddingLeft="250px";}else{d.byId("infoMessagePartialShipment").style.display="none";}if(dj.byId("req_conf_party_flag")){var _1d=dj.byId("req_conf_party_flag").value;if(_1d==="Other"){d.byId("requested-conf-party-bank-details").style.display="block";}else{d.byId("requested-conf-party-bank-details").style.display="none";}}},_beforeSubmitValidationsSwift2018:function(){if(dj.byId("req_conf_party_flag")&&dj.byId("req_conf_party_flag").get("value")!==""){if(dj.byId("req_conf_party_flag").get("value")==="Advising Bank"){return m.validateBankEntry("advising_bank");}else{if(dj.byId("req_conf_party_flag").get("value")==="Advise Thru Bank"){return m.validateBankEntry("advise_thru_bank");}else{if(dj.byId("req_conf_party_flag").get("value")==="Other"){if(!m.validateBankEntry("requested_confirmation_party")){m._config.onSubmitErrorMsg=m.getLocalization("requestedConfirmationPartyError");return false;}else{return true;}}}}}if(dj.byId("narrative_period_presentation_nosend")&&dj.byId("narrative_period_presentation_nosend").get("value")!==""){var _1e=dj.byId("narrative_period_presentation_nosend").get("value");if(_1e.indexOf("\n")!=-1){m._config.onSubmitErrorMsg=m.getLocalization("periodOfPresentaionError");return false;}}return true;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.trade.create_lc_swift_client");}