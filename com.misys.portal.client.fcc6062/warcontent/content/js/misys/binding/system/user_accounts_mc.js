/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.system.user_accounts_mc"]){dojo._hasResource["misys.binding.system.user_accounts_mc"]=true;dojo.provide("misys.binding.system.user_accounts_mc");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.MultiSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dojox.xml.DomParser");(function(d,dj,m){d.mixin(m._config,{initReAuthParams:function(){var _1={productCode:"UAC",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:"",es_field2:""};return _1;}});var _2=[];function _3(_4){var _5=m.getDomNode(_4,"user_id");var _6=[];for(var i=0;i<m._config.userAccounts.user_entity_accounts_record_count;i++){var _7=m._config.userAccounts.entityIdArray[i];if(m._config.userAccounts.entityAccountArray[_7]){for(var j=0;j<m._config.userAccounts.entityAccountArray[_7].length;j++){var _8=m._config.userAccounts.entityAccountArray[_7][j];var _9=_7+"_"+_8;var _a=_4.getElementsByTagName("account_products_exist_nosend_"+_9);var _b="";if(_a.length>0){var _c=_a[0].childNodes[0];if(_c&&_c.nodeValue){_b=_c.nodeValue;}}if(dijit.byId("account_enabled_"+_9)&&dijit.byId("account_enabled_"+_9).get("checked")){if(_b!==""){var _d=_b.split(",");for(var k=0;k<_d.length;k++){var _e=_d[k];_6.push(_f(_5,_8,_7,_e));}}if(dj.byId("account_pab_enabled_"+_9)&&dj.byId("account_pab_enabled_"+_9).get("checked")){_6.push(_f(_5,_8,_7,"PAB"));}if(dj.byId("account_view_stmt_enabled_"+_9)&&dj.byId("account_view_stmt_enabled_"+_9).get("checked")){_6.push(_f(_5,_8,_7,"View STMT"));}_6.push("<user_account>");_6.push(_5);_6.push("<account_id>",_8,"</account_id>");_6.push("<entity_id>",_7,"</entity_id>");if(dj.byId("return_comments")){_6.push("<return_comments>",dj.byId("return_comments").get("value"),"</return_comments>");}_6.push("<context_key>enabled</context_key><context_value>Y</context_value>");_6.push("</user_account>");}}}}return _6.join("");};function _f(_10,_11,_12,_13){var _14=["<user_account>"];_14.push(_10);_14.push("<account_id>",_11,"</account_id>");_14.push("<entity_id>",_12,"</entity_id>");if(dj.byId("return_comments")){_14.push("<return_comments>",dj.byId("return_comments").get("value"),"</return_comments>");}if(_13==="PAB"||_13==="View STMT"){_14.push("<context_key>",_13,"</context_key>");_14.push("<context_value>Y</context_value>");}else{_14.push("<context_key>product</context_key>");_14.push("<context_value>",_13,"</context_value>");}_14.push("</user_account>");return _14.join("");};function _15(id){dojo.byId("account_products_indicator_"+id).innerHTML=dijit.byId("account_products_exist_nosend_"+id).get("value").length+" "+"Product(s)";};function _16(id,_17){var _18,_19;if(_17){_18=dijit.byId("account_products_exist_nosend_"+id);_19=dijit.byId("account_products_avail_nosend_"+id);}else{_18=dijit.byId("account_products_avail_nosend_"+id);_19=dijit.byId("account_products_exist_nosend_"+id);}dojo.query("option",_19.containerNode).forEach(function(n){_18.containerNode.appendChild(n);_18.domNode.scrollTop=_18.domNode.offsetHeight;var _1a=_19.domNode.scrollTop;_19.domNode.scrollTop=0;_19.domNode.scrollTop=_1a;});_19.focus();_18.focus();_15(id);};d.mixin(m,{bind:function(){var i,j,_1b,_1c;for(i=0;i<m._config.userAccounts.user_entity_accounts_record_count;i++){_1b=m._config.userAccounts.entityIdArray[i];if(m._config.userAccounts.entityAccountArray[_1b]){for(j=0;j<m._config.userAccounts.entityAccountArray[_1b].length;j++){_1c=m._config.userAccounts.entityAccountArray[_1b][j];var _1d=_1b+"_"+_1c;var _1e=_1d.toString(),_1f=_1e.split("_")[0],_20=_1e.substr(_1f.length+1),_21=misys._config.userAccounts.accountOwnerType[_20][0],_22=misys._config.userAccounts.accountType[_20][0];if(_22===12&&dj.byId("account_view_stmt_enabled_"+_1d)){dj.byId("account_view_stmt_enabled_"+_1d).set("disabled",true);}(function(){var _23=_1b+"_"+_1c;misys.connect("account_enabled_"+_23,"onChange",function(){if(dijit.byId("account_enabled_"+_23).get("checked")){var _24=_23.toString(),_1f=_24.split("_")[0],_20=_24.substr(_1f.length+1),_21=misys._config.userAccounts.accountOwnerType[_20][0],_22=misys._config.userAccounts.accountType[_20][0];if(_21!==10){dj.byId("account_pab_enabled_"+_23).set("checked",true);dj.byId("account_pab_enabled_"+_23).set("disabled",false);}if(_22!==12){dj.byId("account_view_stmt_enabled_"+_23).set("checked",true);dj.byId("account_view_stmt_enabled_"+_23).set("disabled",false);}dijit.byId("account_products_avail_nosend_"+_23).set("disabled",false);dijit.byId("account_products_exist_nosend_"+_23).set("disabled",false);_16(_23,true);m.toggleDisplayProducts(_23,"down");}else{dj.byId("account_pab_enabled_"+_23).set("checked",false);dj.byId("account_view_stmt_enabled_"+_23).set("checked",false);dj.byId("account_pab_enabled_"+_23).set("disabled",true);dj.byId("account_view_stmt_enabled_"+_23).set("disabled",true);_16(_23,false);dijit.byId("account_products_avail_nosend_"+_23).set("disabled",true);dijit.byId("account_products_exist_nosend_"+_23).set("disabled",true);m.toggleDisplayProducts(_23,"up");}});})();}}}for(i=0;i<m._config.userAccounts.user_entity_accounts_record_count;i++){_1b=m._config.userAccounts.entityIdArray[i];(function(){var _25=_1b;misys.connect("account_select_all_"+_25,"onChange",function(){if(m._config.userAccounts.entityAccountArray[_1b]){if(!_2[_25]){if(dijit.byId("account_select_all_"+_25).get("checked")){for(j=0;j<m._config.userAccounts.entityAccountArray[_25].length;j++){_1c=m._config.userAccounts.entityAccountArray[_25][j];var _26=_25+"_"+_1c;if(dijit.byId("account_enabled_"+_26).get("checked")){dijit.byId("account_enabled_"+_26).set("checked",false);}dijit.byId("account_enabled_"+_26).set("checked",true);}}else{for(j=0;j<m._config.userAccounts.entityAccountArray[_25].length;j++){_26=_25+"_"+_1c;_1c=m._config.userAccounts.entityAccountArray[_25][j];dijit.byId("account_enabled_"+_26).set("checked",false);}}}else{_2[_25]=false;}}});})();}},onFormLoad:function(){for(var i=0;i<m._config.userAccounts.user_entity_accounts_record_count;i++){var _27=m._config.userAccounts.entityIdArray[i];var _28=true;if(m._config.userAccounts.entityAccountArray[_27]){for(var j=0;j<m._config.userAccounts.entityAccountArray[_27].length;j++){var _29=m._config.userAccounts.entityAccountArray[_27][j];var _2a=_27+"_"+_29;_15(_2a);var _2b=misys._config.userAccounts.accountOwnerType[_29][0];if(dj.byId("account_enabled_"+_2a)&&!dj.byId("account_enabled_"+_2a).get("checked")){dj.byId("account_view_stmt_enabled_"+_2a).set("checked",false);dj.byId("account_pab_enabled_"+_2a).set("disabled",true);dj.byId("account_view_stmt_enabled_"+_2a).set("disabled",true);_16(_2a,false);dijit.byId("account_products_avail_nosend_"+_2a).set("disabled",true);dijit.byId("account_products_exist_nosend_"+_2a).set("disabled",true);_28=false;}else{if(dj.byId("account_enabled_"+_2a)&&dj.byId("account_enabled_"+_2a).get("checked")){if(_2b===10){dj.byId("account_pab_enabled_"+_2a).set("disabled",true);}}}}}if(_28){_2[_27]=true;if(dj.byId("account_select_all_"+_27)){dj.byId("account_select_all_"+_27).set("checked",true);}}else{_2[_27]=false;}}},addProductMultiSelectItems:function(id,_2c){var _2d,_2e;if(_2c){_2d=dijit.byId("account_products_exist_nosend_"+id);_2e=dijit.byId("account_products_avail_nosend_"+id);}else{_2d=dijit.byId("account_products_avail_nosend_"+id);_2e=dijit.byId("account_products_exist_nosend_"+id);}_2d.addSelected(_2e);_2e.focus();_2d.focus();_15(id);},toggleDisplayProducts:function(id,_2f){var _30=d.byId("account_products_down_"+id);var _31=d.byId("account_products_up_"+id);if(_2f==="down"){if(d.style("account_products_div_"+id,"display")==="none"&&dj.byId("account_enabled_"+id).get("checked")){m.animate("wipeIn","account_products_div_"+id);d.style(_30,"display","none");d.style(_31,"display","inline");}}else{if(d.style("account_products_div_"+id,"display")!=="none"){m.animate("wipeOut","account_products_div_"+id);d.style(_31,"display","none");d.style(_30,"display","inline");}}}});m._config=m._config||{};d.mixin(m._config,{initReAuthParams:function(){var _32={productCode:"UAC",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:"",es_field2:""};return _32;},xmlTransform:function(xml){var _33=["<user_accounts_record>"],dom=dojox.xml.DomParser.parse(xml);_33.push(m.getDomNode(dom,"brch_code"));_33.push(m.getDomNode(dom,"company_id"));_33.push(m.getDomNode(dom,"company_abbv_name"));_33.push(m.getDomNode(dom,"login_id"));_33.push(m.getDomNode(dom,"user_id"));_33.push(_3(dom));_33.push("</user_accounts_record>");return _33.join("");}});})(dojo,dijit,misys);dojo.require("misys.client.binding.system.user_accounts_mc_client");}