/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.system.user_mc"]){dojo._hasResource["misys.binding.system.user_mc"]=true;dojo.provide("misys.binding.system.user_mc");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.validation.login");dojo.require("misys.validation.password");dojo.require("misys.form.MultiSelect");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("misys.form.CurrencyTextBox");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dojox.xml.DomParser");(function(d,dj,m){var _1="CUSTOMER_PERMISSIONS_MAINTENANCE",_2="static_user",_3="static_company";var _4=[];var _5=[];var _6=[];var _7=[];var _8=[];var _9=[];d.mixin(m._config,{initReAuthParams:function(){var _a={productCode:"UP",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:"",es_field2:""};return _a;}});function _b(_c,_d,_e,_f,_10){var _11=_c.getElementsByTagName(_d)[0],_12=_c.getElementsByTagName(_e)[0],_13="",_14="",_15=[];if(_11){_13=_11.childNodes[0];if(_13&&_13.nodeValue){_14=_13.nodeValue;}}_15.push("<group_record><group_abbv_name>",_14,"</group_abbv_name>");if(dijit.byId(_e)){if((/dijit.form.FilteringSelect/.test(dijit.byId(_e).declaredClass))||(/misys.form.SortedFilteringSelect/.test(dijit.byId(_e).declaredClass))){if("S"+dijit.byId(_e).get("value")!=="S"){_15.push("<existing_roles><role>");_15.push("<name>",dijit.byId(_e).get("value"),"</name>");if((dijit.byId(_f)&&dijit.byId(_10))){if("S"+dijit.byId(_f).get("value")!=="S"){_15.push("<limit_cur_code>",dijit.byId(_f).get("value"),"</limit_cur_code>");}if("S"+dijit.byId(_10).get("value")!=="S"&&!isNaN(dijit.byId(_10).get("value"))){_15.push("<limit_amt>",dijit.byId(_10).get("value"),"</limit_amt>");}}_15.push("</role></existing_roles>");}}else{dojo.forEach(dojo.query("option",dijit.byId(_e).domNode),function(_16){_15.push("<existing_roles><role>");_15.push("<name>",_16.value,"</name>");_15.push("</role></existing_roles>");});}}_15.push("</group_record>");return _15.join("");};function _17(_18){var _19=[];for(var i=1;i<=misys._config.entity.count;i++){var _1a=dijit.byId("default_entity").get("value"),_1b=dijit.byId("entity_id_nosend_".concat(i)).get("value");if(dijit.byId("entity_flag_nosend_"+_1b).checked){var _1c=["<entity_record>"];_1c.push("<entity_abbv_name>",dijit.byId("entity_abbv_name_nosend_"+_1b).get("value"),"</entity_abbv_name>");_1c.push("<entity_id>",_1b,"</entity_id>");if(_1a===_1b){_1c.push("<default_entity>Y</default_entity>");}else{_1c.push("<default_entity>N</default_entity>");}var _1d=dijit.byId("entity_roles_exist_nosend_"+_1b).get("value");d.forEach(_1d,function(_1e){if(_1e){_1c.push("<existing_roles><role><name>");_1c.push(_1e);_1c.push("</name></role></existing_roles>");}});_1c.push("</entity_record>");_19.push(_1c.join(""));}}return _19.join("");};function _1f(_20){var _21=[];if(misys._config.subsidiary&&misys._config.subsidiary.count>0){if(dijit.byId("entitlement_id_nosend_".concat(1))){var _22=dijit.byId("entitlement_id_nosend_".concat(1)).get("value");var _23=["<user_entities_record>"];_23.push("<entity_List_approver>");for(var j=1;j<=misys._config.subsidiary.count;j++){if(j!==misys._config.subsidiary.count){_23.push(dijit.byId("entity_name_"+_22+"_".concat(j)).get("value"),",");}else{_23.push(dijit.byId("entity_name_"+_22+"_".concat(j)).get("value"));}}_23.push("</entity_List_approver>");_23.push("</user_entities_record>");_21.push(_23.join(""));}}return _21.join("");};function _24(_25){var _26=[];if(misys._config.entitlement&&misys._config.entitlement.count>0){for(var i=1;i<=misys._config.entitlement.count;i++){if(dijit.byId("entitlement_id_nosend_".concat(i))){var _27=dijit.byId("entitlement_id_nosend_".concat(i)).get("value");if(dijit.byId("subsidiary_radio_flag_nosend_"+_27).checked){var _28=["<entitlement_record>"];_28.push("<entitlement_id>",dijit.byId("entitlement_id_nosend_".concat(i)).get("value"),"</entitlement_id>");_28.push("<entitlement_code>",dijit.byId("entitlement_code_nosend_"+_27).get("value"),"</entitlement_code>");_28.push("<entitlement_description>",dijit.byId("entitlement_name_nosend_"+_27).get("value"),"</entitlement_description>");_28.push("<subsidiaries_assigned>");var _29=dijit.byId("entitlement_subsidiary_count_"+_27+"_1").get("value");for(var j=1;j<=_29;j++){_28.push("<subsidiary>");_28.push("<subsidiary_id>",dijit.byId("subsidiary_id_nosend_"+_27+"_".concat(j)).get("value"),"</subsidiary_id>");_28.push("<subsidiary_code>",dijit.byId("subsidiary_code_nosend_"+_27+"_".concat(j)).get("value"),"</subsidiary_code>");_28.push("</subsidiary>");}_28.push("</subsidiaries_assigned>");_28.push("</entitlement_record>");_26.push(_28.join(""));}}}}return _26.join("");};function _2a(){m.checkConfirmPassword("password_value","password_confirm");};function _2b(_2c){var _2d=_2c.get("value");if(_2d===""){return true;}var _2e=_2d.split(";");var _2f=[];var j=0;for(var i=(_2e.length-1);i>=0;i--){if(!dojox.validate.isEmailAddress(_2e[i])){_2f[j]=_2e[i];j++;}}if(i>j){_2c.invalidMessage=m.getLocalization("invalidEmailAddressError");return false;}for(var k=(_2f.length-1);k>=0;k--){if(!dojox.validate.isEmailAddress(_2f[k])){_2c.invalidMessage=m.getLocalization("invalidEmailAddressError");return false;}}return true;};function _30(_31){var _32=dj.byId("phone");if(_31.items.valid===false&&_31.items.checkValidation===true){if(_32!==undefined){_32.focus();var _33=m.getLocalization("illegalCharErrorContact");_32.set("value","");_32.set("state","Error");dijit.hideTooltip(_32.domNode);dijit.showTooltip(_33,_32.domNode,0);}}else{}};function _34(_35){var _36=dj.byId("telephone_number");if(_35.items.valid===false&&_35.items.checkValidation===true){if(_36!==undefined){_36.focus();var _37=m.getLocalization("illegalCharErrorTelephoneNumber");_36.set("value","");_36.set("state","Error");dijit.hideTooltip(_36.domNode);dijit.showTooltip(_37,_36.domNode,0);}}else{}};d.mixin(m,{bind:function(){d.forEach(new Array("bank","company"),function(_38){for(var i=1;dijit.byId(_38+"_limit_cur_code_"+i);i++){m.setValidation(_38+"_limit_cur_code_"+i,m.validateCurrency);m.connect(_38+"_limit_cur_code_"+i,"onChange",function(){var _39=this.id.length;m.setCurrency(this,[_38+"_limit_amt_"+this.id.substring(_39-1,_39)]);});}});m.setValidation("base_cur_code",m.validateCurrency);m.setValidation("abbv_name",m.validateCharacters);m.connect("login_id","onChange",function(){m.checkUserExists();});m.setValidation("company_abbv_name",m.validateCharacters);m.setValidation("password_value",m.validateChangePasswordNP);m.setValidation("password_confirm",m.validateChangePasswordCP);m.setValidation("email",m.validateEmailAddr);m.connect("phone","onChange",function(){var _3a=dj.byId("phone");var _3b=_3a.get("value");if(_3b!==""){m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/ValidatePhoneNumberAction"),handleAs:"json",sync:true,content:{phone_number:_3b},load:_30});}});m.connect("telephone_number","onChange",function(){var _3c=dj.byId("telephone_number");var _3d=_3c.get("value");var _3e=dj.byId("enable_telephone_regex_validation").get("value");if(_3d!==""&&_3e==="true"){m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/ValidatePhoneNumberAction"),handleAs:"json",sync:true,content:{phone_number:_3d},load:_34});}});m.connect("fax","onBlur",function(){var _3f=dj.byId("contact_number_regex");var _40=_3f?dj.byId("contact_number_regex").get("value"):"";var _41=new RegExp(_40);var fax=dj.byId("fax");var _42=fax.get("value");if(fax&&fax.get("value")!==""&&!_41.test(_42)){var _43=m.getLocalization("illegalCharErrorContactForFax");m.dialog.show("ERROR",_43,"Fax Error",function(){fax.focus();fax.set("state","Error");dj.hideTooltip(fax.domNode);dj.showTooltip(_43,fax.domNode,0);});setTimeout(function(){dj.hideTooltip(fax.domNode);},5000);}});m.setValidation("legal_country",m.validateCountry);m.setValidation("rmGroup",m.checkRMGroupExists);m.connect("external_lob","onChange",function(){m.showRoleTemplateTable();});m.connect("employee_no","onChange",function(){m.checkEmployeeNoExists();});m.connect("email","onBlur",function(){m.checkEmailExistence();var _44=dj.byId("email");var _45=_2b(_44);if(_44&&_44.get("value")!==""&&_45===false){var _46=m.getLocalization("invalidEmailAddressError");m.dialog.show("ERROR",_46,"Email Error",function(){_44.focus();_44.set("state","Error");dj.hideTooltip(_44.domNode);dj.showTooltip(_46,_44.domNode,0);});setTimeout(function(){dj.hideTooltip(_44.domNode);},5000);}});m.connect("pending_trans_notify","onChange",function(){m.toggleEmail();});m.connect("clone_user","onChange",function(){if(d.byId("clone_user")&&d.byId("clone_user").checked){var _47=dijit.byId("company_abbv_name").get("value");var _48=dijit.byId("company_id").get("value");m.showUsersDialog("users","['clone_user']",_47,_48,"","","width:750px;height:430px;","List Of Users","");}});m.connect("password_value","onBlur",_2a);misys.connect("password_type_1","onChange",function(){if(dijit.byId("password_type_1")&&dijit.byId("password_type_1").get("checked")){dijit.byId("password_value").set("value","");dijit.byId("password_confirm").set("value","");dijit.byId("password_value").set("disabled",true);dijit.byId("password_confirm").set("disabled",true);dijit.byId("password_value").set("required",false);dijit.byId("password_confirm").set("required",false);}else{if(dijit.byId("password_type_2")&&dijit.byId("password_type_2").get("checked")){dijit.byId("password_value").set("disabled",false);dijit.byId("password_confirm").set("disabled",false);dijit.byId("password_value").set("required",true);dijit.byId("password_confirm").set("required",true);}}});if(dijit.byId("default_entity")){m.connect("default_entity","onChange",function(){var _49=dijit.byId("default_entity").get("value");for(var j=1;j<=misys._config.entity.count;j++){var _4a=dijit.byId("entity_id_nosend_".concat(j)).get("value");dijit.byId("entity_flag_nosend_"+_4a).set("readOnly",false);}if(_49!==""){dijit.byId("entity_flag_nosend_"+_49).set("checked",true);dijit.byId("entity_flag_nosend_"+_49).set("readOnly",true);var _4b=dijit.byId("entity_abbv_name_nosend_".concat(_49)).get("value");dijit.byId("default_subsidiary").set("value",_4b);}});for(var i=1;i<=misys._config.entity.count;i++){(function(_4c){var _4d=dijit.byId("entity_id_nosend_".concat(_4c)).get("value");m.setValidation("limit_cur_code_nosend_"+_4d,m.validateCurrency);m.connect("limit_cur_code_nosend_"+_4d,"onChange",function(){m.setCurrency(dijit.byId("limit_cur_code_nosend_"+_4d),["limit_amt_nosend_"+_4d]);});misys.connect("entity_flag_nosend_"+_4d,"onChange",function(){if(dijit.byId("entity_flag_nosend_"+_4d).get("checked")){m.toggleDisplayRoles(_4d,"down");}else{m.toggleDisplayRoles(_4d,"up");}});})(i);}}},showRoleTemplateTable:function(){if(dijit.byId("external_lob")&&dijit.byId("external_lob").value==="01"){if(dijit.byId("default_entity")){dijit.byId("default_entity").set("required",true);m.toggleRequired("default_entity",true);}m.animate("fadeIn",document.getElementById("list_of_role"));if(!dijit.byId("default_entity")){var _4e=m.getLocalization("mandatoryEntitySelection");_4e+=m.getLocalization("warningWithoutEntityCMSLOB");setTimeout(function(){m.dialog.show("CUSTOM-NO-CANCEL",_4e,"Info");},2000);}}else{if(dijit.byId("default_entity")){dijit.byId("default_entity").set("required",false);m.toggleRequired("default_entity",false);}m.animate("fadeOut",document.getElementById("list_of_role"));var _4f=misys._config.defaultEntityArray;var _50=dijit.byId("default_entity");if(_4f&&_9.length>0){for(var i=1;i<_4f.length;i++){if(!_9.includes(_4f[i].name)){var op=dojo.create("option");op.label=_4f[i].name;op.value=_4f[i].id;op.innerHTML=_4f[i].name;op.innerText=_4f[i].name;_50.store.root.options.add(op);}}}for(var j=1;j<=misys._config.entitlement.count;j++){if(dijit.byId("entitlement_id_nosend_".concat(j))){var _51=dijit.byId("entitlement_id_nosend_".concat(j)).get("value");if(dijit.byId("subsidiary_radio_flag_nosend_"+_51).checked===true){dijit.byId("subsidiary_radio_flag_nosend_"+_51).set("checked",false);}}}}},toggleDisplayRoles:function(_52,_53){var _54=d.byId("entity_roles_down_"+_52);var _55=d.byId("entity_roles_up_"+_52);if(_53==="down"){if(d.style("entity_roles_div_"+_52,"display")==="none"&&m._config.displayMode==="view"){m.animate("wipeIn","entity_roles_div_"+_52);d.style(_54,"display","none");d.style(_55,"display","inline");}else{if(d.style("entity_roles_div_"+_52,"display")==="none"&&dj.byId("entity_flag_nosend_"+_52).get("checked")){m.animate("wipeIn","entity_roles_div_"+_52);d.style(_54,"display","none");d.style(_55,"display","inline");}}}else{if(d.style("entity_roles_div_"+_52,"display")!=="none"){m.animate("wipeOut","entity_roles_div_"+_52);d.style(_55,"display","none");d.style(_54,"display","inline");}}},toggleDisplaySubsidiaries:function(_56,_57,_58){var _59;var _5a;if(_58!==undefined&&_58.length>0){_59=_58.substring(1,_58.length-1);}var _5b=new Array();if(_59){_5b=_59.split(",");for(var i=0;i<_5b.length;i++){if(_57){m.animate("wipeIn","userSubsidiaryTable_"+_56);if(_5b[i].trim()!==""&&_5b[i].trim()!==undefined){if(dijit.byId("subsidiary_flag_nosend_".concat(_5b[i].trim()))){dijit.byId("subsidiary_flag_nosend_".concat(_5b[i].trim())).set("checked",true);dijit.byId("subsidiary_radio_flag_nosend_".concat(_5b[i].trim())).set("checked",true);_5a=dijit.byId("subsidiary_code_nosend_".concat(_5b[i].trim())).get("value");if(_5a===dijit.byId("default_subsidiary").get("value")){dijit.byId("default_subsidiary").set("value",_5a);}}}}else{m.animate("wipeOut","userSubsidiaryTable_"+_56);if(_5b[i]!==""&&_5b[i]!==undefined){dijit.byId("subsidiary_flag_nosend_".concat(_5b[i].trim())).set("checked",false);dijit.byId("subsidiary_radio_flag_nosend_".concat(_5b[i].trim())).set("checked",false);dijit.byId("default_subsidiary").set("value","");}}}}else{if(_57){m.animate("wipeIn","userSubsidiaryTable_"+_56);if(_59!==""&&_59!==undefined){if(dijit.byId("subsidiary_flag_nosend_".concat(_59))){dijit.byId("subsidiary_flag_nosend_".concat(_59)).set("checked",true);dijit.byId("subsidiary_radio_flag_nosend_".concat(_59)).set("checked",true);_5a=dijit.byId("subsidiary_code_nosend_".concat(_59)).get("value");if(_5a===dijit.byId("default_subsidiary").get("value")){dijit.byId("default_subsidiary").set("value",_5a);}}}}else{m.animate("wipeOut","userSubsidiaryTable_"+_56);if(_59!==""&&_59!==undefined){dijit.byId("subsidiary_flag_nosend_".concat(_59)).set("checked",false);dijit.byId("subsidiary_radio_flag_nosend_".concat(_59)).set("checked",false);dijit.byId("default_subsidiary").set("value","");}}}},selectSubsidiary:function(_5c){var _5d=_5c.substring(1,_5c.length-1);if(dijit.byId("subsidiary_flag_nosend_".concat(_5d))){var _5e=dijit.byId("subsidiary_id_nosend_".concat(_5d)).get("value");var _5f="subsidiary_flag_nosend_".concat(_5d);var _60=dijit.byId("subsidiary_code_nosend_".concat(_5e)).get("value");var _61;var _62;var _63;if(dijit.byId("subsidiary_code").get("value")===_60){dijit.byId(_5f).set("checked",true);_61=_5f;_62=_60;_63=_5e;m.toggleRadioSubsidiary(_5d,_62);}}},toggleCheckBoxEntitlement:function(_64,_65,_66,_67,_68){var _69=_4.length;var _6a=[];var _6b=false;for(var k=0;k<_69;k++){var _6c=dijit.byId(_4[k]).get("checked");_6a.push(_6c);}if(_6a.includes(true)){_6b=true;}for(var i=0;i<_69;i++){var _6d=dijit.byId(_4[i]).get("checked");if(_4[i]===_64&&_6d){dijit.byId(_4[i]).set("checked",true);dijit.byId("entitlement_code").set("value",_65);if(_67){m.toggleDisplaySubsidiaries(_66,true,_68);}}else{if(!_6d&&!_6b){dijit.byId(_4[i]).set("disabled",false);dijit.byId(_4[i]).set("checked",false);if(_67){m.toggleDisplaySubsidiaries(_66,false,_68);}}else{dijit.byId(_4[i]).set("disabled",true);dijit.byId(_4[i]).set("checked",false);}}}},toggleCheckBoxSubsidiary:function(_6e,_6f,_70,_71){if(_6e!==undefined){dijit.byId("subsidiary_id").set("value",_6e);_5.push(_6e);}if(_6f!==undefined){dijit.byId("subsidiary_code").set("value",_6f);_6.push(_6f);}if(_71!==undefined){dijit.byId("entitlement_id").set("value",_71);}if(_70!==undefined){dijit.byId("entitlement_code").set("value",_70);}},toggleRadioSubsidiary:function(_72,_73){if(_73!==undefined){dijit.byId("default_role_template").set("value",_73);dijit.byId("subsidiary_radio_flag_nosend_".concat(_72)).set("checked",true);_6.length=0;_7.length=0;_8.length=0;_5.length=0;_9=[];_9.length=0;if(dijit.byId("default_entity")){var _74=dijit.byId("default_entity").get("value");}var _75=false;var _76=dijit.byId("entitlement_subsidiary_count_"+_72+"_1").get("value");for(var i=1;i<=_76;i++){var _77=dijit.byId("subsidiary_code_fcm_nosend_"+_72+"_".concat(i)).get("value");var _78=dijit.byId("subsidiary_id_nosend_"+_72+"_".concat(i)).get("value");var _79=dijit.byId("entity_name_"+_72+"_".concat(i)).get("value");_6.push(_77);_7.push(_79);_5.push(_78);_9.push(_79);if(_74!==""){if(dijit.byId("default_entity")&&(_79===dijit.byId("entity_name_nosend_".concat(_74)).get("value"))){_75=true;}}for(var x=1;x<=misys._config.entity.count;x++){var _7a=dijit.byId("entity_id_nosend_".concat(x)).get("value");var _7b=dijit.byId("entity_name_nosend_".concat(_7a)).get("value");if(_79===_7b){var _7c=dijit.byId("entity_abbv_name_nosend_".concat(_7a)).get("value");_8.push(_7c);}}}if(_6.length>0){dijit.byId("entitlement_id").set("value",_72);dijit.byId("entitlement_code").set("value",_73);dijit.byId("subsidiary_code_List").set("value",_6);}if(_7.length>0){dijit.byId("entity_List").set("value",_7);}if(_8.length>0){dijit.byId("entity_abbv_List").set("value",_8);}if(_5.length>0){dijit.byId("entitlement_id").set("value",_72);dijit.byId("entitlement_code").set("value",_73);dijit.byId("subsidiary_id_List").set("value",_5);}var _7d=misys._config.defaultEntityArray;var _7e=dijit.byId("default_entity");if(_7d&&_9.length>0){for(var j=1;j<=misys._config.entity.count;j++){var _7f=dijit.byId("entity_id_nosend_".concat(j)).get("value");dijit.byId("entity_flag_nosend_"+_7f).set("readOnly",false);}if(!_75){dijit.byId("default_entity").set("value","");}_7e.store.root.options.length=0;for(var k=1;k<_7d.length;k++){if(_9.includes(_7d[k].name)){var op=dojo.create("option");op.label=_7d[k].name;op.value=_7d[k].id;op.innerHTML=_7d[k].name;op.innerText=_7d[k].name;_7e.store.root.options.add(op);}}}}},toggleAuthLevelSection:function(_80,dir){var _81=d.byId("auth_list_down_"+_80);var _82=d.byId("auth_list_up_"+_80);if(dir==="down"){if(d.style("grp_rec_"+_80,"display")==="none"){misys.animate("wipeIn","grp_rec_"+_80);d.style(_81,"display","none");d.style(_82,"display","inline");}}else{if(dir==="up"){if(d.style("grp_rec_"+_80,"display")!=="none"){misys.animate("wipeOut","grp_rec_"+_80);d.style(_82,"display","none");d.style(_81,"display","inline");}}}},addEntityMultiSelectItems:function(_83,_84,_85,_86){var _87=dijit.byId(_83),_88=dijit.byId(_84);_87.addSelected(_88);_88.focus();_87.focus();_85.innerHTML=_86.get("value").length+" "+misys.getLocalization("Role(s)");},toggleEmail:function(){var _89=dj.byId("pending_trans_notify");var _8a=dj.byId("email_mandatory");if(_8a&&_8a.get("value")==="false"){if(_89&&_89.get("checked")){m.toggleRequired("email",true);}else{m.toggleRequired("email",false);}}else{if(_8a&&_8a.get("value")==="true"){m.toggleRequired("email",true);}}},onFormLoad:function(){d.forEach(new Array("bank","company"),function(_8b){for(var i=1;dijit.byId(_8b+"_limit_cur_code_"+i);i++){m.setCurrency(dijit.byId(_8b+"_limit_cur_code_"+i),[_8b+"_limit_amt_"+i]);}});if(dijit.byId("password_type_1")&&dijit.byId("password_type_1").get("checked")){dijit.byId("password_value").set("value","");dijit.byId("password_confirm").set("value","");dijit.byId("password_value").set("disabled",true);dijit.byId("password_confirm").set("disabled",true);dijit.byId("password_value").set("required",false);dijit.byId("password_confirm").set("required",false);}else{if(dijit.byId("password_type_2")&&dijit.byId("password_type_2").get("checked")){dijit.byId("password_value").set("disabled",false);dijit.byId("password_confirm").set("disabled",false);dijit.byId("password_value").set("required",true);dijit.byId("password_confirm").set("required",true);}}if(dijit.byId("default_entity")){var _8c=dijit.byId("default_entity").get("value");if(_8c!==""){dijit.byId("entity_flag_nosend_"+_8c).set("checked",true);dijit.byId("entity_flag_nosend_"+_8c).set("readOnly",true);}if(dijit.byId("external_lob")&&(dijit.byId("external_lob").value==="01")){if(dijit.byId("default_entity")){dijit.byId("default_entity").set("required",true);m.toggleRequired("default_entity",true);}}for(var k=1;k<=misys._config.entity.count;k++){var _8d=dijit.byId("entity_id_nosend_".concat(k)).get("value");dojo.byId("entity_roles_indicator_".concat(k)).innerHTML=dijit.byId("entity_roles_exist_nosend_".concat(_8d)).get("value").length+" "+misys.getLocalization("Role(s)");if(dijit.byId("enity_flag_"+_8d).get("value")==="Y"){dijit.byId("entity_flag_nosend_"+_8d).set("checked",true);}}}if(dijit.byId("default_role_template")&&dijit.byId("default_role_template").get("value")!==""){var _8e=dijit.byId("default_role_template").get("value");for(var x=1;x<=misys._config.entitlement.count;x++){if(dijit.byId("entitlement_id_nosend_".concat(x))){var _8f=dijit.byId("entitlement_id_nosend_".concat(x)).get("value");var _90=dijit.byId("entitlement_code_nosend_".concat(_8f)).get("value");if(_8e===_90){dijit.byId("subsidiary_radio_flag_nosend_".concat(_8f)).set("checked",true);_6.length=0;_7.length=0;_8.length=0;_5.length=0;var _91=dijit.byId("entitlement_subsidiary_count_"+_8f+"_1").get("value");for(var j=1;j<=_91;j++){var _92=dijit.byId("subsidiary_code_fcm_nosend_"+_8f+"_".concat(j)).get("value");var _93=dijit.byId("subsidiary_id_nosend_"+_8f+"_".concat(j)).get("value");var _94=dijit.byId("entity_name_"+_8f+"_".concat(j)).get("value");_6.push(_92);_7.push(_94);_5.push(_93);for(var y=1;y<=misys._config.entity.count;y++){var _95=dijit.byId("entity_id_nosend_".concat(y)).get("value");var _96=dijit.byId("entity_name_nosend_".concat(_95)).get("value");if(_94===_96){var _97=dijit.byId("entity_abbv_name_nosend_".concat(_95)).get("value");_8.push(_97);}}}if(_6.length>0){dijit.byId("subsidiary_code_List").set("value",_6);}if(_7.length>0){dijit.byId("entity_List").set("value",_7);}if(_8.length>0){dijit.byId("entity_abbv_List").set("value",_8);}if(_5.length>0){dijit.byId("subsidiary_id_List").set("value",_5);}}}}}if(dijit.byId("external_lob")&&(dijit.byId("external_lob").value===""||dijit.byId("external_lob").value==="None")){m.animate("fadeOut",document.getElementById("list_of_role"));if(dijit.byId("default_entity")){dijit.byId("default_entity").set("required",false);m.toggleRequired("default_entity",false);}for(var i=1;i<=misys._config.entitlement.count;i++){if(dijit.byId("entitlement_id_nosend_".concat(i))){var _98=dijit.byId("entitlement_id_nosend_".concat(i)).get("value");if(dijit.byId("subsidiary_radio_flag_nosend_"+_98)&&dijit.byId("subsidiary_radio_flag_nosend_"+_98).checked===true){dijit.byId("subsidiary_radio_flag_nosend_"+_98).set("checked",false);}}}}else{if(dijit.byId("external_lob")&&(dijit.byId("external_lob").value==="01")){if(dijit.byId("default_entity")){dijit.byId("default_entity").set("required",true);m.toggleRequired("default_entity",true);}}}m.toggleEmail();},beforeSaveValidations:function(){if(dj.byId("clientSideEncryption")){try{if(dijit.byId("password_value")){dijit.byId("password_value").set("value",misys.encrypt(dijit.byId("password_value").get("value")));}if(dijit.byId("password_confirm")){dijit.byId("password_confirm").set("value",misys.encrypt(dijit.byId("password_confirm").get("value")));}return true;}catch(error){misys.dialog.show("ERROR",misys.getLocalization("passwordNotEncrypted"),"",function(){});return false;}}if(dijit.byId("login_id")){var _99=dijit.byId("login_id").get("value");if(!(_99.length>0)){m._config.onSubmitErrorMsg=m.getLocalization("userLoginIdEmptyError");dijit.byId("login_id").focus();return false;}else{return true;}}else{return true;}},beforeSubmitValidations:function(){if(dj.byId("clientSideEncryption")){misys.encryptBeforeSubmit();}var _9a=true;if(dj.byId("company_limit_amt_1")&&!isNaN(dj.byId("company_limit_amt_1").get("value"))){if(dj.byId("company_auth_level_1")&&dj.byId("company_auth_level_1").get("value")===""){m._config.onSubmitErrorMsg=m.getLocalization("Authorizationlevelrequriederror");_9a=false;}}if(dj.byId("legal_country")&&dj.byId("legal_no")&&dj.byId("legal_type")){if(dj.byId("legal_country").get("value")!==""){if(dj.byId("legal_no").get("value")===""||dj.byId("legal_type").get("value")===""){m._config.onSubmitErrorMsg=m.getLocalization("invalidIdNoFieldError");_9a=false;}}if(dj.byId("legal_no").get("value")!==""){if(dj.byId("legal_country").get("value")===""||dj.byId("legal_type").get("value")===""){m._config.onSubmitErrorMsg=m.getLocalization("invalidIdNoFieldError");_9a=false;}}if(dj.byId("legal_type").get("value")!==""){if(dj.byId("legal_country").get("value")===""||dj.byId("legal_type").get("value")===""){m._config.onSubmitErrorMsg=m.getLocalization("invalidIdNoFieldError");_9a=false;}}}if(dijit.byId("external_lob")&&dijit.byId("external_lob").value==="01"){var _9b=false;var _9c=false;for(var k=1;k<=misys._config.entitlement.count;k++){if(dijit.byId("entitlement_id_nosend_".concat(k))){var _9d=dijit.byId("entitlement_id_nosend_".concat(k)).get("value");var _9e=dijit.byId("entitlement_valid_flag_nosend_"+_9d).get("value");if(_9e==="Y"&&dijit.byId("subsidiary_radio_flag_nosend_"+_9d).checked===true){_9b=true;if(dijit.byId("default_entity")){var _9f=false;var _a0=[];var _a1=dijit.byId("entitlement_subsidiary_count_"+_9d+"_1").get("value");var _a2=m.getLocalization("cashFcmEntityRole");for(var j=1;j<=_a1;j++){var _a3=dijit.byId("subsidiary_code_nosend_"+_9d+"_".concat(j)).get("value");if(j===1){for(var x=1;x<=misys._config.entity.count;x++){var _a4=dijit.byId("entity_id_nosend_".concat(x)).get("value");var _a5=dijit.byId("entity_name_nosend_".concat(_a4)).get("value");if(_a3!==_a5&&dijit.byId("entity_roles_exist_nosend_".concat(_a4))){var _a6=dijit.byId("entity_roles_exist_nosend_".concat(_a4)).domNode.options;for(var y=0;y<_a6.length;y++){if(_a6[y].value===_a2){_a0.push(_a5);_9f=true;}}}}}else{if(_a0.includes(_a3)){_a0.splice(_a0.indexOf(_a3),1);}}var _a7=dijit.byId("default_entity").get("value");var _a8=dijit.byId("entity_name_nosend_".concat(_a7)).get("value");if(_a3===_a8){var _a9=dijit.byId("subsidiary_code_fcm_nosend_"+_9d+"_".concat(j)).get("value");dijit.byId("default_subsidiary").set("value",_a9);}}if(_a0.length===0){_9f=false;}}}if(dijit.byId("entitlement_valid_flag_nosend_"+_9d)&&_9e==="Y"){_9c=true;}if(_9f===true&&_9c===true){var _aa=m.getLocalization("entitiesNotLinkedToRoleTemplate");_aa+=m.getLocalization("mandatoryAddCMSRole",[_a0]);m._config.onSubmitErrorMsg=_aa;_9a=false;}}}if(_9b===false&&_9c===true){m._config.onSubmitErrorMsg=m.getLocalization("mandatoryRoleTemplate");_9a=false;}}return _9a;},beforeSubmitEncryption:function(){if(dj.byId("clientSideEncryption")){try{if(dijit.byId("password_value")){dijit.byId("password_value").set("value",misys.encrypt(dijit.byId("password_value").get("value")));}if(dijit.byId("password_confirm")){dijit.byId("password_confirm").set("value",misys.encrypt(dijit.byId("password_confirm").get("value")));}return true;}catch(error){misys.dialog.show("ERROR",misys.getLocalization("passwordNotEncrypted"),"",function(){});return false;}}}});m._config=m._config||{};d.mixin(m._config,{initReAuthParams:function(){var _ab={productCode:"UP",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:"",es_field2:""};return _ab;},xmlTransform:function(xml){var _ac=new Array("bank_auth_level","company_auth_level"),_ad=new Array("company_role_list","bank_role_list"),_ae="static_user_info",_af="",_b0=m._config.xmlTagName,_b1=_b0?["<",_b0,">"]:[],_b2=dj.byId("option").get("value"),_b3=_b2===_1?_3:_2,_b4="user_entity_record",dom=dojox.xml.DomParser.parse(xml);_b1.push("<",_ae,">");var _b5=xml.substring(_b0.length+2,(xml.length-_b0.length-3));_b1.push(_b5);_b1.push("</",_ae,">");d.forEach(_ac,function(_b6){for(var i=1;dom.getElementsByTagName(_b6+"_"+i).length>0;i++){_af="bank";if(_b6.indexOf("bank")===-1){_af="company";}_b1.push(_b(dom,_af+"_auth_abbv_name_"+i,_b6+"_"+i,_af+"_limit_cur_code_"+i,_af+"_limit_amt_"+i));}});d.forEach(_ad,function(id){if(dom.getElementsByTagName(id).length>0){var _b7="bank";if(id.indexOf("bank")===-1){_b7="company";}_b1.push(_b(dom,_b7+"_group_abbv_name",id));}});if(dj.byId("default_entity")){_b1.push("<user_entities_record>");_b1.push(m.getDomNode(dom,"brch_code"));_b1.push(m.getDomNode(dom,"company_id"));_b1.push(m.getDomNode(dom,"company_abbv_name"));_b1.push(m.getDomNode(dom,"login_id"));_b1.push(m.getDomNode(dom,"user_id"));_b1.push(_17(m.getDomNode(dom,"user_id")));_b1.push("</user_entities_record>");}if(dj.byId("default_entity")===undefined&&dijit.byId("default_role_template")){_b1.push(_1f(m.getDomNode(dom,"user_id")));}if(_b0){_b1.push("</",_b0,">");}return _b1.join("");}});})(dojo,dijit,misys);dojo.require("misys.client.binding.system.user_mc_client");}