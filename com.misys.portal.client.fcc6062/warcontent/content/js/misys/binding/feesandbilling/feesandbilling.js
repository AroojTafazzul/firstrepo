/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.feesandbilling.feesandbilling"]){dojo._hasResource["misys.binding.feesandbilling.feesandbilling"]=true;dojo.provide("misys.binding.feesandbilling.feesandbilling");dojo.require("misys.validation.common");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.Select");dojo.require("misys.form.common");dojo.require("misys.widget.Dialog");dojo.require("dijit.form.ValidationTextBox");dojo.require("misys.form.CurrencyTextBox");(function(d,dj,m){function _1(){var _2=null;var _3=null;if(dj.byId("bank")){_3=dj.byId("bank");}if(dj.byId("entity")&&dj.byId("entity").get("value")!==""){_2=dj.byId("entity").get("value");if("*"===_2){_2="wildCard";}}else{if(dj.byId("entity")&&dj.byId("entity").get("value")===""){_2="wildCard";}else{_2="All";}}if(misys._config.entityBanksMap){var _4=null;_4=m._config.entityBanksMap[_2];if(_4){_3.store=new dojo.data.ItemFileReadStore({data:{identifier:"value",label:"name",items:_4}});_3.fetchProperties={sort:[{attribute:"name"}]};}else{_3.store=null;}}};function _5(){var _6=null;var _7=null;var _8="";if(dj.byId("customerId")){_7=dj.byId("customerId");}if(dj.byId("cust_ref_id")){_7=dj.byId("cust_ref_id");}if(dj.byId("entity")&&dj.byId("entity").get("value")===""){_6="wildCard";}if(dj.byId("entity")&&dj.byId("entity").get("value")!==""){_6=dj.byId("entity").get("value");if("*"===_6){_6="wildCard";}}if(dj.byId("bank")){if(dj.byId("bank").get("value")!==""){_8=dj.byId("bank").get("value");}}else{if(dj.byId("bank_abbv_name")&&dj.byId("bank_abbv_name").get("value")!==""){_8=dj.byId("bank_abbv_name").get("value");}}if(_8!==""&&misys._config.entityBanksRefJson){var _9=null;if(null===_6){_9=m._config.entityBanksRefJson[_8];}else{_9=m._config.entityBanksRefJson[_6+"_"+_8];}if(_9){_7.store=new dojo.data.ItemFileReadStore({data:{identifier:"value",label:"name",items:_9}});_7.fetchProperties={sort:[{attribute:"name"}]};}else{_7.store=null;}}};function _a(){if(dj.byId("bank")&&dj.byId("bank").get("value")!==""){dj.byId("bank").set("value","");}_1();if(dj.byId("customerId")&&dj.byId("customerId").get("value")!==""){dj.byId("customerId").set("value","");}if(dj.byId("cust_ref_id")&&dj.byId("cust_ref_id").get("value")!==""){dj.byId("cust_ref_id").set("value","");}_5();};function _b(){if(dj.byId("customerId")){dj.byId("customerId").set("value","");}if(dj.byId("cust_ref_id")){dj.byId("cust_ref_id").set("value","");}_5();};function _c(){var _d=this;if(_d.get("value")===null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _e=dj.byId("create_date2");if(!m._config.effToDateValidationInprocess&&!m.compareDateFields(_d,_e)){m._config.effFromDateValidationInprocess=true;var _f=dj.byId("create_date");displayMessage=misys.getLocalization("TransactionDateFromLesserThanTransactionDateTo");_f.set("state","Error");dj.hideTooltip(_f.domNode);dj.showTooltip(displayMessage,_f.domNode,0);return false;}m._config.effFromDateValidationInprocess=false;return true;};function _10(){var _11=this;m._config=m._config||{};m._config.effToDateValidationInprocess=false;if(_11.get("value")===null){return true;}var _12=dj.byId("create_date");if(!m._config.effFromDateValidationInprocess){m._config.effToDateValidationInprocess=true;if(!m.compareDateFields(_12,_11)){var _13=dj.byId("create_date2");displayMessage=misys.getLocalization("TransactionDateToGreaterThanTransactionDateFrom");_13.set("state","Error");dj.hideTooltip(_13.domNode);dj.showTooltip(displayMessage,_13.domNode,0);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _14(){var _15=this;if(_15.get("value")===null){return true;}m._config=m._config||{};m._config.effFromDateValidationInprocess=false;var _16=dj.byId("inv_due_date2");if(!m._config.effToDateValidationInprocess&&!m.compareDateFields(_15,_16)){m._config.effFromDateValidationInprocess=true;var _17=dj.byId("inv_due_date");displayMessage=misys.getLocalization("TransactionDateFromLesserThanTransactionDateTo");_17.set("state","Error");dj.hideTooltip(_17.domNode);dj.showTooltip(displayMessage,_17.domNode,0);}m._config.effFromDateValidationInprocess=false;return true;};function _18(){var _19=this;m._config=m._config||{};m._config.effToDateValidationInprocess=false;if(_19.get("value")===null){return true;}var _1a=dj.byId("inv_due_date");if(!m._config.effFromDateValidationInprocess){m._config.effToDateValidationInprocess=true;if(!m.compareDateFields(_1a,_19)){var _1b=dj.byId("inv_due_date2");displayMessage=misys.getLocalization("DueDateToGreaterThanDueDateFrom");_1b.set("state","Error");dj.hideTooltip(_1b.domNode);dj.showTooltip(displayMessage,_1b.domNode,0);return false;}}m._config.effToDateValidationInprocess=false;return true;};function _1c(){var _1d=this.get("value"),_1e=this;m._config=m._config||{};m._config.effFromAmountValidationInprocess=false;var _1f=dj.byId("AmountRange2visible").get("value");if(!m._config.effToAmountValidationInprocess&&(_1d<0||_1d>_1f)){m._config.effFromAmountValidationInprocess=true;var _20=dj.byId("AmountRangevisible");if(_1d>_1f){displayMessage=misys.getLocalization("invalidMinAmountValueError");}if(_1d<0){displayMessage=misys.getLocalization("invalidAmountValueError");}_20.set("state","Error");dj.hideTooltip(_20.domNode);dj.showTooltip(displayMessage,_20.domNode,0);return false;}m._config.effFromAmountValidationInprocess=false;return true;};function _21(){if(dj.byId("AmountRangevisible")){var _22=dj.byId("AmountRangevisible").value;var _23=isNaN(_22)?0:_22;dj.byId("AmountRange").set("value",_22);var _24=dj.byId("AmountRange2visible").value;dj.byId("AmountRange2").set("value",_24);}};function _25(){var _26=this.get("value"),_27=this;m._config=m._config||{};m._config.effToAmountValidationInprocess=false;var _28=dj.byId("AmountRangevisible").get("value");if(!m._config.effFromAmountValidationInprocess&&(_26<0||_26<_28)){m._config.effToAmountValidationInprocess=true;var _29=dj.byId("AmountRange2visible");if(_26<_28){displayMessage=misys.getLocalization("invalidMaxAmountValueError");}if(_26<0){displayMessage=misys.getLocalization("invalidAmountValueError");}_29.set("state","Error");dj.hideTooltip(_29.domNode);dj.showTooltip(displayMessage,_29.domNode,0);return false;}m._config.effToAmountValidationInprocess=false;return true;};function _2a(_2b){m._config=m._config||{};m._config.fieldValidationinProcess=false;var _2c=dj.byId(_2b)?dj.byId(_2b).get("value"):"";if(_2c.length===0||!_2c.trim()){m._config.fieldValidationinProcess=true;var id=dj.byId(_2b);var _2d=misys.getLocalization("mandatoryFieldIsRequired");id.focus();id.set("state","Error");dj.hideTooltip(id.domNode);dj.showTooltip(_2d,id.domNode,0);return false;}m._config.fieldValidationinProcess=false;return true;};d.mixin(m,{bind:function(){m.setValidation("feeCcy",m.validateCurrency);m.connect("entity","onChange",_a);_1();m.connect("bank","onChange",_b);m.connect("create_date","onBlur",_c);m.connect("create_date2","onBlur",_10);m.connect("inv_due_date","onBlur",_14);m.connect("inv_due_date2","onBlur",_18);m.connect("AmountRangevisible","onBlur",_1c);m.connect("AmountRange2visible","onBlur",_25);m.toggleRequired("bank",true);m.toggleRequired("customerId",true);m.connect("submitButton","onClick",function(){m._config.fieldValidationinProcess=false;if(dj.byId("bank")&&!m._config.fieldValidationinProcess){_2a("bank");}if(dj.byId("customerId")&&!m._config.fieldValidationinProcess){_2a("customerId");}_21();});m.connect("dijit_form_DropDownButton_1_label","onClick",function(){if(dj.byId("customerId")&&""===dj.byId("customerId").get("value")){_2a("customerId");}});},onFormLoad:function(){var _2e=dj.byId("bank");var _2f=dj.byId("bank_abbv_name");if((_2e&&_2e.get("value")!=="")||(_2f&&_2f.get("value")!=="")){_5();}if(_2e&&_2e.get("value")===""){_1();}}});})(dojo,dijit,misys);dojo.require("misys.client.binding.feesandbilling.feesandbilling_client");}