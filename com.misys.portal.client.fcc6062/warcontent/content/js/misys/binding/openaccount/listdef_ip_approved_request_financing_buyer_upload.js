/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.openaccount.listdef_ip_approved_request_financing_buyer_upload"]){dojo._hasResource["misys.binding.openaccount.listdef_ip_approved_request_financing_buyer_upload"]=true;dojo.provide("misys.binding.openaccount.listdef_ip_approved_request_financing_buyer_upload");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojo.data.ItemFileWriteStore");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.MultiSelect");dojo.require("dijit.layout.TabContainer");dojo.require("misys.form.common");dojo.require("misys.openaccount.StringUtils");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.form.CurrencyTextBox");(function(d,dj,m){d.subscribe("ready",function(){m._config=(m._config)||{};m._config.cellNodeReference;d.query(".dojoxGrid").forEach(function(_1){if(_1.id!=="nonSignedFolders"){m.connect(_1.id,"onRowMouseOver",m._config.mouseOverShowTermsAndConditions);m.connect(_1.id,"onRowMouseOut",m._config.mouseOutHideTermsAndConditions);m.connect(dj.byId(_1.id).selection,"onSelected",m._config.showTermsAndConditions);m.connect(dj.byId(_1.id).selection,"onDeselected",m._config.hideTermsAndConditions);m.connect(_1.id,"onRowClick",m._config.storeCellNodeReference);m.connect(_1.id,"onHeaderCellClick",function(_2){if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode){dj.hideTooltip(m._config.cellNodeReference.cellNode);m._config.cellNodeReference.cellNode=null;}});}});});d.mixin(m,{bind:function(){m.connect("AmountRangevisible","onBlur",_3);m.connect("AmountRange2visible","onBlur",_3);m.connect("iss_date","onBlur",_4);m.connect("iss_date2","onBlur",_5);m.connect("due_date","onBlur",_6);m.connect("due_date2","onBlur",_7);m.setValidation("cur_code",m.validateCurrency);m.connect("cur_code","onChange",_8);m.connect("cur_code","onChange",function(){misys.setCurrency(this,["AmountRange","AmountRange2"]);});m.connect("submitButton","onClick",_9);},onFormLoad:function(){if(dijit.byId("eligibility_flag")){dijit.byId("eligibility_flag").set("value","E");}}});d.mixin(m._config,{submitOpenAccount:function(_a,_b){var _c=[],_d="",_e="",_f="";if(dj.byId("nonSignedFolders")){if(dijit.byId("nonSignedFolders").selection.selectedIndex!==-1){if(dj.byId("referenceid")){_d=dj.byId("referenceid").get("value");}if(dj.byId("tnxid")){_f=dj.byId("tnxid").get("value");}}}_e=dj.byId("base_ccy").get("value");d.query(".dojoxGrid").forEach(function(g){_c.push(dj.byId(g.id));});var _10=d.isArray(_c)?_c:[_c],_11=d.byId("batchContainer"),_12=[],_13="",_14=0,_15,_16;d.forEach(_10,function(_17){cache=_17.selection.preserver._selectedById;for(var i in cache){if(cache[i]){_15=i;if(_15!=="undefined"){if(_13!==""){_13+=", ";}_13+=_15;_14++;}}}});if(_13===""){m.dialog.show("ERROR",m.getLocalization("noTransactionsSelectedError"));}else{var URL=window.location.pathname;m.post({action:URL,params:[{name:"list_keys",value:_13},{name:"programcode",value:"06"},{name:"base_ccy",value:_e},{name:"operation",value:"MULTI_LIST"}]});}},showTermsAndConditions:function(_18){var _19;if(this.grid.store._items[_18]&&this.grid.store._items[_18].i){_19=this.grid.store._items[_18].i["Counterparty@ObjectDataClob@conditions_06"];_19=m.replaceCarriageReturn(_19,"<br>");}if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode&&m._config.cellNodeReference.cellIndex===0){dj.hideTooltip(m._config.cellNodeReference.cellNode);dj.showTooltip(_19,m._config.cellNodeReference.cellNode,0);}},mouseOverShowTermsAndConditions:function(evt){if(this.selection.selected[evt.rowIndex]&&this.selection.selected[evt.rowIndex]===true&&evt.cellIndex===0){var _1a;_1a=this.store._items[evt.rowIndex].i["Counterparty@ObjectDataClob@conditions_06"];_1a=m.replaceCarriageReturn(_1a,"<br>");dj.showTooltip(_1a,evt.cellNode,0);}},mouseOutHideTermsAndConditions:function(evt){dj.hideTooltip(evt.cellNode);},storeCellNodeReference:function(evt){m._config.cellNodeReference=evt;},hideTermsAndConditions:function(evt){if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode){dj.hideTooltip(m._config.cellNodeReference.cellNode);}}});function _8(){if(dj.byId("cur_code").value!==""){dj.byId("AmountRangevisible").set("disabled",false);dj.byId("AmountRange2visible").set("disabled",false);}else{if(dj.byId("cur_code").value===""){dj.byId("AmountRangevisible").set("disabled",true);dj.byId("AmountRange2visible").set("disabled",true);dj.byId("AmountRangevisible").reset();dj.byId("AmountRange2visible").reset();}}};function _9(){if(dj.byId("AmountRangevisible")){var _1b=dj.byId("AmountRangevisible").value;var _1c=isNaN(_1b)?0:_1b;dj.byId("AmountRange").set("value",_1b);var _1d=dj.byId("AmountRange2visible").value;dj.byId("AmountRange2").set("value",_1d);}};function _3(){var _1e=this.get("value");var _1f=dj.byId("AmountRange2visible").get("value");var _20=dj.byId("AmountRangevisible").get("value");var _21=false;var _22=dj.byId("AmountRangevisible");var _23=dj.byId("AmountRange2visible");if(_20>_1f){var _24=misys.getLocalization("invalidMaxAmountValueError");_21=true;}else{if(_1f<0){_24=misys.getLocalization("invalidAmountValueError");_21=true;}else{if(_20<0){_24=misys.getLocalization("invalidAmountValueError");_22.focus();_22.set("state","Error");dj.hideTooltip(_22.domNode);dj.showTooltip(_24,_22.domNode,0);dj.showTooltip(_24,domNode,0);return false;}}}if(_21){_23.focus();_23.set("state","Error");dj.hideTooltip(_23.domNode);dj.showTooltip(_24,_23.domNode,0);dj.showTooltip(_24,domNode,0);return false;}return true;};function _4(){if(this.get("value")===null){return true;}var _25=dj.byId("iss_date2");if(!m.compareDateFields(this,_25)){var _26=dj.byId("iss_date");displayMessage=misys.getLocalization("InvoiceIssueDateFromLesserThanInvoiceIssueDateTo");_26.focus();_26.set("state","Error");dj.hideTooltip(_26.domNode);dj.showTooltip(displayMessage,_26.domNode,0);}return true;};function _5(){if(this.get("value")===null){return true;}var _27=dj.byId("iss_date");if(!m.compareDateFields(_27,this)){var _28=dj.byId("iss_date2");displayMessage=misys.getLocalization("InvoiceIssueDateToGreaterThanInvoiceIssueDateFrom");_28.focus();_28.set("state","Error");dj.hideTooltip(_28.domNode);dj.showTooltip(displayMessage,_28.domNode,0);return false;}return true;};function _6(){if(this.get("value")===null){return true;}var _29=dj.byId("due_date2");if(!m.compareDateFields(this,_29)){var _2a=dj.byId("due_date"),_2b=misys.getLocalization("InvoiceDueDateFromGreaterThanInvoiceDueDateTo");_2a.focus();_2a.set("state","Error");dj.hideTooltip(_2a.domNode);dj.showTooltip(_2b,_2a.domNode,0);dj.showTooltip(_2b,domNode,0);return false;}return true;};function _7(){if(this.get("value")===null){return true;}var _2c=dj.byId("due_date");if(!m.compareDateFields(_2c,this)){var _2d=dj.byId("due_date2");displayMessage=misys.getLocalization("InvoiceDueDateToLesserThanInvoiceDueDateFrom");_2d.focus();_2d.set("state","Error");dj.hideTooltip(_2d.domNode);dj.showTooltip(displayMessage,_2d.domNode,0);}return true;};})(dojo,dijit,misys);dojo.require("misys.client.binding.openaccount.listdef_ip_approved_request_financing_buyer_upload_client");}