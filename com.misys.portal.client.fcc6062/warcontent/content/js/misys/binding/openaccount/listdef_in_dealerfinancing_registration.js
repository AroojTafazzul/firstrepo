/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.openaccount.listdef_in_dealerfinancing_registration"]){dojo._hasResource["misys.binding.openaccount.listdef_in_dealerfinancing_registration"]=true;dojo.provide("misys.binding.openaccount.listdef_in_dealerfinancing_registration");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojo.data.ItemFileWriteStore");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.MultiSelect");dojo.require("dijit.layout.TabContainer");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.openaccount.StringUtils");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.form.CurrencyTextBox");dojo.require("misys.binding.common.reauth_listdef_common");dojo.require("misys.binding.system.reauth");dojo.require("misys.binding.common.reauth_listdef");(function(d,dj,m){function _1(){var _2=false,_3=[];d.query(".dojoxGrid").forEach(function(g){_3.push(dj.byId(g.id));});d.forEach(_3,function(_4){if(_4.selection.getSelected().length>0&&_4.store._items.length>0){_2=true;}});return _2;};d.subscribe("ready",function(){m._config=(m._config)||{};m._config.cellNodeReference;d.query(".dojoxGrid").forEach(function(_5){if(_5.id!=="nonSignedFolders"){m.connect(_5.id,"onRowMouseOver",m._config.mouseOverShowTermsAndConditions);m.connect(_5.id,"onRowMouseOut",m._config.mouseOutHideTermsAndConditions);m.connect(dj.byId(_5.id).selection,"onSelected",m._config.showTermsAndConditions);m.connect(dj.byId(_5.id).selection,"onDeselected",m._config.hideTermsAndConditions);m.connect(_5.id,"onRowClick",m._config.storeCellNodeReference);m.connect(_5.id,"onHeaderCellClick",function(_6){if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode){dj.hideTooltip(m._config.cellNodeReference.cellNode);m._config.cellNodeReference.cellNode=null;}});}});});d.mixin(m,{bind:function(){m.setValidation("cur_code",m.validateCurrency);m.connect("cur_code","onChange",_7);m.connect("cur_code","onChange",function(){misys.setCurrency(this,["AmountRange","AmountRange2"]);});m.connect("submitButton","onClick",_8);}});d.mixin(m._config,{submitOpenAccount:function(_9,_a){var _b=[],_c="",_d="",_e={},_f=dj.byId("reauth_perform");m._config.programcode=_9;m._config.subtnxtypecode=_a;if(_1()){if(_f&&_f.get("value")==="Y"){if(d.isFunction(m._config.initReAuthParams)){_e=m._config.initReAuthParams();m._config.executeReauthentication(_e);}else{m.setContentInReAuthDialog("ERROR","");dj.byId("reauth_dialog").show();}}else{m._config.nonReauthSubmit();}}else{m.dialog.show("ERROR",m.getLocalization("noTransactionsSelectedError"));}},showTermsAndConditions:function(_10){var _11;if(this.grid.store._items[_10]&&this.grid.store._items[_10].i){_11=this.grid.store._items[_10].i["Counterparty@ObjectDataClob@conditions_02"];_11=m.replaceCarriageReturn(_11,"<br>");}if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode&&m._config.cellNodeReference.cellIndex===0){dj.hideTooltip(m._config.cellNodeReference.cellNode);dj.showTooltip(_11,m._config.cellNodeReference.cellNode,0);}},mouseOverShowTermsAndConditions:function(evt){if(this.selection.selected[evt.rowIndex]&&this.selection.selected[evt.rowIndex]===true&&evt.cellIndex===0){var _12;_12=this.store._items[evt.rowIndex].i["Counterparty@ObjectDataClob@conditions_02"];_12=m.replaceCarriageReturn(_12,"<br>");dj.showTooltip(_12,evt.cellNode,0);}},mouseOutHideTermsAndConditions:function(evt){dj.hideTooltip(evt.cellNode);},storeCellNodeReference:function(evt){m._config.cellNodeReference=evt;},hideTermsAndConditions:function(evt){if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode){dj.hideTooltip(m._config.cellNodeReference.cellNode);}},initReAuthParams:function(){var _13={productCode:"DFR",subProductCode:"",transactionTypeCode:"01",entity:"",currency:"",amount:"",es_field1:"",es_field2:""};return _13;},reauthSubmit:function(){var _14=dj.byId("reauth_password").get("value"),_15="",_16="",_17=[];var _18=[];_18.push("&reauth_otp_response=",_14);if(dj.byId("nonSignedFolders")){if(dijit.byId("nonSignedFolders").selection.selectedIndex!==-1){if(dj.byId("referenceid")){_15=dj.byId("referenceid").get("value");}if(dj.byId("tnxid")){_16=dj.byId("tnxid").get("value");}}}var url="/screen/AjaxScreen/action/RunGroupSubmission?s=InvoiceScreen&operation=SUBMIT&option=IP_FOLDER&mode=DRAFT&tnxtype=01&referenceid="+_15+"&tnxid="+_16+"&programcode="+m._config.programcode;if(m._config.subtnxtypecode!==null){url=url+"&sub_tnx_type_code="+m._config.subtnxtypecode;}d.query(".dojoxGrid").forEach(function(g){_17.push(dj.byId(g.id));});m.grid.processRecords(_17,url+_18.join(""));},nonReauthSubmit:function(){var _19=[],_1a="",_1b="";if(dj.byId("nonSignedFolders")){if(dijit.byId("nonSignedFolders").selection.selectedIndex!==-1){if(dj.byId("referenceid")){_1a=dj.byId("referenceid").get("value");}if(dj.byId("tnxid")){_1b=dj.byId("tnxid").get("value");}}}d.query(".dojoxGrid").forEach(function(g){_19.push(dj.byId(g.id));});var url="/screen/AjaxScreen/action/RunGroupSubmission?s=InvoiceScreen&operation=SUBMIT&option=IP_FOLDER&mode=DRAFT&tnxtype=01&referenceid="+_1a+"&tnxid="+_1b+"&programcode="+m._config.programcode;if(m._config.subtnxtypecode!==null){url=url+"&sub_tnx_type_code="+m._config.subtnxtypecode;}m.grid.processRecords(_19,url);}});function _7(){if(dj.byId("cur_code").value!=""){dj.byId("AmountRangevisible").set("disabled",false);dj.byId("AmountRange2visible").set("disabled",false);}else{if(dj.byId("cur_code").value==""){dj.byId("AmountRangevisible").set("disabled",true);dj.byId("AmountRange2visible").set("disabled",true);dj.byId("AmountRangevisible").reset();dj.byId("AmountRange2visible").reset();}}};function _8(){if(dj.byId("AmountRangevisible")){var _1c=dj.byId("AmountRangevisible").value;var _1d=isNaN(_1c)?0:_1c;dj.byId("AmountRange").set("value",_1c);var _1e=dj.byId("AmountRange2visible").value;dj.byId("AmountRange2").set("value",_1e);}};})(dojo,dijit,misys);dojo.require("misys.client.binding.openaccount.listdef_in_dealerfinancing_registration_client");}