/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.openaccount.financing_request_in"]){dojo._hasResource["misys.binding.openaccount.financing_request_in"]=true;dojo.provide("misys.binding.openaccount.financing_request_in");dojo.require("misys.form.CurrencyTextBox");dojo.require("dijit.form.NumberTextBox");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.common");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.TooltipDialog");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dijit.form.FilteringSelect");dojo.require("dojo.data.ItemFileReadStore");dojo.require("misys.form.SimpleTextarea");dojo.require("misys.form.file");dojo.require("misys.widget.Collaboration");dojo.require("misys.form.PercentNumberTextBox");(function(d,dj,m){d.mixin(m._config,{initReAuthParams:function(){var _1={productCode:dj.byId("product_code").get("value"),subProductCode:dj.byId("sub_product_code")?dj.byId("sub_product_code").get("value"):"",transactionTypeCode:"63",entity:dj.byId("entity")?dj.byId("entity").get("value"):"",currency:dj.byId("finance_requested_cur_code")?dj.byId("finance_requested_cur_code").get("value"):"",amount:m.trimAmount(dj.byId("finance_requested_amt")?dj.byId("finance_requested_amt").get("value"):""),es_field1:m.trimAmount(dj.byId("finance_requested_amt")?dj.byId("finance_requested_amt").get("value"):""),es_field2:""};return _1;}});d.mixin(m,{bind:function(){m.connect("request_no","onClick",function(){if(dj.byId("inv_eligible_cur_code")){dj.byId("inv_eligible_cur_code").set("value",dj.byId("total_net_amt").get("value"));}if(dj.byId("inv_eligible_pct")){dj.byId("inv_eligible_pct").set("value","");dj.byId("inv_eligible_pct").set("required",true);}if(dj.byId("finance_requested_amt")){dj.byId("finance_requested_amt").set("value","");dj.byId("finance_requested_amt").set("required",false);}if(dj.byId("liab_total_net_amt")){dj.byId("liab_total_net_amt").set("value","");dj.byId("liab_total_net_amt").set("required",false);}});if(dj.byId("inv_eligible_cur_code")){m.setCurrency(inv_eligible_cur_code,["inv_eligible_amt"]);}m.connect("inv_eligible_pct","onChange",function(){if(this.get("value")!==null&&!isNaN(this.get("value"))&&parseFloat(this.get("value"))<=100&&parseFloat(this.get("value"))>0){var _2=parseFloat(dj.byId("inv_eligible_amt").get("value").replaceAll(",",""));var _3=parseFloat(dj.byId("invoice_outstanding_amt").get("value").replaceAll(",",""));var _4,_5;var _6=dj.byId("cashCustomizationEnable").get("value");if(_6==="true"&&dj.byId("total_discount")&&dj.byId("total_discount").get("value")!=null){var _7=parseFloat(dj.byId("total_discount").get("value").replace(",",""));if(_3<_2){_3=_3-_7;_4=(parseFloat(this.get("value"))*_3)/100;}else{_2=_2-_7;_4=(parseFloat(this.get("value"))*_2)/100;}}else{if(_3<_2){_4=(parseFloat(this.get("value"))*_3)/100;}else{_4=(parseFloat(this.get("value"))*_2)/100;}}dj.byId("finance_requested_amt").set("value",_4);dj.byId("liab_total_net_amt").set("value",_3);}else{displayMessage=misys.getLocalization("incorrectPercentage");dj.byId("finance_requested_amt").set("value","");dj.byId("liab_total_net_amt").set("value","");this.set("value","");this.set("state","Error");m.dialog.show("ERROR",m.getLocalization("focusOnErrorAlert"));m._config.onSubmitErrorMsg=m.getLocalization("focusOnErrorAlert");dj.hideTooltip(this.domNode);dj.showTooltip(displayMessage,this.domNode,0);}m.setCurrency(dj.byId("finance_requested_cur_code"),["finance_requested_amt"]);m.setCurrency(dj.byId("liab_total_net_cur_code"),["liab_total_net_amt"]);});},onFormLoad:function(){m.setCurrency(dj.byId("finance_requested_cur_code"),["finance_requested_amt"]);m.setCurrency(dj.byId("liab_total_net_cur_code"),["liab_total_net_amt"]);},beforeSubmitValidations:function(){var _8=true;var _9="";var _a=dj.byId("free_format_text");var _b=dj.byId("product_code");if((_b&&_b.get("value")=="IN")&&(_a&&dojo.string.trim(_a.get("value"))==="")){_a.set("required",true);_a.focus();_8=false;}else{_8=true;}m._config.onSubmitErrorMsg=_9;return _8;}});})(dojo,dijit,misys);dojo.require("misys.client.binding.openaccount.financing_request_in_client");}