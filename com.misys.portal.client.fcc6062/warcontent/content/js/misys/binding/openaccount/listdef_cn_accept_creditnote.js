/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.binding.openaccount.listdef_cn_accept_creditnote"]){dojo._hasResource["misys.binding.openaccount.listdef_cn_accept_creditnote"]=true;dojo.provide("misys.binding.openaccount.listdef_cn_accept_creditnote");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojo.data.ItemFileWriteStore");dojo.require("dijit.form.FilteringSelect");dojo.require("misys.form.MultiSelect");dojo.require("dijit.layout.TabContainer");dojo.require("misys.form.common");dojo.require("misys.openaccount.StringUtils");dojo.require("misys.validation.common");dojo.require("dijit.form.Form");dojo.require("dijit.form.Button");dojo.require("dijit.form.TextBox");dojo.require("dijit.form.ValidationTextBox");dojo.require("dijit.form.CheckBox");dojo.require("dijit.layout.ContentPane");dojo.require("misys.form.CurrencyTextBox");(function(d,dj,m){d.subscribe("ready",function(){m._config=(m._config)||{};m._config.cellNodeReference;d.query(".dojoxGrid").forEach(function(_1){if(_1.id!=="nonSignedFolders"){m.connect(_1.id,"onRowMouseOver",m._config.mouseOverShowTermsAndConditions);m.connect(_1.id,"onRowMouseOut",m._config.mouseOutHideTermsAndConditions);m.connect(dj.byId(_1.id).selection,"onSelected",m._config.showTermsAndConditions);m.connect(dj.byId(_1.id).selection,"onDeselected",m._config.hideTermsAndConditions);m.connect(_1.id,"onRowClick",m._config.storeCellNodeReference);m.connect(_1.id,"onHeaderCellClick",function(_2){if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode){dj.hideTooltip(m._config.cellNodeReference.cellNode);m._config.cellNodeReference.cellNode=null;}});}});});d.mixin(m,{bind:function(){m.setValidation("cur_code",m.validateCurrency);m.connect("cur_code","onChange",_3);m.connect("cur_code","onChange",function(){misys.setCurrency(this,["AmountRange","AmountRange2"]);});m.connect("submitButton","onClick",_4);},onFormLoad:function(){if(dijit.byId("eligibility_flag")){dijit.byId("eligibility_flag").set("value","E");}}});d.mixin(m._config,{submitOpenAccount:function(_5,_6){var _7=[],_8="",_9="",_a="";if(dj.byId("nonSignedFolders")){if(dijit.byId("nonSignedFolders").selection.selectedIndex!==-1){if(dj.byId("referenceid")){_8=dj.byId("referenceid").get("value");}if(dj.byId("tnxid")){_a=dj.byId("tnxid").get("value");}}}_9=dj.byId("base_ccy").get("value");d.query(".dojoxGrid").forEach(function(g){_7.push(dj.byId(g.id));});var _b=d.isArray(_7)?_7:[_7],_c=d.byId("batchContainer"),_d=[],_e="",_f=0,_10,_11;d.forEach(_b,function(_12){cache=_12.selection.preserver._selectedById;for(var i in cache){if(cache[i]){_10=i;if(_10!="undefined"){if(_e!==""){_e+=", ";}_e+=_10;_f++;}}}});if(_e==""){m.dialog.show("ERROR",m.getLocalization("noTransactionsSelectedError"));}else{var URL=window.location.pathname;m.post({action:URL,params:[{name:"list_keys",value:_e},{name:"programcode",value:"03"},{name:"base_ccy",value:_9},{name:"operation",value:"MULTI_LIST"}]});}},showTermsAndConditions:function(_13){var _14;if(this.grid.store._items[_13]&&this.grid.store._items[_13].i){_14=this.grid.store._items[_13].i["MyParty@ObjectDataClob@conditions_03"];_14=m.replaceCarriageReturn(_14,"<br>");}if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode&&m._config.cellNodeReference.cellIndex===0){dj.hideTooltip(m._config.cellNodeReference.cellNode);dj.showTooltip(_14,m._config.cellNodeReference.cellNode,0);}},mouseOverShowTermsAndConditions:function(evt){if(this.selection.selected[evt.rowIndex]&&this.selection.selected[evt.rowIndex]===true&&evt.cellIndex===0){var _15;_15=this.store._items[evt.rowIndex].i["MyParty@ObjectDataClob@conditions_01"];_15=m.replaceCarriageReturn(_15,"<br>");dj.showTooltip(_15,evt.cellNode,0);}},mouseOutHideTermsAndConditions:function(evt){dj.hideTooltip(evt.cellNode);},storeCellNodeReference:function(evt){m._config.cellNodeReference=evt;},hideTermsAndConditions:function(evt){if(m._config.cellNodeReference&&m._config.cellNodeReference.cellNode){dj.hideTooltip(m._config.cellNodeReference.cellNode);}}});function _3(){if(dj.byId("cur_code").value!=""){dj.byId("AmountRangevisible").set("disabled",false);dj.byId("AmountRange2visible").set("disabled",false);}else{if(dj.byId("cur_code").value==""){dj.byId("AmountRangevisible").set("disabled",true);dj.byId("AmountRange2visible").set("disabled",true);dj.byId("AmountRangevisible").reset();dj.byId("AmountRange2visible").reset();}}};function _4(){if(dj.byId("AmountRangevisible")){var _16=dj.byId("AmountRangevisible").value;var _17=isNaN(_16)?0:_16;dj.byId("AmountRange").set("value",_16);var _18=dj.byId("AmountRange2visible").value;dj.byId("AmountRange2").set("value",_18);}};})(dojo,dijit,misys);dojo.require("misys.client.binding.openaccount.listdef_cn_accept_creditnote_client");}