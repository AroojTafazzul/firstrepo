/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.editor.plugins.ProductFieldChoice"]){dojo._hasResource["misys.editor.plugins.ProductFieldChoice"]=true;dojo.provide("misys.editor.plugins.ProductFieldChoice");dojo.require("dijit._editor._Plugin");dojo.require("dijit._editor.range");dojo.require("dijit.form.FilteringSelect");dojo.require("dojo.data.ItemFileReadStore");dojo.require("dojo.i18n");dojo.requireLocalization("misys.editor.plugins","ProductFieldChoice",null,"ROOT,ar,en,en-gb,en-us,fr-fr");dojo.declare("misys.editor.plugins._ProductFieldDropDown",[dijit._Widget,dijit._Templated],{product:"",label:"",widgetsInTemplate:true,plainText:false,templateString:"<span style='white-space: nowrap' class='dijit dijitReset dijitInline'>"+"<label class='dijitLeft dijitInline' for='${selectId}'>${label}</label>"+"<input dojoType='dijit.form.FilteringSelect' required=false labelType=html labelAttr=label searchAttr=name "+"tabIndex='-1' id='${selectId}' dojoAttachPoint='select' value=''/>"+"</span>",generic:false,command:"misysEditorPluginsProductFieldChoice",postMixInProperties:function(){if(!this.values){this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"];}this.inherited(arguments);this.strings=dojo.i18n.getLocalization("misys.editor.plugins","ProductFieldChoice");this.label=this.strings[this.command];this.id=dijit.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments);},postCreate:function(){var _1=[];if(this.product!=""&&arrProductColumn[this.product]){this._availableValues=arrProductColumn[this.product];for(var i=0;i<arrProductColumn[this.product].length;i++){var _2=arrProductColumn[this.product][i];if(_2&&arrColumn[_2]){_1.push({label:"<div>"+arrColumn[_2][1]+"</div>",name:arrColumn[_2][1],value:_2});}}}this.select.store=new dojo.data.ItemFileReadStore({data:{identifier:"value",items:_1}});this.select.set("value","",false);this.disabled=this.select.get("disabled");},getLabel:function(_3,_4){if(this.plainText){return _4;}else{return "<div style='font-family: "+_3+"'>"+_4+"</div>";}},focus:function(){this.select.focus();},_getValueAttr:function(){return this.select.get("value");},_setValueAttr:function(_5,_6){_6=_6!==false?true:false;_6=_6!==false?true:false;this.select.set("value",dojo.indexOf(this.values,_5)<0?"":_5,_6);},_setDisabledAttr:function(_7){this.disabled=_7;this.select.set("disabled",_7);}});dojo.declare("misys.editor.plugins.ProductFieldChoice",dijit._editor._Plugin,{useDefaultCommand:false,_initButton:function(){params=this.params;if(this.params.custom){params.values=this.params.custom;}this.button=new misys.editor.plugins._ProductFieldDropDown(params);this.connect(this.button.select,"onChange",function(_8){this.editor.focus();if(_8.indexOf(" ")!=-1){_8="'"+_8+"'";}var _9=-1;for(var i=0;i<arrProductColumn[this.product].length;i++){if(arrProductColumn[this.product][i]&&arrProductColumn[this.product][i]==_8){_9=i;break;}}if(_9!=-1){var _a="{ "+arrColumn[arrProductColumn[this.product][_9]][1]+" }";var _b=arrColumn[arrProductColumn[this.product][_9]][0];var id=arrProductColumn[this.product][_9];var _c="&nbsp;<input type='button' disabled='disabled' class='rte-editor-product-field' "+"value=\""+_a+"\" id='"+id+"' field-type='"+_b+"'/>&nbsp;";this.editor.execCommand("inserthtml",_c);}this.button.select.set("value","");});},_escapeQuotes:function(_d){}});dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){if(o.plugin){return;}switch(o.args.name){case "misys.editor.plugins.ProductFieldChoice":o.plugin=new misys.editor.plugins.ProductFieldChoice({product:o.args.product});break;default:break;}});}