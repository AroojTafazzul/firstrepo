/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.layout.FloatingPane"]){dojo._hasResource["misys.layout.FloatingPane"]=true;dojo.provide("misys.layout.FloatingPane");dojo.experimental("misys.layout.FloatingPane");dojo.require("dojox.layout.FloatingPane");dojo.require("dojo.fx");dojo.require("dojo.cache");dojo.declare("misys.layout.FloatingPane",[dojox.layout.FloatingPane],{templateString:dojo.cache("misys.layout","resources/CollaborationFloatingPane.html","<div class=\"dojoxFloatingPane\" id=\"${id}\" dojoAttachPoint=\"floatingWindow\">\n <div tabindex=\"0\" waiRole=\"button\" class=\"dojoxFloatingPaneTitle\" dojoAttachPoint=\"titleBarNode,focusNode\">\n  <span dojoAttachPoint=\"pinNode\" dojoAttachEvent=\"onclick: pin\" class=\"pinButton\"></span>\n  <img src=\"${_blankGif}\" dojoAttachEvent=\"onclick:toggle\" alt=\"\" dojoAttachPoint=\"arrowNode\" class=\"dijitArrowNode\" waiRole=\"presentation\">\n  <span dojoAttachPoint=\"arrowNodeInner\" dojoAttachEvent=\"onclick:toggle\" class=\"dijitArrowNodeInner\"></span>\n  <span dojoAttachPoint=\"titleNode\" dojoAttachEvent=\"onclick:toggle\" class=\"dijitInline dijitTitleNode\"></span>\n </div>\n <div dojoAttachPoint=\"canvas,collabContentNode\" class=\"dojoxFloatingPaneCanvas\" id=\"collaborationWindowContent\">\n  <div dojoAttachPoint=\"containerNode\" waiRole=\"region\" tabindex=\"-1\" class=\"${contentClass}\"></div>\n  <span dojoAttachPoint=\"resizeHandle\" class=\"dojoxFloatingResizeHandle\"></span>\n </div>\n <!-- These are needed by the inherited class, but we don't use them -->\n <span style=\"display:none\">\n  <span dojoAttachPoint=\"closeNode\" class=\"dojoxFloatingCloseIcon\"></span>\n  <span dojoAttachPoint=\"maxNode\" class=\"dojoxFloatingMaximizeIcon\"></span>\n  <span dojoAttachPoint=\"restoreNode\" class=\"dojoxFloatingRestoreIcon\"></span>    \n  <span dojoAttachPoint=\"dockNode\" class=\"dojoxFloatingMinimizeIcon\"></span>\n </span>\n</div>\n"),open:false,pinned:true,_pinnedReference:null,_windowHeight:null,duration:dijit.defaultDuration,_blankGif:misys.getContextualURL("/content/js/dojo/resources/blank.gif"),postCreate:function(){this.inherited(arguments);this.moveable=new dojo.dnd.move.parentConstrainedMoveable(this.domNode,{handle:this.focusNode,constraints:{l:0,t:20,w:window.innerWidth,h:window.innerHeight},within:true});var _1=this.collabContentNode,_2=this.floatingWindow;if(this.open){_1.style.height="auto";_2.style.height="auto";dojo.style(this.domNode,"height","auto");}else{_1.style.display="none";dojo.style(this.domNode,"height","30px");}this._setCss();dojo.setSelectable(this.titleNode,false);dijit.setWaiState(this.containerNode,"labelledby",this.titleNode.id);dijit.setWaiState(this.focusNode,"haspopup","true");this._showPanes=function(){_1.style.height="auto";_2.style.height="auto";};this._hidePanes=function(){this._windowHeight=dojo.style("collaborationWindowContent","height");_2.style.height="auto";_1.style.height="0";};if(!dojo.isIE||dojo.isIE>6){this._fadeOut=dojo.fadeOut({node:_1,duration:this.duration,onEnd:function(){_1.style.display="none";}});}else{this._fadeOut=function(){_1.style.display="none";};}if(!dojo.isIE||dojo.isIE>6){this._fadeIn=dojo.fadeIn({node:_1,duration:this.duration,beforeBegin:function(){_1.style.display="inherit";}});}else{this._fadeIn=function(){_1.style.display="block";};}this.pin();},toggle:function(){var _3=this[this.open?"_fadeOut":"_fadeIn"];var _4=this[this.open?"_hidePanes":"_showPanes"];if(_3&&_4){_4();if(_3.play){_3.play();}else{_3();}}else{this.collabContentNode.style.display=this.open?"":"none";}this.open=!(this.open);this._onShow();this._setCss();},pin:function(){if(!this.pinned){this.pinNode.style.background="url('"+misys.getContextualURL("/content/images/pic_pinup.gif")+"')";this._pinnedReference=dojo.connect(window,"onscroll",this,"_positionWindow");misys.connections.push(this._pinnedReference);}else{this.pinNode.style.background="url('"+misys.getContextualURL("/content/images/pic_pindown.gif")+"')";if(this._pinnedReference){dojo.disconnect(this._pinnedReference);}}this.pinned=!this.pinned;},resize:function(_5){_5=_5||this._naturalState;this._currentState=_5;var _6=this.domNode.style;var c=dojo.coords(this.domNode);if("t" in _5){_6.top=c.t+"px";}if("l" in _5){_6.left=c.l+"px";}_6.width=_5.w+"px";_6.height=(this.open)?_5.h+"px":"auto";var _7=(this.open)?(_5.h-this.focusNode.offsetHeight):0;var _8={l:0,t:0,w:_5.w,h:_7};dojo.marginBox(this.canvas,_8);this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){this._singleChild.resize(_8);}},bringToTop:function(){return;},_config:{timer:null,heightOffset:null},_positionWindow:function(){if(this._config.timer){clearTimeout(this.timer);}if(!this._config.heightOffset){var _9=dojo.query(".header");this._config.heightOffset=(_9.length===1)?dojo.coords(_9[0]).h:0;}var _a=dijit.getViewport(),_b=this.domNode;this.timer=setTimeout(dojo.hitch(this,function(){dojo.fx.slideTo({node:_b,top:_a.t+(_b.offsetHeight/2)+this._config.heightOffset,right:_b.style.right,left:_b.style.left,unit:"px"}).play();}),300);},_setCss:function(){var _c=["dijitClosed","dijitOpen"];var _d=this.open;var _e=this.titleBarNode||this.focusNode;dojo.removeClass(_e,_c[!_d+0]);_e.className+=" "+_c[_d+0];this.arrowNodeInner.innerHTML=this.open?"-":"+";}});}