/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.openaccount.BulkRepaymentEvents"]){dojo._hasResource["misys.openaccount.BulkRepaymentEvents"]=true;dojo.provide("misys.openaccount.BulkRepaymentEvents");dojo.require("misys.validation.common");(function(d,dj,m){d.mixin(m,{getFinancesForBulkRepayment:function(_1,_2){if(_1==="IN"){m.showSearchDialog("bulk_repay","['invoice_ref_id', 'entity', 'program_name','seller_name','buyer_name', 'total_net_cur_code', 'finance_amt', 'outstanding_repayment_amt', 'fin_date', 'fin_due_date','prod_stat_code']",{product_code:_1,entity:_2},"",_1,"width:1250px;height:400px;",m.getLocalization("ListOfFinancesTitleMessage"));}else{if(_1==="IP"){m.showSearchDialog("bulk_repay","['invoice_payable_ref_id', 'entity', 'program_name','seller_name','buyer_name', 'total_net_cur_code', 'finance_amt', 'outstanding_repayment_amt', 'fin_date', 'fin_due_date','prod_stat_code']",{product_code:_1,entity:_2},"",_1,"width:1250px;height:400px;",m.getLocalization("ListOfFinancesTitleMessage"));}}},getFinancesForBulkRepayFiltered:function(_3){var _4;if(dj.byId("issuing_bank_customer_reference")){_4=dj.byId("issuing_bank_customer_reference").get("value");}if(!_4){misys.dialog.show("ERROR",misys.getLocalization("customerReferenceRequiredForBulkFinancingSearch"));return;}var _5;if(dj.byId("curCode")){_5=dj.byId("curCode").get("value");}if(!m.validateCurrencyCode(_5)){misys.dialog.show("ERROR",misys.getLocalization("invalidCurrencyError",[_5]));return;}var _6;var _7;var _8;var _9;if(dj.byId("finance_amount_from")){_a=dj.byId("finance_amount_from");}if(dj.byId("finance_amount_to")){_b=dj.byId("finance_amount_to");}if(dj.byId("os_repay_amount_from")){_c=dj.byId("os_repay_amount_from");}if(dj.byId("os_repay_amount_to")){_d=dj.byId("os_repay_amount_to");}if(dj.byId("finance_date_from")){_6=dj.byId("finance_date_from");}if(dj.byId("finance_date_to")){_7=dj.byId("finance_date_to");}if(dj.byId("finance_due_date_from")){_8=dj.byId("finance_due_date_from");}if(dj.byId("finance_due_date_to")){_9=dj.byId("finance_due_date_to");}if((_b&&_b.get("value")!==null&&_a&&_a.get("value")!==null)&&_b.get("value")<_a.get("value")){misys.dialog.show("ERROR",misys.getLocalization("invalidMaxAmountValueError",[_b.get("displayedValue"),_a.get("displayedValue")]));}if((_d&&_d.get("value")!==null&&_c&&_c.get("value")!==null)&&_d.get("value")<_c.get("value")){misys.dialog.show("ERROR",misys.getLocalization("invalidMaxAmountValueError",[_d.get("displayedValue"),_c.get("displayedValue")]));}if((_7&&_7.get("value")!==null&&_6&&_6.get("value")!==null)&&(d.date.compare(_7.get("value"),_6.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("financeDateToGreaterThanDateFromError",[_7.get("displayedValue"),_6.get("displayedValue")]));}if((_9&&_9.get("value")!==null&&_8&&_8.get("value")!==null)&&(d.date.compare(_9.get("value"),_8.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("financeDueDateToGreaterThanDueDateFromError",[_9.get("displayedValue"),_8.get("displayedValue")]));}var _e="";var _f;if(_3==="IP"&&dj.byId("invoicePayablesGrid")&&dj.byId("invoicePayablesGrid").store&&dj.byId("invoicePayablesGrid").store._arrayOfAllItems&&(dj.byId("invoicePayablesGrid").store._arrayOfAllItems.length>0)){_f=dj.byId("invoicePayablesGrid").store._arrayOfAllItems;for(var i=0;i<_f.length;i++){if(_f[i]&&_f[i]["REFERENCEID"]){_e=_e+_f[i]["REFERENCEID"]+",";}}}else{if(_3==="IN"&&dj.byId("invoicesGrid")&&dj.byId("invoicesGrid").store&&dj.byId("invoicesGrid").store._arrayOfAllItems&&(dj.byId("invoicesGrid").store._arrayOfAllItems.length>0)){_f=dj.byId("invoicesGrid").store._arrayOfAllItems;for(var j=0;j<_f.length;j++){if(_f[j]&&_f[j]["REFERENCEID"]){_e=_e+_f[j]["REFERENCEID"]+",";}}}}var _10;var _11;var _12;var _13;var _14;var _a;var _b;var _c;var _d;var _15;if(dj.byId("ref_id")){_10=dj.byId("ref_id").get("value");}if(_3==="IP"&&dj.byId("invoice_payable_ref_id")){_12=dj.byId("invoice_payable_ref_id").get("value");}if(_3==="IN"&&dj.byId("invoice_ref_id")){_12=dj.byId("invoice_ref_id").get("value");}if(dj.byId("seller_name")){_13=dj.byId("seller_name").get("value");}if(dj.byId("buyer_name")){_14=dj.byId("buyer_name").get("value");}if(dj.byId("finance_amount_from")){_a=dj.byId("finance_amount_from");}if(dj.byId("finance_amount_to")){_b=dj.byId("finance_amount_to");}if(dj.byId("os_repay_amount_from")){_c=dj.byId("os_repay_amount_from");}if(dj.byId("os_repay_amount_to")){_d=dj.byId("os_repay_amount_to");}if(dj.byId("entity")){_15=dj.byId("entity").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"bulk_repay",product_code:_3,invoice_ref_id:_12,seller_name:_13,buyer_name:_14,curcode:_5,finance_amount_from:_a,finance_amount_to:_b,os_repay_amount_from:_c,os_repay_amount_to:_d,finance_date_from:_6,finance_date_to:_7,finance_due_date_from:_8,finance_due_date_to:_9,invoiceRefIDList:_e,entity:_15,customer_reference:_4},load:function(_16){if(_3==="IN"){m._showFilteredInvoicesForBulkRepay(_16);}else{if(_3==="IP"){m._showFilteredInvoicePayablesForBulkRepay(_16);}}}});},_showFilteredInvoicesForBulkRepay:function(_17){var _18=dj.byId("bulk_repaydata_grid");var _19=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_17.items.length>0){var _1a=_17.items;if(_1a.length>0){for(var i=0;i<_1a.length;i++){var _1b=_1a[i];if(_1b!==null){var _1c=m.createInvoiceRepaymentItem(_1b);_19.newItem(_1c);}}}if(_18){_18.setStore(_19);dojo.style(_18.domNode,"display","");_18.resize();}}else{_18.setStore(_19);dojo.style(_18.domNode,"display","");_18.resize();_18.render();}},processInvoiceRepayRecords:function(_1d){var _1e=dj.byId("invoicesGrid");var _1f=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});var _20=[];if(_1e&&_1e.store&&_1e.store._arrayOfTopLevelItems.length>0){_1e.store.fetch({query:{REFERENCEID:"*"},onComplete:function(_21,_22){dojo.forEach(_21,function(_23){var _24=m.createInvoiceRepaymentItem(_23);_1f.newItem(_24);_20.push(_23);});}});}var _25=_1d.selection.getSelected();if(_25.length>0){for(var i=0;i<_25.length;i++){var _26=false;var _27="";var _28={};var _29=_25[i];if(_29!==null){var _2a=m.createInvoiceRepaymentItem(_29);if(_20.length>0){for(var t=0;t<_20.length;t++){if(_20[t].REFERENCEID.slice().toString()===_29.REFERENCEID.slice().toString()){_26=true;}}if(!_26){_1f.newItem(_2a);}}else{_1f.newItem(_2a);}}}if(_1e){_1e.setStore(_1f);dojo.style(_1e.domNode,"display","");_1e.resize();}dj.byId("xhrDialog").hide();}else{misys.dialog.show("ERROR",misys.getLocalization("invoicePayableShouldBeSelected"));}},createInvoiceRepaymentItem:function(_2b){var _2c=_2b.REFERENCEID.slice().toString();var _2d=_2b.INVOICE_REFERENCE_LABEL.slice().toString();var _2e=_2b.ENTITY.slice().toString();var _2f=_2b.PROGRAM_NAME.slice().toString();var _30=_2b.BUYER_NAME.slice().toString();var _31=_2b.SELLER_NAME.slice().toString();var _32=_2b.CURCODE.slice().toString();var _33=_2b.FINANCE_AMOUNT;var _34=_2b.OUTSTANDING_REPAY_AMOUNT;var _35=_2b.TOTAL_REPAID_AMOUNT;var _36=_2b.FINANCE_ISSUE_DATE.slice().toString();var _37=_2b.FINANCE_DUE_DATE.slice().toString();var _38=_2b.STATUS;var _39="";if(d.byId("delete_icon")!=null&&d.byId("delete_icon")){_39=d.byId("delete_icon").value;}var _3a="<img src="+_39+" onClick =\"javascript:misys.deleteItemFromBulkGrid('invoicesGrid','"+_2b.REFERENCEID+"')\"/>";var _3b={"REFERENCEID":_2c,"INVOICE_REFERENCE_LABEL":_2d,"ENTITY":_2e,"PROGRAM_NAME":_2f,"ACTION":_3a,"BUYER_NAME":_30,"SELLER_NAME":_31,"CURCODE":_32,"FINANCE_AMOUNT":_33,"OUTSTANDING_REPAY_AMOUNT":_34,"TOTAL_REPAID_AMOUNT":_35,"FINANCE_ISSUE_DATE":_36,"FINANCE_DUE_DATE":_37,"STATUS":_38};return _3b;},deleteItemFromBulkGrid:function(_3c,ref){var _3d=[];dj.byId(_3c).store.fetch({query:{REFERENCEID:"*"},onComplete:dojo.hitch(dj.byId(_3c),function(_3e,_3f){dojo.forEach(_3e,function(_40){if(_40.REFERENCEID.slice().toString()===ref.slice().toString()){dj.byId(_3c).store.deleteItem(_40);}});})});dj.byId(_3c).resize();dj.byId(_3c).render();},getFinancesSelectedForBulkRepayment:function(_41){var _42;if(dj.byId("ref_id")){_42=dj.byId("ref_id").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"bulk_repay_linked",product_code:_41,bulk_ref_id:_42},load:function(_43){if(_41==="IN"){m._showSelectedInvoicesForBulkRepayment(_43);}else{if(_41==="IP"){m._showSelectedInvoicePayablesForBulkRepayment(_43);}}}});},_showSelectedInvoicesForBulkRepayment:function(_44){var _45=dj.byId("invoicesGrid");var _46=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_44.items.length>0){var _47=_44.items;if(_47.length>0){for(var i=0;i<_47.length;i++){var _48=_47[i];if(_48!==null){var _49=m.createInvoiceRepaymentItem(_48);_46.newItem(_49);}}}if(_45){_45.setStore(_46);dojo.style(_45.domNode,"display","");_45.resize();}}else{_45.setStore(_46);dojo.style(_45.domNode,"display","");_45.resize();_45.render();}},_showSelectedInvoicePayablesForBulkRepayment:function(_4a){var _4b=dj.byId("invoicePayablesGrid");var _4c=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_4a.items.length>0){var _4d=_4a.items;if(_4d.length>0){for(var i=0;i<_4d.length;i++){var _4e=_4d[i];if(_4e!==null){var _4f=m.createInvoicePayableRepaymentItem(_4e);_4c.newItem(_4f);}}}if(_4b){_4b.setStore(_4c);dojo.style(_4b.domNode,"display","");_4b.resize();}}else{_4b.setStore(_4c);dojo.style(_4b.domNode,"display","");_4b.resize();_4b.render();}},validateRepayDate:function(){var _50=dj.byId("bk_repay_date");if(!dj.byId("bk_repay_date").get("value")){return true;}var _51=new Date();_51.setHours(0,0,0,0);var _52=d.date.compare(m.localizeDate(_50),_51)<0?false:true;if(!_52){this.invalidMessage=m.getLocalization("repayDateNotGreaterThanCurrentDate");dj.hideTooltip(_50.domNode);dj.showTooltip(this.invalidMessage,_50.domNode,0);return false;}return true;},_showFilteredInvoicePayablesForBulkRepay:function(_53){var _54=dj.byId("bulk_repaydata_grid");var _55=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_53.items.length>0){var _56=_53.items;if(_56.length>0){for(var i=0;i<_56.length;i++){var _57=_56[i];if(_57!==null){var _58=m.createInvoicePayableRepaymentItem(_57);_55.newItem(_58);}}}if(_54){_54.setStore(_55);dojo.style(_54.domNode,"display","");_54.resize();}}else{_54.setStore(_55);dojo.style(_54.domNode,"display","");_54.resize();_54.render();}},createInvoicePayableRepaymentItem:function(_59){var _5a=_59.REFERENCEID.slice().toString();var _5b=_59.INVOICE_REFERENCE_LABEL.slice().toString();var _5c=_59.ENTITY.slice().toString();var _5d=_59.PROGRAM_NAME.slice().toString();var _5e=_59.BUYER_NAME.slice().toString();var _5f=_59.SELLER_NAME.slice().toString();var _60=_59.CURCODE.slice().toString();var _61=_59.FINANCE_AMOUNT;var _62=_59.OUTSTANDING_REPAY_AMOUNT;var _63=_59.TOTAL_REPAID_AMOUNT;var _64=_59.FINANCE_ISSUE_DATE.slice().toString();var _65=_59.FINANCE_DUE_DATE.slice().toString();var _66=_59.STATUS;var _67="";if(d.byId("delete_icon")!=null&&d.byId("delete_icon")){_67=d.byId("delete_icon").value;}var _68="<img src="+_67+" onClick =\"javascript:misys.deleteItemFromBulkGrid('invoicePayablesGrid','"+_59.REFERENCEID+"')\"/>";var _69={"REFERENCEID":_5a,"INVOICE_REFERENCE_LABEL":_5b,"ENTITY":_5c,"PROGRAM_NAME":_5d,"ACTION":_68,"BUYER_NAME":_5e,"SELLER_NAME":_5f,"CURCODE":_60,"FINANCE_AMOUNT":_61,"OUTSTANDING_REPAY_AMOUNT":_62,"TOTAL_REPAID_AMOUNT":_63,"FINANCE_ISSUE_DATE":_64,"FINANCE_DUE_DATE":_65,"STATUS":_66};return _69;},processInvoicePayableRepayRecords:function(_6a){var _6b=dj.byId("invoicePayablesGrid");var _6c=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});var _6d=[];if(_6b&&_6b.store&&_6b.store._arrayOfTopLevelItems.length>0){_6b.store.fetch({query:{REFERENCEID:"*"},onComplete:function(_6e,_6f){dojo.forEach(_6e,function(_70){var _71=m.createInvoicePayableRepaymentItem(_70);_6c.newItem(_71);_6d.push(_70);});}});}var _72=_6a.selection.getSelected();if(_72.length>0){for(var i=0;i<_72.length;i++){var _73=false;var _74="";var _75={};var _76=_72[i];if(_76!==null){var _77=m.createInvoicePayableRepaymentItem(_76);if(_6d.length>0){for(var t=0;t<_6d.length;t++){if(_6d[t].REFERENCEID.slice().toString()===_76.REFERENCEID.slice().toString()){_73=true;}}if(!_73){_6c.newItem(_77);}}else{_6c.newItem(_77);}}}if(_6b){_6b.setStore(_6c);dojo.style(_6b.domNode,"display","");_6b.resize();}dj.byId("xhrDialog").hide();}else{misys.dialog.show("ERROR",misys.getLocalization("invoicePayableShouldBeSelected"));}},getInvoicePayablesForBulkRepaymentLinkedFiltered:function(){var _78;if(dj.byId("ref_id")){_78=dj.byId("ref_id").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"bulk_repay_linked",product_code:"IP",bulk_ref_id:_78},load:function(_79){m._showFilteredInvoicePayablesForBulkRepaymentLinked(_79);}});},_showFilteredInvoicePayablesForBulkRepaymentLinked:function(_7a){var _7b=dj.byId("invoicePayablesGrid");var _7c=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_7a.items.length>0){var _7d=_7a.items;if(_7d.length>0){for(var i=0;i<_7d.length;i++){var _7e=_7d[i];if(_7e!==null){var _7f=m.createInvoicePayableRepaymentItem(_7e);_7c.newItem(_7f);}}}if(_7b){_7b.setStore(_7c);dojo.style(_7b.domNode,"display","");_7b.resize();}}else{_7b.setStore(_7c);dojo.style(_7b.domNode,"display","");_7b.resize();_7b.render();}},getInvoicePayablesForBulkRepayFiltered:function(){var _80;if(dj.byId("issuing_bank_customer_reference")){_80=dj.byId("issuing_bank_customer_reference").get("value");}if(!_80){misys.dialog.show("ERROR",misys.getLocalization("customerReferenceRequiredForBulkFinancingSearch"));return;}var _81;if(dj.byId("curCode")){_81=dj.byId("curCode").get("value");}if(!m.validateCurrencyCode(_81)){misys.dialog.show("ERROR",misys.getLocalization("invalidCurrencyError",[_81]));return;}var _82;var _83;var _84;var _85;if(dj.byId("finance_amount_from")){_86=dj.byId("finance_amount_from");}if(dj.byId("finance_amount_to")){_87=dj.byId("finance_amount_to");}if(dj.byId("os_repay_amount_from")){_88=dj.byId("os_repay_amount_from");}if(dj.byId("os_repay_amount_to")){_89=dj.byId("os_repay_amount_to");}if(dj.byId("finance_date_from")){_82=dj.byId("finance_date_from");}if(dj.byId("finance_date_to")){_83=dj.byId("finance_date_to");}if(dj.byId("finance_due_date_from")){_84=dj.byId("finance_due_date_from");}if(dj.byId("finance_due_date_to")){_85=dj.byId("finance_due_date_to");}if((_87&&_87.get("value")!==null&&_86&&_86.get("value")!==null)&&_87.get("value")<_86.get("value")){misys.dialog.show("ERROR",misys.getLocalization("invalidMaxAmountValueError",[_87.get("displayedValue"),_86.get("displayedValue")]));}if((_89&&_89.get("value")!==null&&_88&&_88.get("value")!==null)&&_89.get("value")<_88.get("value")){misys.dialog.show("ERROR",misys.getLocalization("invalidMaxAmountValueError",[_89.get("displayedValue"),_88.get("displayedValue")]));}if((_83&&_83.get("value")!==null&&_82&&_82.get("value")!==null)&&(d.date.compare(_83.get("value"),_82.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("financeDateToGreaterThanDateFromError",[_83.get("displayedValue"),_82.get("displayedValue")]));}if((_85&&_85.get("value")!==null&&_84&&_84.get("value")!==null)&&(d.date.compare(_85.get("value"),_84.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("financeDueDateToGreaterThanDueDateFromError",[_85.get("displayedValue"),_84.get("displayedValue")]));}var _8a="";if(dj.byId("invoicePayablesGrid")&&dj.byId("invoicePayablesGrid").store&&dj.byId("invoicePayablesGrid").store._arrayOfAllItems&&dj.byId("invoicePayablesGrid").store._arrayOfAllItems.length){var _8b=dj.byId("invoicePayablesGrid").store._arrayOfAllItems;for(var i=0;i<_8b.length;i++){if(_8b[i]&&_8b[i]["REFERENCEID"]){_8a=_8a+_8b[i]["REFERENCEID"]+",";}}}var _8c;var _8d;var _8e;var _86;var _87;var _88;var _89;var _8f;if(dj.byId("ref_id")){_8c=dj.byId("ref_id").get("value");}if(dj.byId("invoice_payable_ref_id")){_8d=dj.byId("invoice_payable_ref_id").get("value");}if(dj.byId("seller_name")){_8e=dj.byId("seller_name").get("value");}if(dj.byId("finance_amount_from")){_86=dj.byId("finance_amount_from");}if(dj.byId("finance_amount_to")){_87=dj.byId("finance_amount_to");}if(dj.byId("os_repay_amount_from")){_88=dj.byId("os_repay_amount_from");}if(dj.byId("os_repay_amount_to")){_89=dj.byId("os_repay_amount_to");}if(dj.byId("entity")){_8f=dj.byId("entity").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"bulk_repay",product_code:"IP",invoice_ref_id:_8d,seller_name:_8e,curcode:_81,finance_amount_from:_86,finance_amount_to:_87,os_repay_amount_from:_88,os_repay_amount_to:_89,finance_date_from:_82,finance_date_to:_83,finance_due_date_from:_84,finance_due_date_to:_85,invoiceRefIDList:_8a,entity:_8f,customer_reference:_80},load:function(_90){m._showFilteredInvoicePayablesForBulkRepay(_90);}});},clearInvoiceGrid:function(_91){var _92=dj.byId(_91);var _93="";if(dj.byId(_91)&&dj.byId(_91).store&&dj.byId(_91).store._arrayOfAllItems&&(dj.byId(_91).store._arrayOfAllItems.length>0)){var _94=dj.byId(_91).store._arrayOfAllItems;for(var i=0;i<_94.length;i++){if(_94[i]&&_94[i]["REFERENCEID"]){_93=_93+_94[i]["REFERENCEID"]+",";}}}var _95=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});_92.setStore(_95);_92.resize();m.resetBulkInvoiceOnEntityChange(_93);},setTotalRepaymentAmount:function(_96){var _97=0;if(dj.byId(_96)&&dj.byId(_96).store&&dj.byId(_96).store._arrayOfAllItems&&dj.byId(_96).store._arrayOfAllItems.length&&(dj.byId(_96).store._arrayOfAllItems.length>0)){var _98=dj.byId(_96).store._arrayOfAllItems;for(var i=0;i<_98.length;i++){if(_98[i]&&_98[i]["OUTSTANDING_REPAY_AMOUNT"]){var _99=_98[i]["OUTSTANDING_REPAY_AMOUNT"][0];if(d.isString(_99)){var _9a=d.number.parse(_99);}var _9b=_98[i]["CURCODE"][0];var _9c=m.financeAmtInBaseCcyBulkRepay(_9a,_9b);_97=_97+parseFloat(_9c);}}if(_97!==0){dj.byId("bk_total_amt").set("value",_97);dj.byId("bk_total_cur_code").set("value",dj.byId("base_ccy").get("value"));}else{dj.byId("bk_total_amt").set("value","");dj.byId("bk_total_cur_code").set("value","");}}else{dj.byId("bk_total_amt").set("value","");dj.byId("bk_total_cur_code").set("value","");}},financeAmtInBaseCcyBulkRepay:function(_9d,_9e){var _9f="";var _a0;if(dj.byId("base_ccy")){_a0=dj.byId("base_ccy").get("value");}if(_a0===_9e){return _9d;}else{if(dj.byId("issuing_bank_abbv_name")&&dj.byId("issuing_bank_abbv_name").get("value")!==""){_9f=dj.byId("issuing_bank_abbv_name").get("value");}var _a1;m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetConvertedAmount"),handleAs:"json",sync:true,content:{original_amt:_9d,src_curr:_9e,dest_curr:_a0},load:function(_a2,_a3){_a1=_a2.convertedAmount;},error:function(_a4,_a5){console.error("[misys.openaccount.BulkRepaymentEvents] financeAmtInBaseCcyBulkRepay error",_a4);}});return _a1;}},validateFinanceFromDate:function(_a6,_a7){if(!m.compareDateFields(_a6,_a7)){var _a8=m.getLocalization("fromDateLessThanToDateError",[m.localizeDate(_a6),m.localizeDate(_a7)]);_a6.focus();_a6.set("state","Error");dj.hideTooltip(_a6.domNode);dj.showTooltip(_a8,_a6.domNode,0);}},validateFinanceToDate:function(_a9,_aa){if(!m.compareDateFields(_a9,_aa)){var _ab=m.getLocalization("toDateLessThanFromDateError",[m.localizeDate(_aa),m.localizeDate(_a9)]);_aa.focus();_aa.set("state","Error");dj.hideTooltip(_aa.domNode);dj.showTooltip(_ab,_aa.domNode,0);}},validateFromAmountBulkRepay:function(_ac,_ad){var _ae=_ac?_ac.get("value"):"";var _af=_ad?_ad.get("value"):"";var _b0;if(_ae!==""&&_ae<=0){_b0=misys.getLocalization("invalidAmountError");_ac.focus();_ac.set("state","Error");dj.hideTooltip(_ac.domNode);dj.showTooltip(_b0,_ac.domNode,0);dj.showTooltip(_b0,domNode,0);}if(_ae!==""&&_af!==""&&_ae>_af){_b0=misys.getLocalization("invalidMinAmountValueError");_ac.focus();_ac.set("state","Error");dj.hideTooltip(_ac.domNode);dj.showTooltip(_b0,_ac.domNode,0);dj.showTooltip(_b0,domNode,0);}},closeRepaymentGrid:function(_b1){dj.byId("xhrDialog").hide();},validateToAmountBulkRepay:function(_b2,_b3){var _b4=_b2?_b2.get("value"):"";var _b5=_b3?_b3.get("value"):"";var _b6;if(_b4!==""&&_b4<=0){_b6=misys.getLocalization("invalidAmountError");_b2.focus();_b2.set("state","Error");dj.hideTooltip(_b2.domNode);dj.showTooltip(_b6,_b2.domNode,0);dj.showTooltip(_b6,domNode,0);}if(_b4!==""&&_b5!==""&&_b4<_b5){_b6=misys.getLocalization("invalidMaxAmountValueError");_b2.focus();_b2.set("state","Error");dj.hideTooltip(_b2.domNode);dj.showTooltip(_b6,_b2.domNode,0);dj.showTooltip(_b6,domNode,0);}},resetBulkInvoiceOnEntityChange:function(_b7){var _b8;var _b9;var _ba;var _bb;var _bc;var _bd;var _be;if(dj.byId("tnx_id")){_bc=dj.byId("tnx_id").get("value");}if(dj.byId("ref_id")){_b8=dj.byId("ref_id").get("value");}if(dj.byId("invoice_ref_id")){_b9=dj.byId("invoice_ref_id").get("value");}if(dj.byId("entity")){_bb=dj.byId("entity").get("value");}if(dj.byId("child_product_code")){_bd=dj.byId("child_product_code").get("value");}if(dj.byId("sub_product_code")){_be=dj.byId("sub_product_code").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"reset_invoice_on_entity_change",product_code:_bd,sub_product_code:_be,bulk_ref_id:_b8,tnxID:_bc,invoice_ref_id:_b9,invoiceRefIDList:_b7,entity:_bb}});}});})(dojo,dijit,misys);}