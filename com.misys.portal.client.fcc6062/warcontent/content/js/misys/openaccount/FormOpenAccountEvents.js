/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["misys.openaccount.FormOpenAccountEvents"]){dojo._hasResource["misys.openaccount.FormOpenAccountEvents"]=true;dojo.provide("misys.openaccount.FormOpenAccountEvents");dojo.require("misys.validation.common");(function(d,dj,m){_fncComputePONetAmount=function(){var _1=dj.byId("fake_total_amt").get("value");var _2=_getValueAsNumber(_1);var _3=dj.byId("cashCustomizationEnable").get("value");var _4=dijit.byId("po-adjustments");if(_4&&_4.grid){_4.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_5,_6){for(var _7 in _5){var _8=_5[_7];if(_8.amt&&_8.amt.toString().trim().length!=0&&!(_3==="true"&&_8.type.toString()==="DISC")){if(_8.direction[0]==="ADDD"){_2=_2+_getValueAsNumber(dojo.isArray(_8.amt)?_8.amt[0]:_8.amt);}else{_2=_2-_getValueAsNumber(dojo.isArray(_8.amt)?_8.amt[0]:_8.amt);}}else{if(_8.rate&&_8.rate.toString().trim().length!=0&&!(_3==="true"&&_8.type.toString()==="DISC")){if(_8.direction[0]==="ADDD"){_2=_2+eval(_fncDoPercentage(_1,(dojo.isArray(_8.rate)?_8.rate[0]:_8.rate)));}else{_2=_2-eval(_fncDoPercentage(_1,(dojo.isArray(_8.rate)?_8.rate[0]:_8.rate)));}}}}})});}var _9=_2;var _a=dijit.byId("po-taxes");if(_a&&_a.grid){_a.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_b,_c){for(var _d in _b){var _e=_b[_d];if(_e.amt&&_e.amt.toString().trim().length!=0){_2=_2+_getValueAsNumber(dojo.isArray(_e.amt)?_e.amt[0]:_e.amt);}else{if(_e.rate&&_e.rate.toString().trim().length!=0){_2=_2+eval(_fncDoPercentage(_9,(dojo.isArray(_e.rate)?_e.rate[0]:_e.rate)));}}}})});}var _f=dijit.byId("po-freight-charges");if(_f&&_f.grid){_f.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_10,_11){for(var _12 in _10){var _13=_10[_12];if(_13.amt&&_13.amt.toString().trim().length!=0){_2=_2+_getValueAsNumber(dojo.isArray(_13.amt)?_13.amt[0]:_13.amt);}else{if(_13.rate&&_13.rate.toString().trim().length!=0){_2=_2+eval(_fncDoPercentage(_9,(dojo.isArray(_13.rate)?_13.rate[0]:_13.rate)));}}}})});}var _14=dj.byId("total_net_amt");if(_2>=0&&_14){_14.set("value",_2);}else{if(_14){_14.set("value","");}}};_fncComputeLineItemNetAmount=function(){var _15=dj.byId("line_item_total_cur_code").get("value");var _16=dj.byId("line_item_total_amt").get("value");if("S"+_16=="S"){return;}var _17=_getValueAsNumber(_16);var _18=dj.byId("line_item_adjustments");var _19=dj.byId("cashCustomizationEnable").get("value");if(_18&&_18.grid){_18.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_1a,_1b){for(var _1c in _1a){var adj=_1a[_1c];if(adj.amt&&adj.amt.toString().trim().length!=0&&!(_19==="true"&&adj.type.toString()==="DISC")){if(adj.direction[0]==="ADDD"){_17=_17+_getValueAsNumber(dojo.isArray(adj.amt)?adj.amt[0]:adj.amt);}else{_17=_17-_getValueAsNumber(dojo.isArray(adj.amt)?adj.amt[0]:adj.amt);}}else{if(adj.rate&&adj.rate.toString().trim().length!=0&&!(_19==="true"&&adj.type.toString()==="DISC")){if(adj.direction[0]==="ADDD"){_17=_17+eval(_fncDoPercentage(_16,(dojo.isArray(adj.rate)?adj.rate[0]:adj.rate)));}else{_17=_17-eval(_fncDoPercentage(_16,(dojo.isArray(adj.rate)?adj.rate[0]:adj.rate)));}}}}})});}var _1d=_17;var _1e=dj.byId("line_item_taxes");if(_1e&&_1e.grid){_1e.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_1f,_20){for(var _21 in _1f){var tax=_1f[_21];if(tax.amt&&tax.amt.toString().trim().length!=0){_17=_17+_getValueAsNumber(dojo.isArray(tax.amt)?tax.amt[0]:tax.amt);}else{if(tax.rate&&tax.rate.toString().trim().length!=0){_17=_17+eval(_fncDoPercentage(_1d,(dojo.isArray(tax.rate)?tax.rate[0]:tax.rate)));}}}})});}var _22=dj.byId("line_item_freight_charges");if(_22&&_22.grid){_22.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_23,_24){for(var _25 in _23){var _26=_23[_25];if(_26.amt&&_26.amt.toString().trim().length!=0){_17=_17+_getValueAsNumber(dojo.isArray(_26.amt)?_26.amt[0]:_26.amt);}else{if(_26.rate&&_26.rate.toString().trim().length!=0){_17=_17+eval(_fncDoPercentage(_1d,(dojo.isArray(_26.rate)?_26.rate[0]:_26.rate)));}}}})});}if(_17<0){_17=0;}if(dj.byId("line_item_total_net_amt")){dj.byId("line_item_total_net_amt").set("readOnly",true);dj.byId("line_item_total_net_amt").set("value",_17);}m.computePOTotalAmount();};_fncDoPercentage=function(_27,_28){var one=eval(_27);var two=eval(_28)/100;var _29=one*two;return _29;};_fncCheckIBANAccountFormat=function(_2a){if("S"+_2a.value=="S"){return true;}var _2b=/^[a-zA-Z]{2,2}[0-9]{2,2}[a-zA-Z0-9]{1,30}$/;if(_2b.test(_2a.value)){return true;}misys.dialog.show("ERROR",misys.getLocalization("invalidIBANAccNoError",[_2a.value]));_2a.value="";return false;};_fncCheckBBANAccountFormat=function(_2c){if("S"+_2c.value=="S"){return true;}var _2d=/^[a-zA-Z0-9]{1,30}$/;if(_2d.test(_2c.value)){return true;}misys.dialog.show("ERROR",misys.getLocalization("invalidBBANAccNoError",[_2c.value]));_2c.value="";return false;};_fncCheckUPICAccountFormat=function(_2e){if("S"+_2e.value==="S"){return true;}var _2f=/^[0-9]{8,17}$/;if(_2f.test(_2e.value)){return true;}misys.dialog.show("ERROR",misys.getLocalization("invalidUPICAccNoError",[_2e.value]));_2e.value="";return false;};_fncCheckLastMatchDate=function(_30){if(_30&&_30.value){_30.value=fncFormatDate(_30.value,"");if("S"+_30.value!="S"){if(fncFormatDate(_30.value,"yyyy/mm/dd")<fncFormatDate(document.forms["fakeform1"].appl_date.value,"yyyy/mm/dd")){misys.dialog.show("ERROR",misys.getLocalization("lastMatchDateLessThanAppDateError",[_30.value,document.forms["fakeform1"].appl_date.value]));_30.value="";_30.focus();}}if("S"+_30.value!=="S"&&document.forms["fakeform1"].iss_date.value!==""){if(fncFormatDate(_30.value,"yyyy/mm/dd")<fncFormatDate(document.forms["fakeform1"].iss_date.value,"yyyy/mm/dd")){misys.dialog.show("ERROR",misys.getLocalization("lastMatchDateLessThanIssDateError",[_30.value,document.forms["fakeform1"].iss_date.value]));_30.value="";_30.focus();}}}else{_30.value="";_30.focus();}return true;};_fncCheckAccountFormat=function(_31,_32,_33){accountNumber=d.byId(_32);accountFormatSelect=d.byId(_33);var _34=dj.byId(_33).get("value");if(_34){if(_34==="IBAN"){return _fncCheckIBANAccountFormat(accountNumber);}else{if(_34==="BBAN"){return _fncCheckBBANAccountFormat(accountNumber);}else{if(_34==="UPIC"){return _fncCheckUPICAccountFormat(accountNumber);}else{if(_34==="OTHER"){return true;}else{misys.dialog.show("ALERT",misys.getLocalization("mandatoryAccountMessage"));accountNumber.value="";return false;}}}}}};_fncRemoveItemsWithCurrency=function(){dj.byId("line-items").clear();dj.byId("po-adjustments").clear();dj.byId("po-taxes").clear();dj.byId("po-freight-charges").clear();dj.byId("fake_total_cur_code").set("value","");dj.byId("total_net_cur_code").set("value","");};_fncProcessDivRtgSummary=function(_35,_36,_37,_38){oldValue=dj.byId(_37).get("value");selectBoxValue=dj.byId(_38).get("value");if(oldValue!=""&&oldValue!="0"&&oldValue!=selectBoxValue){m.dialog.show("CONFIRMATION",misys.getLocalization("deleteRoutingSummariesConfirmation"),null,function(){switch(oldValue){case "0":break;case "01":misys.animate("fadeOut",dojo.byId(_36));break;case "02":misys.animate("fadeOut",dojo.byId(_35));break;default:break;}switch(selectBoxValue){case "0":break;case "01":misys.animate("fadeIn",dojo.byId(_36));break;case "02":misys.animate("fadeIn",dojo.byId(_35));break;default:break;}dj.byId(_37).set("value",selectBoxValue);_fncClearAllTransportsGrid();});m.dialog.connect(dj.byId("cancelButton"),"onMouseUp",function(){dj.byId("transport_type").set("value",dj.byId("transport_type_old").get("value"));},"alertDialog");}else{if(oldValue!=selectBoxValue){switch(oldValue){case "0":break;case "01":misys.animate("fadeOut",dojo.byId(_36));break;case "02":misys.animate("fadeOut",dojo.byId(_35));break;default:break;}switch(selectBoxValue){case "0":break;case "01":misys.animate("fadeIn",dojo.byId(_36));break;case "02":misys.animate("fadeIn",dojo.byId(_35));break;default:break;}dj.byId(_37).set("value",selectBoxValue);}}return true;};_fncClearAllTransportsGrid=function(){var _39=["po-air-routing-summary","po-sea-routing-summary","po-road-routing-summary","po-rail-routing-summary","po-multimodal-air-routing-summary","po-multimodal-sea-routing-summary","po-multimodal-place-routing-summary","po-multimodal-taking-in-routing-summary","po-multimodal-final-destination-routing-summary"];dojo.forEach(_39,function(id){var _3a=dijit.byId(id);if(_3a){_3a.clear();}});};_getValueAsNumber=function(_3b){if(d.isString(_3b)){var _3c=d.number.parse(_3b);return _3c;}return _3b;};_fncCheckPaymentTerms=function(_3d,_3e){if(dj.byId("payment_terms_type_1")||dj.byId("payment_terms_type_2")){if(dj.byId("add_payment_term_button")){dj.byId("add_payment_term_button").set("disabled",false);}var _3f;if(dj.byId("payment_terms_type_1").checked){_3f="AMNT";}else{_3f="PRCT";}var _40="";if(d.byId(_3e+"_details_pct_section").style.display==="block"){_40="PRCT";}else{if(d.byId(_3e+"_details_amt_section").style.display==="block"){_40="AMNT";}}if(_3f==="PRCT"){d.byId(_3e+"_details_pct_section").style.display="block";d.byId(_3e+"_details_amt_section").style.display="none";}else{if(_3f==="AMNT"){d.byId(_3e+"_details_pct_section").style.display="none";d.byId(_3e+"_details_amt_section").style.display="block";}}var _41;var _42;d.query("div[id^=po-payments]").forEach(function(_43){_42=dj.byId(_43.id);});var _44=false;if(_42&&_42.grid&&dojo.some(_42.store._arrayOfAllItems,function(_45){return _45!==null;})){_44=true;}if(_40!==_3f&&_44){if(_40!==""){misys.dialog.show("CONFIRMATION",misys.getLocalization("changePaymentTermsConfirmation"),"","","","",function(){_41=_42.grid;if(_41.store){_42.clear();_41.store.save();_42.renderSections();_41.render();}},function(){if(_40==="AMNT"){dj.byId("payment_terms_type_1").set("checked",true);dj.byId("payment_terms_type_2").set("checked",false);d.byId(_3e+"_details_pct_section").style.display="none";d.byId(_3e+"_details_amt_section").style.display="block";}else{if(_40==="PRCT"){dj.byId("payment_terms_type_1").set("checked",false);dj.byId("payment_terms_type_2").set("checked",true);d.byId(_3e+"_details_pct_section").style.display="block";d.byId(_3e+"_details_amt_section").style.display="none";}else{dj.byId("payment_terms_type_1").set("checked",false);dj.byId("payment_terms_type_2").set("checked",false);}}},"");}}}};function _46(_47){if(_47.get("type")==="hidden"){return d.date.locale.format(m.localizeDate(_47),{selector:"date"});}return _47.get("displayedValue");};d.mixin(m,{paymentDetailsChange:function(){dj.byId("details_label")?dj.byId("details_label").set("value",this.get("displayedValue")):"";},enableRequiredTab:function(){var idF=this.get("id"),_48="";if(idF.lastIndexOf("bill_to")!==-1){_48="bill_to";}else{if(idF.lastIndexOf("ship_to")!==-1){_48="ship_to";}else{if(idF.lastIndexOf("consgn")!==-1){_48="consgn";}}}var _49=!((dj.byId(_48+"_name").get("value")==="")&&(dj.byId(_48+"_country").get("value")===""));misys.toggleFields(_49,null,[_48+"_name"],false,true);misys.toggleCountryFields(_49,[_48+"_country"]);},toggleCountryFields:function(_4a,_4b){var _4c=m._config.requiredFieldPrefix||"*";d.forEach(_4b,function(id,i){var _4d=dj.byId(id);_4d.set("required",_4a);if(!_4a&&_4d.validate){_4d.validate(false);}var row=id+"_row";if(row){var _4e=d.query("label[for="+id+"]")[0];d.toggleClass(row,"required",_4a);var _4f="";if(_4a){if(_4e&&_4e.innerHTML.indexOf(_4c)===-1){d.place(d.create("span",{"class":"required-field-symbol",innerHTML:_4c}),_4e,"first");}}else{if(_4e&&_4e.innerHTML.indexOf(_4c)!==-1){d.query("span",_4e).orphan();}}}});},showHideOtherParties:function(){var _50=dj.byId("display_other_parties").get("value");var _51=d.byId("other_parties_section");var _52=[];if(_50){m.animate("fadeIn",_51);m.toggleFields(true,null,_52,false,false);}else{m.animate("fadeOut",_51);m.toggleFields(false,null,_52,false,false);}if(!_50){dj.byId("bill_to_name").set("value","");dj.byId("bill_to_street_name").set("value","");dj.byId("bill_to_post_code").set("value","");dj.byId("bill_to_town_name").set("value","");dj.byId("bill_to_country_sub_div").set("value","");dj.byId("bill_to_country").set("value","");dj.byId("ship_to_name").set("value","");dj.byId("ship_to_street_name").set("value","");dj.byId("ship_to_post_code").set("value","");dj.byId("ship_to_town_name").set("value","");dj.byId("ship_to_country_sub_div").set("value","");dj.byId("ship_to_country").set("value","");dj.byId("consgn_name").set("value","");dj.byId("consgn_street_name").set("value","");dj.byId("consgn_post_code").set("value","");dj.byId("consgn_town_name").set("value","");dj.byId("consgn_country_sub_div").set("value","");dj.byId("consgn_country").set("value","");}},onChangeTranportType:function(){return _fncProcessDivRtgSummary("routing-summary-multimodal-div","routing-summary-individuals-div","transport_type_old",this.id);},onFocusSellerAccount:function(){},onBlurSellerAccount:function(_53,_54,_55){_fncCheckAccountFormat(_53,_54,_55);},onClickCheckPaymentTerms:function(){_fncCheckPaymentTerms("form_payments","po_payment");},onChangeSellerAccountType:function(_56,_57,_58){_fncCheckAccountFormat(_56,_57,_58);},onBlurMatchDate:function(){_fncCheckLastMatchDate(this);},onBlurShipDate:function(){},saveOldFreightChargeType:function(){var _59=dj.byId("freight_charges_type");var _5a=_59.get("value");_59.set("old_value",_5a);},manageFreightButton:function(){var _5b=dj.byId("freight_charges_type")?dj.byId("freight_charges_type").get("value"):"";var _5c=dj.byId("freight_charges_type")?dj.byId("freight_charges_type").get("old_value"):"";var _5d=dj.byId("total_cur_code");var _5e=dj.byId("po-freight-charges");var _5f=dj.byId("prodstatus");if(_5e&&_5e.addButtonNode&&_5d&&_5f){_5e.addButtonNode.set("disabled",_5d.get("value")===""||dj.byId("freight_charges_type").get("value")===""||_5f.get("value")==="A6");}var _60=[];if(_5e&&_5e.store&&_5c&&_5b!==_5c){_5e.clear();}},toggleDisableButtons:function(){var _61=dj.byId("total_cur_code");var _62=dj.byId("prodstatus");var _63=dj.byId("line-items");if(_63&&_63.addButtonNode&&_61){_63.addButtonNode.set("disabled",_61.get("value")==="");}_63=dj.byId("po-adjustments");if(_63&&_63.addButtonNode&&_61){_63.addButtonNode.set("disabled",_61.get("value")==="");}_63=dj.byId("po-taxes");if(_63&&_63.addButtonNode&&_61){_63.addButtonNode.set("disabled",_61.get("value")==="");}if(_62&&_62.get("value")==="A6"){_63=dj.byId("line-items");if(_63&&_63.addButtonNode){_63.addButtonNode.set("disabled",true);}_63=dj.byId("po-adjustments");if(_63&&_63.addButtonNode){_63.addButtonNode.set("disabled",true);}_63=dj.byId("po-taxes");if(_63&&_63.addButtonNode){_63.addButtonNode.set("disabled",true);}}m.manageFreightButton();},saveOldPOCurrency:function(){var _64=dj.byId("total_cur_code");var _65=_64.get("value");_64.set("old_value",_65);},setEAAmounts:function(){var _66=dj.byId("order_total_amt");var _67=dj.byId("accpt_total_amt");var _68=dj.byId("outstanding_total_amt");var _69=dj.byId("order_total_net_amt");var _6a=dj.byId("accpt_total_net_amt");var _6b=dj.byId("outstanding_total_net_amt");var _6c=dj.byId("total_net_amt").get("value");var amt=dj.byId("fake_total_amt").get("value");var _6d=0;var _6e=0;if(_67){_6d=_67.get("value");}if(_6a){_6e=_6a.get("value");}if(dj.byId("original_total_amt")){var _6f=Number(dijit.byId("original_total_amt").get("value").replace(",",""));if(_66){_66.set("value",_6f);}if(_68){_68.set("value",_6f-(amt+_6d));}}if(dj.byId("original_total_net_amt")){var _70=Number(dijit.byId("original_total_net_amt").get("value").replace(",",""));if(_69){_69.set("value",_70);}if(_6b){_6b.set("value",_70-(_6c+_6e));}}},managePOCurrency:function(){var _71=dj.byId("total_cur_code")?dj.byId("total_cur_code").get("value"):"";var _72=dj.byId("total_cur_code")?dj.byId("total_cur_code").get("old_value"):"";if(_71==""){if(_72){misys.dialog.show("CONFIRMATION",misys.getLocalization("resetCurrencyConfirmation"),"",_fncRemoveItemsWithCurrency);misys.connect(dj.byId("cancelButton"),"onClick",function(){dj.byId("total_cur_code").set("value",_72);});}}else{if(dj.byId("fake_total_cur_code")){dj.byId("fake_total_cur_code").set("value",_71);}if(dj.byId("face_total_cur_code")){dj.byId("face_total_cur_code").set("value",_71);}if(dj.byId("adjustment_cur_code")){dj.byId("adjustment_cur_code").set("value",_71);}if(dj.byId("total_net_cur_code")){dj.byId("total_net_cur_code").set("value",_71);}if(dj.byId("tnx_cur_code")){dj.byId("tnx_cur_code").set("value",_71);}if(dj.byId("liab_total_cur_code")){dj.byId("liab_total_cur_code").set("value",_71);}if(dj.byId("total_net_inv_cur_code")){dj.byId("total_net_inv_cur_code").set("value",_71);}if(dj.byId("order_total_cur_code")){dj.byId("order_total_cur_code").set("value",_71);}if(dj.byId("accpt_total_cur_code")){dj.byId("accpt_total_cur_code").set("value",_71);}if(dj.byId("outstanding_total_cur_code")){dj.byId("outstanding_total_cur_code").set("value",_71);}if(dj.byId("pending_total_cur_code")){dj.byId("pending_total_cur_code").set("value",_71);}if(dj.byId("order_total_net_cur_code")){dj.byId("order_total_net_cur_code").set("value",_71);}if(dj.byId("accpt_total_net_cur_code")){dj.byId("accpt_total_net_cur_code").set("value",_71);}if(dj.byId("outstanding_total_net_cur_code")){dj.byId("outstanding_total_net_cur_code").set("value",_71);}if(dj.byId("pending_total_net_cur_code")){dj.byId("pending_total_net_cur_code").set("value",_71);}}},managePOCurrencyAndAmt:function(){m.managePOCurrency();if(dj.byId("total_amt")){dj.byId("total_amt").set("value","");}if(dj.byId("total_adjustments")){dj.byId("total_adjustments").set("value","");}},calculateTotalAmount:function(){var _73=dj.byId("cashCustomizationEnable").get("value");var _74=dj.byId("product_code").get("value");if(dj.byId("total_amt")){var _75=parseFloat(dj.byId("total_amt").get("value"));}if(dj.byId("total_adjustments")){var _76=parseFloat(dj.byId("total_adjustments").get("value"));}if(!isNaN(_76)){if(dj.byId("adjustment_direction_1").get("checked")){_75=_75+_76;}else{if(_74==="IN"){if(_73==="false"||(_73==="true"&&dj.byId("discount_exp_date")&&dj.byId("discount_exp_date").get("value")==null)){_75=_75-_76;}}else{_75=_75-_76;}}}dj.byId("total_net_amt").set("value",_75);},toggleFSCMTransactionDetails:function(_77){var _78=dj.byId("tnx_amt");if(_77&&_77.get("value")==="07"){d.style(d.byId("transactionDetails"),"display","block");if(dj.byId("line-items")&&dj.byId("line-items").grid){dj.byId("line-items").grid.resize();}if(dj.byId("po-payments")&&dj.byId("po-payments").grid){dj.byId("po-payments").grid.resize();}if(dj.byId("po-adjustments")&&dj.byId("po-adjustments").grid){dj.byId("po-adjustments").grid.resize();}if(dj.byId("po-taxes")&&dj.byId("po-taxes").grid){dj.byId("po-taxes").grid.resize();}if(dj.byId("po-freight-charges")&&dj.byId("po-freight-charges").grid){dj.byId("po-freight-charges").grid.resize();}if(dj.byId("po-incoterms")&&dj.byId("po-incoterms").grid){dj.byId("po-incoterms").grid.resize();}if(dj.byId("po-air-routing-summary")&&dj.byId("po-air-routing-summary").grid){dj.byId("po-air-routing-summary").grid.resize();}if(dj.byId("po-sea-routing-summary")&&dj.byId("po-sea-routing-summary").grid){dj.byId("po-sea-routing-summary").grid.resize();}if(dj.byId("po-rail-routing-summary")&&dj.byId("po-rail-routing-summary").grid){dj.byId("po-rail-routing-summary").grid.resize();}if(dj.byId("po-road-routing-summary")&&dj.byId("po-road-routing-summary").grid){dj.byId("po-road-routing-summary").grid.resize();}if(dj.byId("po-multimodal-air-routing-summary")&&dj.byId("po-multimodal-air-routing-summary").grid){dj.byId("po-multimodal-air-routing-summary").grid.resize();}if(dj.byId("po-multimodal-sea-routing-summary")&&dj.byId("po-multimodal-sea-routing-summary").grid){dj.byId("po-multimodal-sea-routing-summary").grid.resize();}if(dj.byId("po-multimodal-place-routing-summary")&&dj.byId("po-multimodal-place-routing-summary").grid){dj.byId("po-multimodal-place-routing-summary").grid.resize();}if(dj.byId("po-multimodal-taking-in-routing-summary")&&dj.byId("po-multimodal-taking-in-routing-summary").grid){dj.byId("po-multimodal-taking-in-routing-summary").grid.resize();}if(dj.byId("po-multimodal-final-destination-routing-summary")&&dj.byId("po-multimodal-final-destination-routing-summary").grid){dj.byId("po-multimodal-final-destination-routing-summary").grid.resize();}if(dj.byId("po-buyer-user-informations")&&dj.byId("po-buyer-user-informations").grid){dj.byId("po-buyer-user-informations").grid.resize();}if(dj.byId("po-seller-user-informations")&&dj.byId("po-seller-user-informations").grid){dj.byId("po-seller-user-informations").grid.resize();}if(_78){_78.set("value",0);_78.set("readOnly",true);}}else{d.style(d.byId("transactionDetails"),"display","none");if(_78&&_77&&_77.get("value")!=="47"){_78.set("value",dj.byId("total_net_amt"));_78.set("readOnly",false);}}},getAdjustmentType:function(_79,_7a){var _7b="";if(_7a){if(_7a.other_type[0]!==""){_7b=_7a.other_type;}else{if(_7a.type[0]!==""){_7b=_7a.type_label;}}}return _7b;},getTransportFreightChargesType:function(_7c,_7d){var _7e="";if(_7d){if(_7d.other_type[0]!==""){_7e=_7d.other_type;}else{if(_7d.type[0]!==""){_7e=_7d.type_label;}}}return _7e;},getAdjustmentAmountRate:function(_7f,_80){var _81="";if(_80){var _82=_80.direction[0];var _83=_82==="ADDD"?"+":"-";if(_80.rate[0]!==""){_81=_83+_80.rate+"%";}else{if(_80.amt!==""){if(typeof _80.amt[0]==="string"){_81=_83+_80.amt;}else{if(typeof _80.amt[0]==="number"&&isFinite(_80.amt[0])){_81=_83+dojo.currency.format(_80.amt,{currency:dj.byId("adjustment_cur_code").get("value")});_81=_81.replace(/[A-Za-z]+/g,"");}}}}}return _81;},getTotalNetAmount:function(_84,_85){var _86="";if(_85&&_85.total_net_amt!==""){if(typeof _85.total_net_amt[0]==="string"){_86=_85.total_net_amt;}else{if(typeof _85.total_net_amt[0]==="number"&&isFinite(_85.total_net_amt[0])){_86=dojo.currency.format(_85.total_net_amt,{currency:dj.byId("line_item_total_net_cur_code").get("value")});_86=_86.replace(/[A-Za-z]+/g,"");}}}return _86;},getQuantity:function(_87,_88){var _89="";if(_88){var _8a=_88.qty_unit_measr_label[0];var _8b=_88.qty_val[0];_89=_8b+" "+_8a;}return _89;},getPaymentType:function(_8c,_8d){var _8e="";var _8f="";if(_8d){if(_8d.nb_days!==""){_8f=" (+"+_8d.nb_days+" "+m.getLocalization("paymentDays")+")";}if(_8d.code!==""){_8e=_8d.label+_8f;}else{if(_8d.other_paymt_terms!==""){_8e=_8d.other_paymt_terms+_8f;}}}return _8e;},getContactName:function(_90,_91){var _92="";if(_91){return m.getLocalization(_91.name_prefix)+" "+_91.name_value;}return _92;},getPaymentAmountRate:function(_93,_94){var _95="";if(_94){if(_94.pct!=""){_95="+"+_94.pct+"%";}else{if(_94.amt!=""){if(typeof _94.amt[0]==="string"){_95="+"+_94.amt;}else{if(typeof _94.amt[0]==="number"&&isFinite(_94.amt[0])){_95="+"+dojo.currency.format(_94.amt);}}}}}return _95;},getAmountRate:function(_96,_97){var _98="";if(_97){if(_97.rate!=""){_98="+"+_97.rate+"%";}else{if(_97.amt!=""){if(typeof _97.amt[0]==="string"){_98="+"+_97.amt;}else{if(typeof _97.amt[0]==="number"&&isFinite(_97.amt[0])){_98="+"+dojo.currency.format(_97.amt,{currency:dj.byId("adjustment_cur_code").get("value")});_98=_98.replace(/[A-Za-z]+/g,"");}}}}}return _98;},getFreightAmount:function(_99,_9a){var _9b="";if((_9a)&&(_9a.amt!=="")){if(typeof _9a.amt[0]==="string"){_9b="+"+_9a.amt;}else{if(typeof _9a.amt[0]==="number"&&isFinite(_9a.amt[0])){_9b="+"+dojo.currency.format(_9a.amt);}}}return _9b;},checkRoutingSummaryUnicity:function(_9c){if((dj.byId("transport_type").get("value")==="0")&&_9c!==d.byId("transport_type")){return true;}else{if(_9c!==d.byId("transport_type")){dj.byId("transport_type").set("value","0");return false;}}var _9d=new RegExp("po_line_item_display_details_([1-9]{1}[0-9]*)");var _9e=document.forms["form_goods"].getElementsByTagName("div");for(var i=0;i<_9e.length;i++){var _9f=_9e[i].getAttribute("id");var _a0=_9e[i].getAttribute("style");if(_9f===null){continue;}if(_a0!==null&&typeof _a0==="object"){_a0=_a0.cssText;}var res=_9f.match(_9d);if(res){var _a1=res[1];if(document.forms["form_goods"].elements["transport_type_"+_a1].selectedIndex!==0){misys.dialog.show("ERROR",misys.getLocalization("tooManyRoutingSummariesError"));_9c.selectedIndex=0;_9c.blur();return false;}}}return true;},checkLastShipDateUnicity:function(_a2){if((dj.byId("last_ship_date").get("value")==="")&&_a2!==d.byId("last_ship_date")){return true;}else{if(d.byId(_a2)!==d.byId("last_ship_date")){dj.byId("last_ship_date").set("value",null);dj.byId(_a2).blur();return false;}}var _a3=new RegExp("po_line_item_display_details_([1-9]{1}[0-9]*)");d.query("#form_goods > div");for(var i=0;i<divs.length;i++){var _a4=divs[i].getAttribute("id");var _a5=divs[i].getAttribute("style");if(_a4==null){continue;}if(_a5!==null&&typeof _a5==="object"){_a5=_a5.cssText;}var res=_a4.match(_a3);if(res){var _a6=res[1];if("S"+document.forms["form_goods"].elements["po_line_item_details_last_ship_date_"+_a6].value!=="S"){misys.dialog.show("ERROR",misys.getLocalization("tooManyLastShipmentDatesError"));_a2.value="";_a2.blur();return false;}}}return true;},checkLastShipDate:function(_a7){var _a8;if(_a7&&_a7.value){var _a9=document.forms["fakeform1"].appl_date.value;if(!m.compareDateFields(_a9,_a7.value)){_a8=m.getLocalization("lastShipmentDateLessThanAppDateError",[_46(_a7.value),_46(_a9)]);misys.dialog.show("ERROR",_a8);_a7.value="";_a7.focus();}var _aa=document.forms["fakeform1"].exp_date.value;if(!m.compareDateFields(_a7.value,_aa)){_a8=m.getLocalization("expiryDateLessThanLastShipmentError",[_46(_aa),_46(_a7.value)]);misys.dialog.show("ERROR",_a8);_a7.value="";_a7.focus();}}else{_a7.value="";_a7.focus();}return true;},computeLineItemAmount:function(){var _ab=dj.byId("line_item_total_cur_code").get("value");var _ac=dj.byId("line_item_qty_val");var _ad=_ac?_ac.get("value"):"";if(_ad==0){m.dialog.show("ERROR",m.getLocalization("lineItemQuantityInvalidValue"));_ac.set("value","");return;}var _ae=dj.byId("line_item_qty_unit_measr_code").get("value");var _af=dj.byId("line_item_price_unit_measr_code").get("value");var _b0=dj.byId("line_item_price_amt").get("value");var _b1=dj.byId("line_item_total_amt").get("value");if(_b0&&_ad){_b1=(_ad*_b0);if(_b1.toString().split(".")[0].length>13){m.dialog.show("ERROR",m.getLocalization("lineItemNetAmountOutOfRange"));dj.byId("line_item_total_amt").set("value","");return;}dj.byId("line_item_total_amt").set("readOnly",true);}else{_b1="";dj.byId("line_item_total_amt").set("readOnly",false);}dj.byId("line_item_total_amt").set("value",_b1);_fncComputeLineItemNetAmount();},computePOTotalAmount:function(){var _b2=0;var _b3=dj.byId("line-items");if(_b3&&_b3.grid){_b3.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_b4,_b5){for(var _b6 in _b4){var _b7=_b4[_b6];var _b8=dojo.isArray(_b7.total_net_amt)?_b7.total_net_amt[0]:_b7.total_net_amt;_b2=_getValueAsNumber(_b2)+_getValueAsNumber(_b8);}})});}if(_b2>=0&&dj.byId("fake_total_amt")){dj.byId("fake_total_amt").set("value",_b2);_fncComputePONetAmount();}else{if(dj.byId("fake_total_amt")){dj.byId("fake_total_amt").set("value","");}if(dj.byId("total_net_amt")){dj.byId("total_net_amt").set("value","");}}},setContactDetails:function(){dj.byId("contact_type_decode").set("value",this.get("displayedValue"));if(this.get("value")==="08"&&dj.byId("contact_bic")){dj.byId("contact_bic").set("disabled",false);m.toggleRequired("contact_bic",true);}else{dj.byId("contact_bic").set("value","");dj.byId("contact_bic").set("disabled",true);m.toggleRequired("contact_bic",false);}},isValidContact:function(){var _b9="";var _ba=false;var _bb=false;var _bc=dj.byId("contact-details");if(_bc&&_bc.grid){_bc.grid.store.fetch({query:{type:"*"},onComplete:dojo.hitch(_bc,function(_bd,_be){dojo.forEach(_bd,function(_bf){if(_bf.type[0]==="03"){_ba=true;}else{if(_bf.type[0]==="04"){_bb=true;}}});})});if((_ba&&_bb)){_b9=misys.getLocalization("contactEitherBuyerbankOrSellerbank");}else{if(!_ba&&!_bb){_b9=misys.getLocalization("contactDetailsError");}}}return _b9;},checkLineItemChildrens:function(){var _c0=false;var _c1=dj.byId("line-items");if(_c1&&_c1.grid){_c1.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_c2,_c3){for(var _c4 in _c2){if(_c2[_c4].taxes[0]._values.length>0){_c0=true;}if(_c2[_c4].adjustments[0]._values.length>0){_c0=true;}if(_c2[_c4].freight_charges[0]._values.length>0){_c0=true;}if(_c2[_c4].incoterms[0]._values.length>0){_c0=true;}if((_c2[_c4].air_routing_summaries&&_c2[_c4].air_routing_summaries[0]._values.length>0)||(_c2[_c4].sea_routing_summaries&&_c2[_c4].sea_routing_summaries[0]._values.length>0)||(_c2[_c4].road_routing_summaries&&_c2[_c4].road_routing_summaries[0]._values.length>0)||(_c2[_c4].rail_routing_summaries&&_c2[_c4].rail_routing_summaries[0]._values.length>0)||(_c2[_c4].final_dest_place&&_c2[_c4].final_dest_place[0].length>0)||(_c2[_c4].taking_in_charge&&_c2[_c4].taking_in_charge[0].length>0)){_c0=true;}}})});}return _c0;},checkPOChildrens:function(){var _c5=false;var _c6=dj.byId("po-adjustments");if(_c6&&_c6.store&&_c6.store._arrayOfTopLevelItems.length>0){_c5=true;}var _c7=dj.byId("po-taxes");if(_c7&&_c7.store&&_c7.store._arrayOfTopLevelItems.length>0){_c5=true;}var _c8=dj.byId("po-freight-charges");if(_c8&&_c8.store&&_c8.store._arrayOfTopLevelItems.length>0){_c5=true;}var _c9=dj.byId("misys_openaccount_widget_Incoterms_0");if(_c9&&_c9.store&&_c9.store._arrayOfTopLevelItems.length>0){_c5=true;}var _ca=dj.byId("air_routing_summaries");var _cb=dj.byId("sea_routing_summaries");var _cc=dj.byId("road_routing_summaries");var _cd=dj.byId("rail_routing_summaries");var _ce=dj.byId("taking_in_charge");var _cf=dj.byId("final_dest_place");if((_ca&&_ca.store&&_ca.store._arrayOfTopLevelItems.length>0)||(_cb&&_cb.store&&_cb.store._arrayOfTopLevelItems.length>0)||(_cc&&_cc.store&&_cc.store._arrayOfTopLevelItems.length>0)||(_cd&&_cd.store&&_cd.store._arrayOfTopLevelItems.length>0)||(_ce&&_ce.value!=="")||(_cf&&_cf.value!=="")){_c5=true;}return _c5;},validateIBANAccountNo:function(){var _d0=this.get("value");if("S"+_d0=="S"){return true;}var _d1=/^[a-zA-Z]{2,2}[0-9]{2,2}[a-zA-Z0-9]{1,30}$/;if(_d1.test(_d0)){return true;}misys.dialog.show("ERROR",misys.getLocalization("invalidIBANAccNoError",[_d0]));this.set("value","");return false;},validateBBANAccountNo:function(){var _d2=this.get("value");if("S"+_d2=="S"){return true;}var _d3=/^[a-zA-Z0-9]{1,30}$/;if(_d3.test(_d2)){return true;}misys.dialog.show("ERROR",misys.getLocalization("invalidBBANAccNoError",[_d2]));this.set("value","");return false;},validateUPICAccountNo:function(){var _d4=this.get("value");if("S"+_d4==="S"){return true;}var _d5=/^[0-9]{8,17}$/;if(_d5.test(_d4)){return true;}misys.dialog.show("ERROR",misys.getLocalization("invalidUPICAccNoError",[_d4]));this.set("value","");return false;},getMaxBPOExpDate:function(){var _d6=null;var _d7=dj.byId("bank-payment-obligations");if(_d7&&_d7.store&&_d7.store._arrayOfTopLevelItems.length>0){_d7.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_d7,function(_d8,_d9){dojo.forEach(_d8,function(_da){if(_da.payment_expiry_date[0]!==""){var _db=dojo.date.locale.parse(_da.payment_expiry_date[0],{locale:dojo.config.locale,formatLength:"short",selector:"date"});if(_d6==null){_d6=_db;}else{if(_d6<_db){_d6=_db;}}}});})});}return _d6;},getMaxBPOExpiryDate:function(){var _dc=new Date();_dc.setHours(0,0,0,0);var _dd=false;var _de=dj.byId("bank-payment-obligations");if(_de&&_de.store&&_de.store._arrayOfTopLevelItems.length>0){_de.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_de,function(_df,_e0){dojo.forEach(_df,function(_e1){if(_e1.payment_expiry_date[0]!==""){var _e2=dojo.date.locale.parse(_e1.payment_expiry_date[0],{locale:dojo.config.locale,formatLength:"short",selector:"date"});if(_dc<_e2){_dc=_e2;_dd=true;}}});})});}return _dd?_dc:"";},getLeastBPOExpiryDate:function(){var _e3="";var _e4=dj.byId("bank-payment-obligations");if(_e4&&_e4.store&&_e4.store._arrayOfTopLevelItems.length>0){_e4.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_e4,function(_e5,_e6){dojo.forEach(_e5,function(_e7){if(_e7.payment_expiry_date[0]!==""){var _e8=dojo.date.locale.parse(_e7.payment_expiry_date[0],{locale:dojo.config.locale,formatLength:"short",selector:"date"});if(_e3==""){_e3=_e8;}else{if(_e8<_e3){_e3=_e8;}}}});})});}return _e3;},updateOpenAccountExpiryDate:function(){var _e9;if(dj.byId("exp_date")&&dj.byId("exp_date").get("value")!==""){_e9=dj.byId("exp_date").get("value");}var _ea=m.getMaxBPOExpiryDate();if(_ea!==""&&_e9!==""){if(_e9<_ea){dj.byId("exp_date").set("value",_ea);}}},performPartialShipmentActions:function(){var _eb=dj.byId("line-items");if(_eb&&_eb.grid){_eb.grid.store.fetch({query:{store_id:"*"},onComplete:d.hitch(this,function(_ec,_ed){for(var _ee in _ec){if(_ec[_ee].taxes[0]._values.length>0){exist=true;}if(_ec[_ee].adjustments[0]._values.length>0){exist=true;}if(_ec[_ee].freight_charges[0]._values.length>0){exist=true;}if(_ec[_ee].incoterms[0]._values.length>0){exist=true;}}})});}},getPaymentDisplayedValue:function(_ef,_f0){var _f1="";if(_f0){if(_f0.code_desc&&_f0.code_desc[0]&&_f0.code_desc[0]!==""){_f1=_f0.code_desc[0];}else{if((_f0.code&&_f0.code[0]&&_f0.code[0]!=="")||(_f0.payment_code&&_f0.payment_code[0]&&_f0.payment_code[0]!=="")){_f1=(_f0.code&&_f0.code[0]&&_f0.code[0]!=="")?_f0.code[0]:(_f0.payment_code&&_f0.payment_code[0]&&_f0.payment_code[0]!=="")?_f0.payment_code[0]:"";}else{if((_f0.other_paymt_terms&&_f0.other_paymt_terms[0]&&_f0.other_paymt_terms[0]!=="")||(_f0.payment_other_term&&_f0.payment_other_term[0]&&_f0.payment_other_term[0]!=="")){_f1=(_f0.other_paymt_terms&&_f0.other_paymt_terms[0]&&_f0.other_paymt_terms[0]!=="")?_f0.other_paymt_terms[0]:(_f0.payment_other_term&&_f0.payment_other_term[0]&&_f0.payment_other_term[0]!=="")?_f0.payment_other_term[0]:"";}}}}return _f1;},oaOnLoadActions:function(){var _f2=dj.byId("air_routing_summaries");var _f3=dj.byId("sea_routing_summaries");var _f4=dj.byId("road_routing_summaries");var _f5=dj.byId("rail_routing_summaries");var _f6=dj.byId("line_item_air_routing_summaries");var _f7=dj.byId("line_item_sea_routing_summaries");var _f8=dj.byId("line_item_road_routing_summaries");var _f9=dj.byId("line_item_rail_routing_summaries");if(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_earliest_ship_date").get("value")!==null&&dj.byId("dijit_form_Button_8")){dj.byId("dijit_form_Button_8").set("disabled",true);dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",true):"";dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",true):"";}else{if(dj.byId("dijit_form_Button_8")){if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")!==true){dj.byId("dijit_form_Button_8").set("disabled",false);}dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",false):"";dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",false):"";}}if(dj.byId("line_item_last_ship_date")&&dj.byId("line_item_last_ship_date").get("value")!==null&&dj.byId("dijit_form_Button_8")){dj.byId("dijit_form_Button_8").set("disabled",true);dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",true):"";dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",true):"";}else{if(dj.byId("dijit_form_Button_8")){if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")!==true){dj.byId("dijit_form_Button_8").set("disabled",false);}dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",false):"";dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",false):"";}}if(dj.byId("line_item_shipment_schedules")&&dj.byId("line_item_last_ship_date")&&dj.byId("line_item_earliest_ship_date")){var _fa=dj.byId("line_item_shipment_schedules");var _fb=false;if(_fa&&_fa.store&&_fa.store._arrayOfTopLevelItems.length>0){_fb=true;}dj.byId("line_item_last_ship_date").set("disabled",_fb);dj.byId("line_item_earliest_ship_date").set("disabled",_fb);}else{if(dj.byId("line_item_last_ship_date")&&dj.byId("line_item_earliest_ship_date")){dj.byId("line_item_last_ship_date").set("disabled",false);dj.byId("line_item_earliest_ship_date").set("disabled",false);}}if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")===true){_f6.clear();_f7.clear();_f8.clear();_f9.clear();}if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")===true&&dj.byId("add_payment_term_button")){var _fc=dj.byId("po-payments");var _fd=false;if(_fc&&_fc.store&&_fc.store._arrayOfTopLevelItems.length>0){_fd=true;}dj.byId("add_payment_term_button").set("disabled",_fd);}else{dj.byId("add_payment_term_button").set("disabled",false);}if(dj.byId("tran_ship_2")&&dj.byId("tran_ship_2").get("checked")===true&&dj.byId("taking_in_charge")&&dj.byId("final_dest_place")){dj.byId("taking_in_charge").set("value","");dj.byId("final_dest_place").set("value","");dj.byId("taking_in_charge").set("disabled",true);dj.byId("final_dest_place").set("disabled",true);if((_f2&&_f2.store&&_f2.store._arrayOfTopLevelItems.length>0)||(_f3&&_f3.store&&_f3.store._arrayOfTopLevelItems.length>0)||(_f4&&_f4.store&&_f4.store._arrayOfTopLevelItems.length>0)||(_f5&&_f5.store&&_f5.store._arrayOfTopLevelItems.length>0)){_f2.addButtonNode.set("disabled",true);_f3.addButtonNode.set("disabled",true);_f4.addButtonNode.set("disabled",true);_f5.addButtonNode.set("disabled",true);}}else{if(dj.byId("taking_in_charge")&&dj.byId("final_dest_place")){dj.byId("taking_in_charge").set("disabled",false);dj.byId("final_dest_place").set("disabled",false);}}if(dj.byId("pmt_term_other_code")&&dj.byId("pmt_term_other_code").get("checked")===true){dojo.style(dojo.byId("details_other_paymt_terms_row"),"display","block");dj.byId("details_other_paymt_terms").set("required",true);}else{if(dj.byId("pmt_term_other_code")){dojo.style(dojo.byId("details_other_paymt_terms_row"),"display","none");dj.byId("details_other_paymt_terms").set("required",false);}}if(dj.byId("pmt_term_code")&&dj.byId("pmt_term_code").get("checked")===true){dojo.style(dojo.byId("paymentTermCode"),"display","block");dj.byId("details_code").set("required",true);}else{if(dj.byId("pmt_term_code")){dojo.style(dojo.byId("paymentTermCode"),"display","none");dj.byId("details_code").set("required",false);}}if(dj.byId("credtr_name_address").get("checked")===true&&d.byId("settlement_creditor_agent_name")){d.style(d.byId("settlement_creditor_agent_name"),"display","block");dj.byId("fin_inst_name").set("required",true);dj.byId("fin_inst_post_code").set("required",true);dj.byId("fin_inst_town_name").set("required",true);dj.byId("fin_inst_country").set("required",true);}else{if(d.byId("settlement_creditor_agent_name")){d.style(d.byId("settlement_creditor_agent_name"),"display","none");dj.byId("fin_inst_name").set("required",false);dj.byId("fin_inst_post_code").set("required",false);dj.byId("fin_inst_town_name").set("required",false);dj.byId("fin_inst_country").set("required",false);dj.byId("fin_inst_name").set("value","");dj.byId("fin_inst_post_code").set("value","");dj.byId("fin_inst_town_name").set("value","");dj.byId("fin_inst_country").set("value","");}}if(dj.byId("credtr_bic").get("checked")===true&&d.byId("settlement_creditor_agent_bic")){d.style(d.byId("settlement_creditor_agent_bic"),"display","block");dj.byId("fin_inst_bic").set("required",true);}else{if(d.byId("settlement_creditor_agent_bic")){d.style(d.byId("settlement_creditor_agent_bic"),"display","none");dj.byId("fin_inst_bic").set("required",false);dj.byId("fin_inst_bic").set("value","");}}if(dj.byId("fin_account_iban").get("checked")===true&&d.byId("seller_account_iban_row")){d.style(d.byId("seller_account_iban_row"),"display","block");dj.byId("seller_account_iban").set("required",true);}else{if(d.byId("seller_account_iban_row")){d.style(d.byId("seller_account_iban_row"),"display","none");dj.byId("seller_account_iban").set("required",false);}}if(dj.byId("fin_account_bban").get("checked")===true&&d.byId("seller_account_bban_row")){d.style(d.byId("seller_account_bban_row"),"display","block");dj.byId("seller_account_bban").set("required",true);}else{if(d.byId("seller_account_bban_row")){d.style(d.byId("seller_account_bban_row"),"display","none");dj.byId("seller_account_bban").set("required",false);}}if(dj.byId("fin_account_upic").get("checked")===true&&d.byId("seller_account_upic_row")){d.style(d.byId("seller_account_upic_row"),"display","block");dj.byId("seller_account_upic").set("required",true);}else{if(d.byId("seller_account_upic_row")){d.style(d.byId("seller_account_upic_row"),"display","none");dj.byId("seller_account_upic").set("required",false);}}if(dj.byId("fin_account_prop").get("checked")===true&&d.byId("seller_account_id_row")){d.style(d.byId("seller_account_id_row"),"display","block");dj.byId("seller_account_id").set("required",true);}else{if(d.byId("seller_account_id_row")){d.style(d.byId("seller_account_id_row"),"display","none");dj.byId("seller_account_id").set("required",false);}}if(dj.byId("crdtr_act_code").get("checked")===true&&d.byId("seller_account_type_code_row")){d.style(d.byId("seller_account_type_code_row"),"display","block");dj.byId("seller_account_type_code").set("required",true);}else{if(d.byId("seller_account_type_code")){d.style(d.byId("seller_account_type_code_row"),"display","none");dj.byId("seller_account_type_code").set("required",false);}}if(dj.byId("crdtr_act_prop").get("checked")===true&&d.byId("seller_account_type_prop_row")){d.style(d.byId("seller_account_type_prop_row"),"display","block");dj.byId("seller_account_type_prop").set("required",true);}else{if(d.byId("seller_account_type_prop_row")){d.style(d.byId("seller_account_type_prop_row"),"display","none");dj.byId("seller_account_type_prop").set("required",false);}}if((dj.byId("last_ship_date")&&dj.byId("last_ship_date").get("value")!==null)||(dj.byId("earliest_ship_date")&&dj.byId("earliest_ship_date").get("value")!==null)){if(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_last_ship_date")&&dj.byId("dijit_form_Button_8")){dj.byId("line_item_earliest_ship_date").set("value",null);dj.byId("line_item_earliest_ship_date").set("disabled",true);dj.byId("line_item_last_ship_date").set("value",null);dj.byId("line_item_last_ship_date").set("disabled",true);dj.byId("dijit_form_Button_8").set("disabled",true);}}else{if((dj.byId("last_ship_date")&&dj.byId("last_ship_date").get("value")===null)&&(dj.byId("earliest_ship_date")&&dj.byId("earliest_ship_date").get("value")===null)){if(dj.byId("line_item_last_ship_date")&&dj.byId("line_item_earliest_ship_date")&&dj.byId("dijit_form_Button_8")){dj.byId("line_item_earliest_ship_date").set("disabled",false);dj.byId("line_item_last_ship_date").set("disabled",false);if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")!==true){dj.byId("dijit_form_Button_8").set("disabled",false);}}}}if((dj.byId("tnxtype")&&(dj.byId("tnxtype").get("value")!=="38"))||(dj.byId("close_tnx")&&(dj.byId("close_tnx").get("checked")===false))){m.updateOpenAccountExpiryDate();}if(m.hasLineItemShipmentPeriodDefined()){dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",true):"";dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",true):"";}else{dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",false):"";dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",false):"";}var _fe=dj.byId("commercial-ds");if((_fe&&_fe.store&&_fe.store._arrayOfTopLevelItems.length>0)){dj.byId("add_commercial_ds_button").set("disabled",true);}var _ff=dj.byId("insurance-ds-details");if((_ff&&_ff.store&&_ff.store._arrayOfTopLevelItems.length>0)){dj.byId("add_insurance_ds_button").set("disabled",true);}var _100=dj.byId("transport-ds-details");if((_100&&_100.store&&_100.store._arrayOfTopLevelItems.length>0)){dj.byId("add_transport_ds_button").set("disabled",true);}var _101=dj.byId("payment-transport-ds-details");if((_101&&_101.store&&_101.store._arrayOfTopLevelItems.length>0)){dj.byId("add_pymt_transport_ds_button").set("disabled",true);}var _102=dijit.byId("consignment_qty_details_id");if(_102){_102.updateData();if(_102.store&&_102.store._arrayOfTopLevelItems&&_102.store._arrayOfTopLevelItems.length>0){var _103=_102.store._arrayOfTopLevelItems;if(_103&&_103[0]&&_103[0].pmt_tds_qty_unit_measr_code&&_103[0].pmt_tds_qty_unit_measr_code[0]!==""&&_103[0].pmt_tds_qty_val&&_103[0].pmt_tds_qty_val[0]!==""){_102.addButtonNode.set("disabled",true);}else{_102.addButtonNode.set("disabled",false);}}else{_102.addButtonNode.set("disabled",false);}}var _104=dijit.byId("consignment_vol_details_id");if(_104){_104.updateData();if(_104.store&&_104.store._arrayOfTopLevelItems&&_104.store._arrayOfTopLevelItems.length>0){var _105=_104.store._arrayOfTopLevelItems;if(_105&&_105[0]&&_105[0].pmt_tds_vol_unit_measr_code&&_105[0].pmt_tds_vol_unit_measr_code[0]!==""&&_105[0].pmt_tds_vol_val&&_105[0].pmt_tds_vol_val[0]!==""){_104.addButtonNode.set("disabled",true);}else{_104.addButtonNode.set("disabled",false);}}else{_104.addButtonNode.set("disabled",false);}}var _106=dijit.byId("consignment_weight_details_id");if(_106){_106.updateData();if(_106.store&&_106.store._arrayOfTopLevelItems&&_106.store._arrayOfTopLevelItems.length>0){var _107=_106.store._arrayOfTopLevelItems;if(_107&&_107[0]&&_107[0].pmt_tds_weight_unit_measr_code&&_107[0].pmt_tds_weight_unit_measr_code[0]!==""&&_107[0].pmt_tds_weight_val&&_107[0].pmt_tds_weight_val[0]!==""){_106.addButtonNode.set("disabled",true);}else{_106.addButtonNode.set("disabled",false);}}else{_106.addButtonNode.set("disabled",false);}}if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")===true){m.clearLineItemDetail();dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",false):"";dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",false):"";}},oaCommonBindEvents:function(){m.setValidation("earliest_ship_date",m.validateEarliestShipDate);m.setValidation("line_item_last_ship_date",m.validateOALastShipmentDate);m.setValidation("line_item_earliest_ship_date",m.validateEarliestShipDate);m.setValidation("schedule_earliest_ship_date",m.validateEarliestShipDate);m.setValidation("schedule_latest_ship_date",m.validateOALastShipmentDate);m.setValidation("exp_date",m.validateOpenAccountExpiryDate);m.setValidation("payment_expiry_date",m.validateBPOExpiryDate);m.setValidation("last_match_date",m.validateLastMatchDate);m.connect("creditor_account_id_iban","onChange",m.validateIBANAccountNo);m.connect("creditor_account_id_bban","onChange",m.validateBBANAccountNo);m.connect("creditor_account_id_upic","onChange",m.validateUPICAccountNo);m.connect("line_item_earliest_ship_date","onChange",function(){if(dj.byId("line_item_earliest_ship_date").get("value")!==null&&dj.byId("dijit_form_Button_8")&&dj.byId("last_ship_date")&&dj.byId("earliest_ship_date")){dj.byId("last_ship_date").set("disabled",true);dj.byId("earliest_ship_date").set("disabled",true);dj.byId("dijit_form_Button_8").set("disabled",true);}else{if(dj.byId("line_item_last_ship_date")&&dj.byId("line_item_last_ship_date").get("value")===null&&dj.byId("dijit_form_Button_8")&&dj.byId("last_ship_date")&&dj.byId("earliest_ship_date")){dj.byId("last_ship_date").set("disabled",false);dj.byId("earliest_ship_date").set("disabled",false);if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")!==true){dj.byId("dijit_form_Button_8").set("disabled",false);}}}});m.connect("line_item_last_ship_date","onChange",function(){if(dj.byId("line_item_last_ship_date").get("value")!==null&&dj.byId("dijit_form_Button_8")&&dj.byId("last_ship_date")&&dj.byId("earliest_ship_date")){dj.byId("dijit_form_Button_8").set("disabled",true);dj.byId("last_ship_date").set("disabled",true);dj.byId("earliest_ship_date").set("disabled",true);}else{if(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_earliest_ship_date").get("value")===null&&dj.byId("dijit_form_Button_8")&&dj.byId("last_ship_date")&&dj.byId("earliest_ship_date")){dj.byId("last_ship_date").set("disabled",false);dj.byId("earliest_ship_date").set("disabled",false);if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")!==true){dj.byId("dijit_form_Button_8").set("disabled",false);}}}});m.setValidation("last_ship_date",m.validateOALastShipmentDate);m.connect("part_ship_2","onChange",function(){var bool=false;if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")===true){var _108=dj.byId("po-payments");if(_108&&_108.store&&_108.store._arrayOfTopLevelItems.length>0){_108.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_108,function(_109,_10a){dojo.forEach(_109,function(item){bool=true;});})});}if(dj.byId("line-items")&&dj.byId("line-items").store&&dj.byId("line-items").store._arrayOfTopLevelItems.length>0){m.dialog.show("CONFIRMATION",m.getLocalization("clearLineItemShipmentDetails"),"","","","",function(){m.clearLineItemDetail();},function(){dj.byId("part_ship_2").set("checked",false);dj.byId("part_ship_1").set("checked",true);});}}dj.byId("last_ship_date")?dj.byId("last_ship_date").set("disabled",false):"";dj.byId("earliest_ship_date")?dj.byId("earliest_ship_date").set("disabled",false):"";dj.byId("add_payment_term_button")?dj.byId("add_payment_term_button").set("disabled",bool):"";});m.connect("tran_ship_2","onChange",function(){var _10b=dj.byId("air_routing_summaries");var _10c=dj.byId("sea_routing_summaries");var _10d=dj.byId("road_routing_summaries");var _10e=dj.byId("rail_routing_summaries");var _10f=dj.byId("line_item_air_routing_summaries");var _110=dj.byId("line_item_sea_routing_summaries");var _111=dj.byId("line_item_road_routing_summaries");var _112=dj.byId("line_item_rail_routing_summaries");if(dj.byId("tran_ship_2")&&dj.byId("tran_ship_2").get("checked")===true){if((_10b&&_10b.store&&_10b.store._arrayOfTopLevelItems.length>0)||(_10c&&_10c.store&&_10c.store._arrayOfTopLevelItems.length>0)||(_10d&&_10d.store&&_10d.store._arrayOfTopLevelItems.length>0)||(_10e&&_10e.store&&_10e.store._arrayOfTopLevelItems.length>0)){m.dialog.show("CONFIRMATION",m.getLocalization("clearTransShipmentDetails"),"","","","",function(){_10b.clear();_10c.clear();_10d.clear();_10e.clear();if(dj.byId("taking_in_charge")&&dj.byId("final_dest_place")){dj.byId("taking_in_charge").set("value","");dj.byId("final_dest_place").set("value","");dj.byId("taking_in_charge").set("disabled",true);dj.byId("final_dest_place").set("disabled",true);}},function(){dj.byId("tran_ship_2").set("checked",false);dj.byId("tran_ship_1").set("checked",true);});}if((dj.byId("line-items")&&dj.byId("line-items").store&&dj.byId("line-items").store._arrayOfTopLevelItems.length>0)||dj.byId("taking_in_charge").get("value")!==""||dj.byId("final_dest_place").get("value")!==""){m.dialog.show("CONFIRMATION",m.getLocalization("clearTransShipmentDetails"),"","","","",function(){var _113=dj.byId("line-items");if(_113&&_113.store&&_113.store._arrayOfTopLevelItems.length>0){_113.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_113,function(_114,_115){dojo.forEach(_114,function(item){if(item.air_routing_summaries&&item.air_routing_summaries[0]){item.air_routing_summaries[0]._values=[];}if(item.sea_routing_summaries&&item.sea_routing_summaries[0]){item.sea_routing_summaries[0]._values=[];}if(item.rail_routing_summaries&&item.rail_routing_summaries[0]){item.rail_routing_summaries[0]._values=[];}if(item.road_routing_summaries&&item.road_routing_summaries[0]){item.road_routing_summaries[0]._values=[];}if(item.taking_in_charge&&item.taking_in_charge[0]){item.taking_in_charge[0]="";}if(item.final_dest_place&&item.final_dest_place[0]){item.final_dest_place[0]="";}});})});}if(dj.byId("taking_in_charge")&&dj.byId("final_dest_place")){dj.byId("taking_in_charge").set("value","");dj.byId("final_dest_place").set("value","");dj.byId("taking_in_charge").set("disabled",true);dj.byId("final_dest_place").set("disabled",true);}},function(){dj.byId("tran_ship_2").set("checked",false);dj.byId("tran_ship_1").set("checked",true);});}dj.byId("taking_in_charge")?dj.byId("taking_in_charge").set("disabled",true):"";dj.byId("final_dest_place")?dj.byId("final_dest_place").set("disabled",true):"";}else{dj.byId("taking_in_charge")?dj.byId("taking_in_charge").set("disabled",false):"";dj.byId("final_dest_place")?dj.byId("final_dest_place").set("disabled",false):"";dj.byId("line_item_taking_in_charge")?dj.byId("line_item_taking_in_charge").set("disabled",false):"";dj.byId("line_item_final_dest_place")?dj.byId("line_item_final_dest_place").set("disabled",false):"";_10b.addButtonNode.set("disabled",false);_10c.addButtonNode.set("disabled",false);_10d.addButtonNode.set("disabled",false);_10e.addButtonNode.set("disabled",false);_10f.addButtonNode.set("disabled",false);_110.addButtonNode.set("disabled",false);_111.addButtonNode.set("disabled",false);_112.addButtonNode.set("disabled",false);}});m.connect("earliest_ship_date","onBlur",function(){if(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_last_ship_date")&&dj.byId("dijit_form_Button_8")&&this.get("value")!==null){dj.byId("line_item_earliest_ship_date").set("value",null);dj.byId("line_item_earliest_ship_date").set("disabled",true);dj.byId("line_item_last_ship_date").set("value",null);dj.byId("line_item_last_ship_date").set("disabled",true);dj.byId("dijit_form_Button_8").set("disabled",true);}else{if(dj.byId("line_item_last_ship_date")&&dj.byId("line_item_earliest_ship_date")&&dj.byId("dijit_form_Button_8")&&this.get("value")===null){dj.byId("line_item_earliest_ship_date").set("disabled",false);dj.byId("line_item_last_ship_date").set("disabled",false);dj.byId("dijit_form_Button_8").set("disabled",false);}}});m.connect("last_ship_date","onBlur",function(){if(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_last_ship_date")&&dj.byId("dijit_form_Button_8")&&this.get("value")!==null){dj.byId("line_item_earliest_ship_date").set("value",null);dj.byId("line_item_earliest_ship_date").set("disabled",true);dj.byId("line_item_last_ship_date").set("value",null);dj.byId("line_item_last_ship_date").set("disabled",true);dj.byId("dijit_form_Button_8").set("disabled",true);}else{if(dj.byId("line_item_last_ship_date")&&dj.byId("line_item_earliest_ship_date")&&dj.byId("dijit_form_Button_8")&&this.get("value")===null){dj.byId("line_item_earliest_ship_date").set("disabled",false);dj.byId("line_item_last_ship_date").set("disabled",false);dj.byId("dijit_form_Button_8").set("disabled",false);}}});m.setValidation("details_cur_code",m.validateCurrency);m.setValidation("fin_inst_country",m.validateCountry);m.connect("details_cur_code","onChange",function(){m.setCurrency(this,["details_amt"]);});m.connect("details_amt","onChange",function(){m.toggleMutuallyExclusiveMandatoryFields(["details_amt","details_pct"]);});m.connect("details_amt","onBlur",function(){m.toggleMutuallyExclusiveMandatoryFields(["details_amt","details_pct"]);});m.connect("details_pct","onChange",function(){m.toggleMutuallyExclusiveMandatoryFields(["details_amt","details_pct"]);});m.connect("details_pct","onBlur",function(){m.toggleMutuallyExclusiveMandatoryFields(["details_amt","details_pct"]);});m.connect("pmt_term_code","onChange",function(){if(dj.byId("pmt_term_code")&&dj.byId("pmt_term_code").get("checked")===true){dojo.style(dojo.byId("paymentTermCode"),"display","block");dj.byId("details_code").set("disabled",false);dj.byId("details_nb_days").set("disabled",false);dj.byId("details_code").set("required",true);dj.byId("details_other_paymt_terms").set("value","");dj.byId("details_other_paymt_terms").set("required",false);dojo.style(dojo.byId("details_other_paymt_terms_row"),"display","none");}});m.connect("pmt_term_other_code","onChange",function(){if(dj.byId("pmt_term_other_code")&&dj.byId("pmt_term_other_code").get("checked")===true){dojo.style(dojo.byId("paymentTermCode"),"display","none");dj.byId("details_code").set("value","");dj.byId("details_nb_days").set("value","");dj.byId("details_code").set("required",false);dojo.style(dojo.byId("details_other_paymt_terms_row"),"display","block");dj.byId("details_other_paymt_terms").set("disabled",false);dj.byId("details_other_paymt_terms").set("required",true);}});m.connect("details_code","onChange",function(){if(dj.byId("code_desc")){dj.byId("code_desc").set("value",dj.byId("details_code").displayedValue);}});m.connect(dj.byId("details_code"),"onChange",m.paymentDetailsChange);m.setValidation("fin_inst_bic",m.validateBICFormat);m.connect("seller_account_iban","onChange",m.validateIBANAccountNo);m.connect("seller_account_bban","onChange",m.validateBBANAccountNo);m.connect("seller_account_upic","onChange",m.validateUPICAccountNo);m.connect("seller_account_cur_code",m.validateCurrency);m.connect("credtr_bic","onChange",function(){if(dj.byId("credtr_bic").get("checked")===true&&d.byId("settlement_creditor_agent_bic")){d.style(d.byId("settlement_creditor_agent_bic"),"display","block");dj.byId("fin_inst_bic").set("required",true);}else{if(d.byId("settlement_creditor_agent_bic")){d.style(d.byId("settlement_creditor_agent_bic"),"display","none");dj.byId("fin_inst_bic").set("required",false);dj.byId("fin_inst_bic").set("value","");}}});m.connect("credtr_name_address","onChange",function(){if(dj.byId("credtr_name_address").get("checked")===true&&d.byId("settlement_creditor_agent_name")){d.style(d.byId("settlement_creditor_agent_name"),"display","block");dj.byId("fin_inst_name").set("required",true);dj.byId("fin_inst_post_code").set("required",true);dj.byId("fin_inst_town_name").set("required",true);dj.byId("fin_inst_country").set("required",true);}else{if(d.byId("settlement_creditor_agent_name")){d.style(d.byId("settlement_creditor_agent_name"),"display","none");dj.byId("fin_inst_name").set("required",false);dj.byId("fin_inst_post_code").set("required",false);dj.byId("fin_inst_town_name").set("required",false);dj.byId("fin_inst_country").set("required",false);dj.byId("fin_inst_name").set("value","");dj.byId("fin_inst_street_name").set("value","");dj.byId("fin_inst_post_code").set("value","");dj.byId("fin_inst_town_name").set("value","");dj.byId("fin_inst_country_sub_div").set("value","");dj.byId("fin_inst_country").set("value","");}}});m.connect("fin_account_iban","onChange",function(){if(dj.byId("fin_account_iban").get("checked")===true&&d.byId("seller_account_iban_row")){d.style(d.byId("seller_account_iban_row"),"display","block");dj.byId("seller_account_iban").set("required",true);}else{if(d.byId("seller_account_iban_row")){d.style(d.byId("seller_account_iban_row"),"display","none");dj.byId("seller_account_iban").set("required",false);dj.byId("seller_account_iban").set("value","");}}});m.connect("fin_account_bban","onChange",function(){if(dj.byId("fin_account_bban").get("checked")===true&&d.byId("seller_account_bban_row")){d.style(d.byId("seller_account_bban_row"),"display","block");dj.byId("seller_account_bban").set("required",true);}else{if(d.byId("seller_account_bban_row")){d.style(d.byId("seller_account_bban_row"),"display","none");dj.byId("seller_account_bban").set("required",false);dj.byId("seller_account_bban").set("value","");}}});m.connect("fin_account_upic","onChange",function(){if(dj.byId("fin_account_upic").get("checked")===true&&d.byId("seller_account_upic_row")){d.style(d.byId("seller_account_upic_row"),"display","block");dj.byId("seller_account_upic").set("required",true);}else{if(d.byId("seller_account_upic_row")){d.style(d.byId("seller_account_upic_row"),"display","none");dj.byId("seller_account_upic").set("required",false);dj.byId("seller_account_upic").set("value","");}}});m.connect("fin_account_prop","onChange",function(){if(dj.byId("fin_account_prop").get("checked")===true&&d.byId("seller_account_id_row")){d.style(d.byId("seller_account_id_row"),"display","block");dj.byId("seller_account_id").set("required",true);}else{if(d.byId("seller_account_id_row")){d.style(d.byId("seller_account_id_row"),"display","none");dj.byId("seller_account_id").set("required",false);dj.byId("seller_account_id").set("value","");}}});m.connect("crdtr_act_code","onChange",function(){if(dj.byId("crdtr_act_code").get("checked")===true&&d.byId("seller_account_type_code_row")){d.style(d.byId("seller_account_type_code_row"),"display","block");dj.byId("seller_account_type_code").set("required",true);}else{if(d.byId("seller_account_type_code")){d.style(d.byId("seller_account_type_code_row"),"display","none");dj.byId("seller_account_type_code").set("required",false);dj.byId("seller_account_type_code").set("value","");}}});m.connect("crdtr_act_prop","onChange",function(){if(dj.byId("crdtr_act_prop").get("checked")===true&&d.byId("seller_account_type_prop_row")){d.style(d.byId("seller_account_type_prop_row"),"display","block");dj.byId("seller_account_type_prop").set("required",true);}else{if(d.byId("seller_account_type_prop_row")){d.style(d.byId("seller_account_type_prop_row"),"display","none");dj.byId("seller_account_type_prop").set("required",false);dj.byId("seller_account_type_prop").set("value","");}}});m.connect("taking_in_charge","onBlur",function(){if(misys.checkLineItemChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("taking_in_charge").set("value","");return;}});m.connect("final_dest_place","onBlur",function(){if(misys.checkLineItemChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("final_dest_place").set("value","");return;}});m.connect("taking_in_charge","onChange",function(){if(misys.checkLineItemChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("taking_in_charge").set("value","");return;}});m.connect("final_dest_place","onChange",function(){if(misys.checkLineItemChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("final_dest_place").set("value","");return;}});m.connect("departure_airport_code","onChange",function(){m.toggleMutuallyExclusiveMandatoryFields(["departure_airport_code","departure_air_town"]);m.toggleMutuallyInclusiveFields("departure_air_town","departure_airport_name","disabled");});m.connect("departure_airport_code","onBlur",function(){m.toggleMutuallyExclusiveMandatoryFields(["departure_airport_code","departure_air_town"]);m.toggleMutuallyInclusiveFields("departure_air_town","departure_airport_name","disabled");});m.connect("departure_air_town","onChange",function(){m.toggleMutuallyExclusiveMandatoryFields(["departure_airport_code","departure_air_town"]);m.toggleMutuallyInclusiveFields("departure_air_town","departure_airport_name","disabled");});m.connect("departure_air_town","onBlur",function(){m.toggleMutuallyExclusiveMandatoryFields(["departure_airport_code","departure_air_town"]);m.toggleMutuallyInclusiveFields("departure_air_town","departure_airport_name","disabled");});m.connect("destination_airport_code","onChange",function(){m.toggleMutuallyExclusiveMandatoryFields(["destination_airport_code","destination_air_town"]);m.toggleMutuallyInclusiveFields("destination_air_town","destination_airport_name","disabled");});m.connect("destination_airport_code","onBlur",function(){m.toggleMutuallyExclusiveMandatoryFields(["destination_airport_code","destination_air_town"]);m.toggleMutuallyInclusiveFields("destination_air_town","destination_airport_name","disabled");});m.connect("destination_air_town","onChange",function(){m.toggleMutuallyExclusiveMandatoryFields(["destination_airport_code","destination_air_town"]);m.toggleMutuallyInclusiveFields("destination_air_town","destination_airport_name","disabled");});m.connect("destination_air_town","onBlur",function(){m.toggleMutuallyExclusiveMandatoryFields(["destination_airport_code","destination_air_town"]);m.toggleMutuallyInclusiveFields("destination_air_town","destination_airport_name","disabled");});m.connect("taking_in_charge","onBlur",function(){m.toggleMutuallyInclusiveFields("taking_in_charge","final_dest_place","required");});m.connect("taking_in_charge","onChange",function(){m.toggleMutuallyInclusiveFields("taking_in_charge","final_dest_place","required");});m.connect("final_dest_place","onBlur",function(){m.toggleMutuallyInclusiveFields("final_dest_place","taking_in_charge","required");});m.connect("final_dest_place","onChange",function(){m.toggleMutuallyInclusiveFields("final_dest_place","taking_in_charge","required");});m.connect("line_item_taking_in_charge","onBlur",function(){if(this.id.match("^line_item_")=="line_item_"&&misys.checkPOChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("line_item_taking_in_charge").set("value","");return;}});m.connect("line_item_final_dest_place","onBlur",function(){if(this.id.match("^line_item_")=="line_item_"&&misys.checkPOChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("line_item_final_dest_place").set("value","");return;}});m.connect("line_item_taking_in_charge","onChange",function(){if(this.id.match("^line_item_")=="line_item_"&&misys.checkPOChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("line_item_taking_in_charge").set("value","");return;}});m.connect("line_item_final_dest_place","onChange",function(){if(this.id.match("^line_item_")=="line_item_"&&misys.checkPOChildrens()){misys.dialog.show("ERROR",misys.getLocalization("tooManyPODetailsError"));dj.byId("line_item_final_dest_place").set("value","");return;}});m.connect("line_item_taking_in_charge","onBlur",function(){m.toggleMutuallyInclusiveFields("line_item_taking_in_charge","line_item_final_dest_place","required");});m.connect("line_item_taking_in_charge","onChange",function(){m.toggleMutuallyInclusiveFields("line_item_taking_in_charge","line_item_final_dest_place","required");});m.connect("line_item_final_dest_place","onBlur",function(){m.toggleMutuallyInclusiveFields("line_item_final_dest_place","line_item_taking_in_charge","required");});m.connect("line_item_final_dest_place","onChange",function(){m.toggleMutuallyInclusiveFields("line_item_final_dest_place","line_item_taking_in_charge","required");});},validateLastMatchDate:function(){if((dj.byId("tnxtype")&&(dj.byId("tnxtype").get("value")==="38"))||(dj.byId("close_tnx")&&(dj.byId("close_tnx").get("checked")===true))){return true;}var _116=dj.byId("last_match_date");var _117=dj.byId("last_ship_date");var _118=m.getMaxBPOExpiryDate();var _119=m.getMaxLineItemLatestShipmentDate();var _11a=m.getMaxShipemntSubScheduleLatestShipmentDate();if(((_11a&&_11a!=="")||(_119&&_119!==""))&&_116){if(d.date.compare(_11a,_119)<0){if(_116&&_116.get("value")!==""&&_119!==""){if(d.date.compare(_116.get("value"),_119)>0){_116.invalidMessage=m.getLocalization("LastMatchDateGreaterThanShipmentDateError",[_116.get("displayedValue"),dojo.date.locale.format(_119,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}else{if(d.date.compare(_11a,_119)>0){if(d.date.compare(_116.get("value"),_11a)>0){_116.invalidMessage=m.getLocalization("LastMatchDateGreaterThanShipmentDateError",[_116.get("displayedValue"),dojo.date.locale.format(_11a,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}}if(_117&&_117.get("value")!==null){if(d.date.compare(_116.get("value"),_117.get("value"))>0){_116.invalidMessage=m.getLocalization("LastMatchDateGreaterThanShipmentDateError",[_116.get("displayedValue"),_117.get("displayedValue")]);return false;}}if(_116&&_116.get("value")!==null&&_118&&_118!==""){if(d.date.compare(_116.get("value"),_118)>0){this.invalidMessage=m.getLocalization("LastMatchDateGreaterThanBPOExpiryDateError",[_116.get("displayedValue"),dojo.date.locale.format(_118,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}var _11b=dj.byId("exp_date");if(_116&&_116.get("value")!==null&&_11b&&_11b.get("value")!==null){if(d.date.compare(_116.get("value"),m.localizeDate(_11b))>0){this.invalidMessage=m.getLocalization("lastMatchDateGreaterThanExpiryDateError",[_116.get("displayedValue"),_11b.get("displayedValue")]);return false;}}var _11c=dj.byId("iss_date");if(_116&&_116.get("value")!==null&&_11c&&_11c.get("value")!==null){if(d.date.compare(_116.get("value"),m.localizeDate(_11c))<0){this.invalidMessage=m.getLocalization("lastMatchDateLessThanIssueDateError",[_116.get("displayedValue"),_11c.get("displayedValue")]);return false;}}var _11d=dj.byId("appl_date");if(_116&&_116.get("value")!==null&&_11d&&_11d.get("value")!==null){if(d.date.compare(_116.get("value"),m.localizeDate(_11d))<0){this.invalidMessage=m.getLocalization("lastMatchDateLessThanApplicationDateError",[_116.get("displayedValue"),_11d.get("displayedValue")]);return false;}}return true;},validateOpenAccountExpiryDate:function(){if(dj.byId("close_tnx")&&(dj.byId("close_tnx").get("checked")!==true)){var _11e=dj.byId("exp_date");if(_11e&&!_11e.get("value")){var _11f=new Date();_11f.setHours(0,0,0,0);var _120=m.getMaxBPOExpiryDate();if(d.date.compare(_120,_11f)>0){this.invalidMessage=m.getLocalization("expiryDateEmptyBpoExpiryExistsError",[dojo.date.locale.format(_120,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}return true;}var _121=dj.byId("iss_date");if(_121&&_121.get("value")){if(d.date.compare(_11e.get("value"),m.localizeDate(_121))<=0){_11e.invalidMessage=m.getLocalization("issDateSmallerThanFutureDate",[_11e.get("displayedValue"),_121.get("displayedValue")]);return false;}}var _122=dj.byId("appl_date");if(_122){if(d.date.compare(_11e.get("value"),m.localizeDate(_122))<=0){this.invalidMessage=m.getLocalization("futureDateSmallerThanAppDate",[_11e.get("displayedValue"),_122.get("displayedValue")]);return false;}}if(dj.byId("product_code")&&((dj.byId("product_code").get("value")==="IO")||(dj.byId("product_code").get("value")==="EA"))){var _123=m.getMaxBPOExpiryDate();if(_11e.get("value")!==null&&_123!==""){if(d.date.compare(_11e.get("value"),_123)<0){_11e.invalidMessage=m.getLocalization("expiryDateLessThanBpoExpiryDateError",[_11e.get("displayedValue"),dojo.date.locale.format(_123,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}var _124=dj.byId("last_ship_date");if(_11e.get("value")!==null&&_124&&_124.get("value")!==null){if(d.date.compare(_11e.get("value"),_124.get("value"))<0){_11e.invalidMessage=m.getLocalization("expiryDateLessThanLastShipDateError",[_11e.get("displayedValue"),_124.get("displayedValue")]);return false;}}var _125=dj.byId("last_match_date");if(_11e.get("value")!==null&&_125&&_125.get("value")!==null){if(d.date.compare(_11e.get("value"),_125.get("value"))<0){_11e.invalidMessage=m.getLocalization("expiryDateLessThanLastMatchDateError",[_11e.get("displayedValue"),_125.get("displayedValue")]);return false;}}var _126=dj.byId("earliest_ship_date");if(_11e.get("value")!==null&&_126&&_126.get("value")!==null){if(d.date.compare(_11e.get("value"),_126.get("value"))<0){_11e.invalidMessage=m.getLocalization("expiryDateLessThanEarliestShipDateError",[_11e.get("displayedValue"),_126.get("displayedValue")]);return false;}}var _127=m.getMaxLineItemLatestShipmentDate();var _128=m.getMaxShipemntSubScheduleLatestShipmentDate();if(d.date.compare(_128,_127)<0){if(_11e.get("value")!==null&&_127!==""){if(d.date.compare(_11e.get("value"),_127)<0){_11e.invalidMessage=m.getLocalization("expiryDateLessThanLastShipDateError",[_11e.get("displayedValue"),dojo.date.locale.format(_127,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}else{if(_11e.get("value")!==null&&_128!==""){if(d.date.compare(_11e.get("value"),_128)<0){_11e.invalidMessage=m.getLocalization("expiryDateLessThanLastShipDateError",[_11e.get("displayedValue"),dojo.date.locale.format(_128,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}var _129=m.getLeastLineItemEarliestShipmentDate();var _12a=m.getLeastShipmentSubScheduleEarliestShipmentDate();var _12b="";if(_129!==""&&_12a!==""&&d.date.compare(_129,_12a)<0){_12b=_129;}else{if(_129!==""&&_12a!==""&&d.date.compare(_12a,_129)<0){_12b=_129;}else{if(_129!==""){_12b=_129;}else{if(_12a!==""){_12b=_12a;}}}}if(_11e.get("value")!==null&&_12b!==""){if(d.date.compare(_11e.get("value"),_12b)<0){_11e.invalidMessage=m.getLocalization("expiryDateLessThanEarliestShipDateError",[_11e.get("displayedValue"),dojo.date.locale.format(_12b,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}return true;},validateBPOExpiryDate:function(){var _12c=dj.byId("payment_expiry_date");if((dj.byId("tnxtype")&&(dj.byId("tnxtype").get("value")==="38"))||(dj.byId("close_tnx")&&(dj.byId("close_tnx").get("checked")===true))){return true;}var _12d=dj.byId("iss_date");if(_12d&&_12d.get("value")){if(d.date.compare(_12c.get("value"),m.localizeDate(_12d))<=0){_12c.invalidMessage=m.getLocalization("issDateSmallerThanFutureDate",[_12c.get("displayedValue"),_12d.get("displayedValue")]);return false;}}var _12e=dj.byId("appl_date");if(_12e){if(d.date.compare(_12c.get("value"),m.localizeDate(_12e))<=0){this.invalidMessage=m.getLocalization("futureDateSmallerThanAppDate",[_12c.get("displayedValue"),_12e.get("displayedValue")]);return false;}}var _12f=dj.byId("last_ship_date");if(_12c.get("value")!==null&&_12f&&_12f.get("value")!==null){if(d.date.compare(_12c.get("value"),_12f.get("value"))<0){_12c.invalidMessage=m.getLocalization("bpoExpiryDateLessThanLastShipDateError",[_12c.get("displayedValue"),_12f.get("displayedValue")]);return false;}}var _130=dj.byId("last_match_date");if(_12c.get("value")!==null&&_130&&_130.get("value")!==null){if(d.date.compare(_12c.get("value"),_130.get("value"))<0){_12c.invalidMessage=m.getLocalization("bpoExpiryDateLessThanLastMatchDateError",[_12c.get("displayedValue"),_130.get("displayedValue")]);return false;}}var _131=dj.byId("earliest_ship_date");if(_12c.get("value")!==null&&_131&&_131.get("value")!==null){if(d.date.compare(_12c.get("value"),_131.get("value"))<0){_12c.invalidMessage=m.getLocalization("bpoExpiryDateLessThanEarliestShipDateError",[_12c.get("displayedValue"),_131.get("displayedValue")]);return false;}}var _132=m.getMaxLineItemLatestShipmentDate();var _133=m.getMaxShipemntSubScheduleLatestShipmentDate();if(d.date.compare(_133,_132)<0){if(_12c.get("value")!==null&&_132!==""){if(d.date.compare(_12c.get("value"),_132)<0){_12c.invalidMessage=m.getLocalization("bpoExpiryDateLessThanLastShipDateError",[_12c.get("displayedValue"),dojo.date.locale.format(_132,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}else{if(_12c.get("value")!==null&&_133!==""){if(d.date.compare(_12c.get("value"),_133)<0){_12c.invalidMessage=m.getLocalization("bpoExpiryDateLessThanLastShipDateError",[_12c.get("displayedValue"),dojo.date.locale.format(_133,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}}var _134=m.getLeastLineItemEarliestShipmentDate();var _135=m.getLeastShipmentSubScheduleEarliestShipmentDate();var _136="";if(_134!==""&&_135!==""&&d.date.compare(_134,_135)<0){_136=_134;}else{if(_134!==""&&_135!==""&&d.date.compare(_135,_134)<0){_136=_134;}else{if(_134!==""){_136=_134;}else{if(_135!==""){_136=_135;}}}}if(_12c.get("value")!==null&&_136!==""){if(d.date.compare(_12c.get("value"),_136)<0){_12c.invalidMessage=m.getLocalization("bpoExpiryDateLessThanEarliestShipDateError",[_12c.get("displayedValue"),dojo.date.locale.format(_136,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}return true;},toggleShipmentDetails:function(){var _137=dj.byId("line_item_air_routing_summaries");var _138=dj.byId("line_item_sea_routing_summaries");var _139=dj.byId("line_item_road_routing_summaries");var _13a=dj.byId("line_item_rail_routing_summaries");if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")===true){if(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_last_ship_date")&&dj.byId("dijit_form_Button_8")){dj.byId("line_item_last_ship_date").set("disabled",true);dj.byId("line_item_earliest_ship_date").set("disabled",true);dj.byId("line_item_last_ship_date").set("value",null);dj.byId("line_item_earliest_ship_date").set("value",null);dj.byId("dijit_form_Button_8").set("disabled",true);if(dj.byId("dijit_form_Button_7")){dj.byId("dijit_form_Button_7").set("disabled",true);}}if(_137&&_138&&_139&&_13a){_137.addButtonNode.set("disabled",true);_138.addButtonNode.set("disabled",true);_139.addButtonNode.set("disabled",true);_13a.addButtonNode.set("disabled",true);}if(dj.byId("dijit_form_Button_6")){dj.byId("dijit_form_Button_6").set("disabled",true);}if(dj.byId("dijit_form_Button_5")){dj.byId("dijit_form_Button_5").set("disabled",true);}if(dj.byId("dijit_form_Button_4")){dj.byId("dijit_form_Button_4").set("disabled",true);}if(dj.byId("line_item_taking_in_charge")&&dj.byId("line_item_final_dest_place")){dj.byId("line_item_taking_in_charge")?dj.byId("line_item_taking_in_charge").set("disabled",true):"";dj.byId("line_item_final_dest_place")?dj.byId("line_item_final_dest_place").set("disabled",true):"";}}else{if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")!==true&&((dj.byId("last_ship_date")&&dj.byId("last_ship_date").get("value")!==null)||(dj.byId("earliest_ship_date")&&dj.byId("earliest_ship_date").get("value")!==null))){if(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_last_ship_date")&&dj.byId("dijit_form_Button_8")){dj.byId("line_item_last_ship_date").set("disabled",true);dj.byId("line_item_earliest_ship_date").set("disabled",true);dj.byId("line_item_last_ship_date").set("value",null);dj.byId("line_item_earliest_ship_date").set("value",null);dj.byId("dijit_form_Button_8").set("disabled",true);if(dj.byId("dijit_form_Button_7")){dj.byId("dijit_form_Button_7").set("disabled",true);}}}else{if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")!==true&&(dj.byId("last_ship_date")&&dj.byId("last_ship_date").get("value")===null)&&(dj.byId("earliest_ship_date")&&dj.byId("earliest_ship_date").get("value")===null)){if(dj.byId("line_item_shipment_schedules")&&dj.byId("line_item_shipment_schedules").store&&dj.byId("line_item_shipment_schedules").store._arrayOfTopLevelItems.length>0){dj.byId("line_item_last_ship_date")?dj.byId("line_item_last_ship_date").set("disabled",true):"";dj.byId("line_item_earliest_ship_date")?dj.byId("line_item_earliest_ship_date").set("disabled",true):"";}else{if((dj.byId("line_item_last_ship_date")&&dj.byId("line_item_last_ship_date").get("value")!==null)||(dj.byId("line_item_earliest_ship_date")&&dj.byId("line_item_earliest_ship_date").get("value")!==null)){dj.byId("dijit_form_Button_8")?dj.byId("dijit_form_Button_8").set("disabled",true):"";}else{dj.byId("line_item_last_ship_date")?dj.byId("line_item_last_ship_date").set("disabled",false):"";dj.byId("line_item_earliest_ship_date")?dj.byId("line_item_earliest_ship_date").set("disabled",false):"";dj.byId("dijit_form_Button_8")?dj.byId("dijit_form_Button_8").set("disabled",false):"";}}dj.byId("dijit_form_Button_7")?dj.byId("dijit_form_Button_7").set("disabled",false):"";dj.byId("dijit_form_Button_9")?dj.byId("dijit_form_Button_9").set("disabled",false):"";dj.byId("dijit_form_Button_10")?dj.byId("dijit_form_Button_10").set("disabled",false):"";dj.byId("dijit_form_Button_11")?dj.byId("dijit_form_Button_11").set("disabled",false):"";dj.byId("dijit_form_Button_12")?dj.byId("dijit_form_Button_12").set("disabled",false):"";dj.byId("dijit_form_Button_6")?dj.byId("dijit_form_Button_6").set("disabled",false):"";dj.byId("dijit_form_Button_5")?dj.byId("dijit_form_Button_5").set("disabled",false):"";dj.byId("dijit_form_Button_4")?dj.byId("dijit_form_Button_4").set("disabled",false):"";}}}},toggleMultimodalTransportDetails:function(){var _13b=dj.byId("line_item_air_routing_summaries");var _13c=dj.byId("line_item_sea_routing_summaries");var _13d=dj.byId("line_item_road_routing_summaries");var _13e=dj.byId("line_item_rail_routing_summaries");if(dj.byId("tran_ship_2")&&dj.byId("tran_ship_2").get("checked")===true&&dj.byId("line_item_taking_in_charge")&&dj.byId("line_item_final_dest_place")){dj.byId("line_item_taking_in_charge").set("value","");dj.byId("line_item_final_dest_place").set("value","");dj.byId("line_item_taking_in_charge").set("disabled",true);dj.byId("line_item_final_dest_place").set("disabled",true);dj.byId("line_item_taking_in_charge").set("disabled",true);dj.byId("line_item_final_dest_place").set("disabled",true);if(_13b&&_13b.store&&_13b.store._arrayOfTopLevelItems.length>0){_13c.clear();_13d.clear();_13e.clear();_13b.addButtonNode.set("disabled",true);_13c.addButtonNode.set("disabled",true);_13d.addButtonNode.set("disabled",true);_13e.addButtonNode.set("disabled",true);}if(_13c&&_13c.store&&_13c.store._arrayOfTopLevelItems.length>0){_13b.clear();_13d.clear();_13e.clear();_13b.addButtonNode.set("disabled",true);_13c.addButtonNode.set("disabled",true);_13d.addButtonNode.set("disabled",true);_13e.addButtonNode.set("disabled",true);}if(_13d&&_13d.store&&_13d.store._arrayOfTopLevelItems.length>0){_13b.clear();_13c.clear();_13e.clear();_13b.addButtonNode.set("disabled",true);_13c.addButtonNode.set("disabled",true);_13d.addButtonNode.set("disabled",true);_13e.addButtonNode.set("disabled",true);}if(_13e&&_13e.store&&_13e.store._arrayOfTopLevelItems.length>0){_13b.clear();_13c.clear();_13d.clear();_13b.addButtonNode.set("disabled",true);_13c.addButtonNode.set("disabled",true);_13d.addButtonNode.set("disabled",true);_13e.addButtonNode.set("disabled",true);}}else{if(dj.byId("part_ship_2")&&dj.byId("part_ship_2").get("checked")===true&&dj.byId("line_item_final_dest_place")&&dj.byId("line_item_taking_in_charge")){dj.byId("line_item_taking_in_charge").set("disabled",true);dj.byId("line_item_final_dest_place").set("disabled",true);}else{if(dj.byId("line_item_final_dest_place")&&dj.byId("line_item_taking_in_charge")){dj.byId("line_item_taking_in_charge").set("disabled",false);dj.byId("line_item_final_dest_place").set("disabled",false);}}}},getMaxLineItemLatestShipmentDate:function(){var _13f=dj.byId("line-items");var _140=new Date();_140.setHours(0,0,0,0);if(_13f&&_13f.store&&_13f.store._arrayOfTopLevelItems.length>0){_13f.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_13f,function(_141,_142){dojo.forEach(_141,function(item){if(item.last_ship_date[0]!==""){var _143=dojo.date.locale.parse(item.last_ship_date[0],{locale:dojo.config.locale,formatLength:"short",selector:"date"});if(_140<_143){_140=_143;}}});})});}return _140;},getMaxShipemntSubScheduleLatestShipmentDate:function(){var _144=dj.byId("line-items");var _145=new Date();_145.setHours(0,0,0,0);if(_144&&_144.store&&_144.store._arrayOfTopLevelItems.length>0){_144.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_144,function(_146,_147){dojo.forEach(_146,function(item){if(item.shipment_schedules[0]._values.length>0){for(var i=0;i<item.shipment_schedules[0]._values.length;i++){var _148=dojo.date.locale.parse(item.shipment_schedules[0]._values[i].schedule_latest_ship_date,{locale:dojo.config.locale,formatLength:"short",selector:"date"});if(_145<_148){_145=_148;}}}});})});}return _145;},getLeastLineItemEarliestShipmentDate:function(){var _149=dj.byId("line-items");var _14a="";if(_149&&_149.store&&_149.store._arrayOfTopLevelItems.length>0){_149.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_149,function(_14b,_14c){dojo.forEach(_14b,function(item){if(item.earliest_ship_date[0]!==""){var _14d=dojo.date.locale.parse(item.earliest_ship_date[0],{locale:dojo.config.locale,formatLength:"short",selector:"date"});if(_14a==""){_14a=_14d;}else{if(_14d<_14a){_14a=_14d;}}}});})});}return _14a;},getLeastShipmentSubScheduleEarliestShipmentDate:function(){var _14e=dj.byId("line-items");var _14f="";if(_14e&&_14e.store&&_14e.store._arrayOfTopLevelItems.length>0){_14e.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_14e,function(_150,_151){dojo.forEach(_150,function(item){if(item.shipment_schedules[0]._values.length>0){for(var i=0;i<item.shipment_schedules[0]._values.length;i++){var _152=dojo.date.locale.parse(item.shipment_schedules[0]._values[i].schedule_earliest_ship_date,{locale:dojo.config.locale,formatLength:"short",selector:"date"});if(_14f==""){_14f=_152;}else{if(_152<_14f){_14f=_152;}}}}});})});}return _14f;},hasLineItemShipmentPeriodDefined:function(){var _153=dj.byId("line-items");var _154=false;if(_153&&_153.store&&_153.store._arrayOfTopLevelItems.length>0){_153.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_153,function(_155,_156){dojo.forEach(_155,function(item){if((item&&item.last_ship_date&&item.last_ship_date[0]!=="")||(item&&item.earliest_ship_date&&item.earliest_ship_date[0]!=="")){_154=true;}else{if(item&&item.shipment_schedules&&item.shipment_schedules[0]._values.length>0){for(var i=0;i<item.shipment_schedules[0]._values.length;i++){if(item.shipment_schedules[0]._values[i].schedule_latest_ship_date!==""||item.shipment_schedules[0]._values[i].schedule_earliest_ship_date!==""||item.shipment_schedules[0]._values[i].sub_shipment_quantity_value!==""){_154=true;}}}}});})});}return _154;},hasLastShipmentInAllLineItems:function(){var ctr=0;var _157=dj.byId("line-items");if(_157){if(_157&&_157.store&&_157.store._arrayOfTopLevelItems.length>0){_157.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_157,function(_158,_159){dojo.forEach(_158,function(item){if(item.last_ship_date[0]!==""||item.earliest_ship_date[0]!==""){ctr++;}else{if(item.shipment_schedules[0]._values.length>0){for(var i=0;i<item.shipment_schedules[0]._values.length;i++){if(item.shipment_schedules[0]._values[i].schedule_latest_ship_date!==""||item.shipment_schedules[0]._values[i].schedule_earliest_ship_date!==""||item.shipment_schedules[0]._values[i].sub_shipment_quantity_value!==""){shipFlag=true;}}ctr++;}}});})});}if(ctr==_157.store._arrayOfTopLevelItems.length||ctr==0){return false;}}return true;},hasIncotermsInAllLineItems:function(){var ctr=0;var _15a=dj.byId("line-items");if(_15a){if(_15a&&_15a.store&&_15a.store._arrayOfTopLevelItems.length>0){_15a.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_15a,function(_15b,_15c){dojo.forEach(_15b,function(item){if(item.incoterms[0]._values.length>0){ctr++;}});})});}if(_15a.store&&(ctr==_15a.store._arrayOfTopLevelItems.length||ctr==0)){return false;}}return true;},hasRoutingSummaryInAllLineItems:function(){var ctr=0;var _15d=dj.byId("line-items");if(_15d){if(_15d&&_15d.store&&_15d.store._arrayOfTopLevelItems.length>0){_15d.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_15d,function(_15e,_15f){dojo.forEach(_15e,function(item){if((item.air_routing_summaries&&item.air_routing_summaries[0]._values.length>0)||(item.sea_routing_summaries&&item.sea_routing_summaries[0]._values.length>0)||(item.road_routing_summaries&&item.road_routing_summaries[0]._values.length>0)||(item.rail_routing_summaries&&item.rail_routing_summaries[0]._values.length>0)||item.final_dest_place[0].length>0||item.taking_in_charge[0].length>0){ctr++;}});})});}if(ctr==_15d.store._arrayOfTopLevelItems.length||ctr==0){return false;}}return true;},validateCreditorAccountIdType:function(){if(dj.byId("seller_account_iban")&&dj.byId("seller_account_bban")&&dj.byId("seller_account_upic")&&dj.byId("seller_account_id")){if((dj.byId("seller_account_iban").get("value")==="")&&(dj.byId("seller_account_bban").get("value")==="")&&(dj.byId("seller_account_upic").get("value")==="")&&(dj.byId("seller_account_id").get("value")==="")){return false;}}return true;},validateResubmissionCount:function(){misys._config.warningMessages=[];if(dj.byId("tnxtype")&&dj.byId("tnxtype").get("value")!=="38"){if(dj.byId("allowed_resubmission_count")&&dj.byId("resubmission_count")){var _160=parseInt(dj.byId("allowed_resubmission_count").get("value"),10);if(parseInt(dj.byId("resubmission_count").get("value"),10)==_160){misys._config.warningMessages=[];misys._config.warningMessages.push(m.getLocalization("lastresubmissionCountWarning",[_160]));}else{if(parseInt(dj.byId("resubmission_count").get("value"),10)>_160){misys._config.warningMessages=[];misys._config.warningMessages.push(m.getLocalization("resubmissionCountExceededWarning",[_160]));}}}}return true;},clearBpoExpiryDateOnLoad:function(){var bpo=dj.byId("bank-payment-obligations");if(bpo&&bpo.store&&bpo.store._arrayOfTopLevelItems.length>0){bpo.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(bpo,function(_161,_162){dojo.forEach(_161,function(item){if(item.payment_expiry_date[0]!==""){item.payment_expiry_date[0]="";}});})});}},validateOALastShipmentDate:function(){if((dj.byId("tnxtype")&&(dj.byId("tnxtype").get("value")==="38"))||(dj.byId("close_tnx")&&(dj.byId("close_tnx").get("checked")===true))){return true;}if(!this.get("value")){return true;}var _163=dj.byId("appl_date");if(!m.compareDateFields(_163,this)){this.invalidMessage=m.getLocalization("lastShipmentDateLessThanAppDateError",[_46(this),_46(_163)]);return false;}var _164=dj.byId("iss_date");if(_164&&_164.get("value")){if(d.date.compare(this.get("value"),m.localizeDate(_164))<0){this.invalidMessage=m.getLocalization("issDateSmallerThanLatestShipDate",[_46(this),_46(_164)]);return false;}}var _165=dj.byId("exp_date");var _166=m.getMaxBPOExpiryDate();if(this.get("value")!==""&&_166&&_166!==""){if(d.date.compare(this.get("value"),_166)>0){this.invalidMessage=m.getLocalization("lastShipmentDateGreaterThanBpoExpiryDateError",[_46(this),dojo.date.locale.format(_166,{locale:dojo.config.locale,formatLength:"short",selector:"date"})]);return false;}}if(_165&&!m.compareDateFields(this,_165)){this.invalidMessage=m.getLocalization("latestShipDateLessThanExpiryDateError",[_46(this),_46(_165)]);return false;}var _167=dj.byId("amd_date");if(!m.compareDateFields(_167,this)){this.invalidMessage=m.getLocalization("lastShipDateGreaterThanAmdDateError",[_46(this),_46(_167)]);return false;}var _168=dj.byId("due_date");if(!m.compareDateFields(this,_168)){this.invalidMessage=m.getLocalization("dueDateLessThanLastShipmentError",[_46(_168),_46(this)]);return false;}var _169=dj.byId("earliest_ship_date");if(_169&&_169.get("value")!==null){if(d.date.compare(this.get("value"),m.localizeDate(_169))<0){this.invalidMessage=m.getLocalization("lastShipDateLessThanEarliestShipDateError",[_46(this),_46(_169)]);return false;}}var _16a=dj.byId("line_item_earliest_ship_date");if(_16a&&_16a.get("value")!==null){if(d.date.compare(this.get("value"),m.localizeDate(_16a))<0){this.invalidMessage=m.getLocalization("lastShipDateLessThanEarliestShipDateError",[_46(this),_46(_16a)]);return false;}}var _16b=dj.byId("schedule_earliest_ship_date");var _16c=dj.byId("line_item_shipment_schedules");if(_16c&&_16c.store&&_16c.store._arrayOfTopLevelItems.length>0&&_16b&&_16b.get("value")!==null){if(d.date.compare(this.get("value"),m.localizeDate(_16b))<0){this.invalidMessage=m.getLocalization("lastShipDateLessThanEarliestShipDateError",[_46(this),_46(_16b)]);return false;}}return true;},handleFullFinancingFlag:function(){var _16d=dj.byId("full_finance_accepted_flag"),_16e=dj.byId("total_net_amt"),_16f=dj.byId("inv_eligible_amt"),_170=dj.byId("finance_amt"),_171=dj.byId("finance_cur_code"),_172=dj.byId("prod_stat_code");if(_16d.get("checked")&&_172&&_172.get("value")!=="01"){_16f.set("readOnly",true);_170.set("readOnly",true);_171.set("readOnly",true);_16f.set("value",_16e.value);}else{if((isNaN(_16f.value)||parseFloat(_16f.value)===parseFloat(_16e.value))&&(_172&&_172.get("value")!=="01")){_16f.set("readOnly",false);_170.set("readOnly",false);_171.set("readOnly",false);if(dj.byId("org_inv_eligible_amt")&&dj.byId("org_inv_eligible_amt").get("value")!==null){_16f.set("value",dj.byId("org_inv_eligible_amt").get("value"));}else{_16f.set("value",null);}}}},clearFields:function(_173){dojo.forEach(_173,function(id){var _174=dijit.byId(id);if(_174){dijit.byId(_174).set("value","");}});},changeAmountFormatSelectField:function(){var _175=dj.byId("delimiter").get("value"),_176=dj.byId("amount_format_select"),_177=dj.byId("mapping_delimited"),_178=m._config.amountFormatOptions,_179=m._config.amountFormatSelectOptions[_175];if(_177.get("checked")){if(!_179){var _17a=dj.byId("delimiter_text").get("value");_179=m._config.amountFormatSelectOptions[_17a];}if(_179){_176.store=new dojo.data.ItemFileReadStore({data:{identifier:"value",label:"name",items:_179}});}}else{_176.store=new dojo.data.ItemFileReadStore({data:{identifier:"value",label:"name",items:_178}});}},clearLineItemDetail:function(){var _17b=dj.byId("line-items");if(_17b&&_17b.store&&_17b.store._arrayOfTopLevelItems.length>0){_17b.store.fetch({query:{store_id:"*"},onComplete:dojo.hitch(_17b,function(_17c,_17d){dojo.forEach(_17c,function(item){if(item.last_ship_date&&item.shipment_schedules[0]){item.last_ship_date[0]="";}if(item.earliest_ship_date&&item.earliest_ship_date[0]){item.earliest_ship_date[0]="";}if(item.freight_charges_type&&item.freight_charges_type[0]){item.freight_charges_type[0]="";}if(item.shipment_schedules&&item.shipment_schedules[0]){item.shipment_schedules[0]._values=[];}if(item.incoterms&&item.incoterms[0]){item.incoterms[0]._values=[];}if(item.air_routing_summaries&&item.air_routing_summaries[0]){item.air_routing_summaries[0]._values=[];}if(item.sea_routing_summaries&&item.sea_routing_summaries[0]){item.sea_routing_summaries[0]._values=[];}if(item.rail_routing_summaries&&item.rail_routing_summaries[0]){item.rail_routing_summaries[0]._values=[];}if(item.road_routing_summaries&&item.road_routing_summaries[0]){item.road_routing_summaries[0]._values=[];}if(item.taking_in_charge&&item.taking_in_charge[0]){item.taking_in_charge[0]="";}if(item.final_dest_place&&item.final_dest_place[0]){item.final_dest_place[0]="";}if(item.freight_charges&&item.freight_charges[0]){item.freight_charges[0]._values=[];}if(item.taxes&&item.taxes[0]){item.taxes[0]._values=[];}if(item.adjustments&&item.adjustments[0]){item.adjustments[0]._values=[];}});})});}},validateFromAmount:function(){var _17e=dj.byId("amount_from");var _17f=_17e?_17e.get("value"):"";var _180=dj.byId("amount_to")?dj.byId("amount_to").get("value"):"";var _181;if(_17f!==""&&_17f<=0){_181=misys.getLocalization("invalidAmountError");_17e.focus();_17e.set("state","Error");dj.hideTooltip(_17e.domNode);dj.showTooltip(_181,_17e.domNode,0);dj.showTooltip(_181,domNode,0);}if(_17f!==""&&_180!==""&&_17f>_180){_181=misys.getLocalization("invalidMinAmountValueError");_17e.focus();_17e.set("state","Error");dj.hideTooltip(_17e.domNode);dj.showTooltip(_181,_17e.domNode,0);dj.showTooltip(_181,domNode,0);}},validateToAmount:function(){var _182=dj.byId("amount_to");var _183=_182?_182.get("value"):"";var _184=dj.byId("amount_from")?dj.byId("amount_from").get("value"):"";var _185;if(_183!==""&&_183<=0){_185=misys.getLocalization("invalidAmountError");_182.focus();_182.set("state","Error");dj.hideTooltip(_182.domNode);dj.showTooltip(_185,_182.domNode,0);dj.showTooltip(_185,domNode,0);}if(_183!==""&&_184!==""&&_183<_184){_185=misys.getLocalization("invalidMaxAmountValueError");_182.focus();_182.set("state","Error");dj.hideTooltip(_182.domNode);dj.showTooltip(_185,_182.domNode,0);dj.showTooltip(_185,domNode,0);}},validateInvoiceFromDate:function(_186,_187){if(!m.compareDateFields(_186,_187)){var _188=m.getLocalization("fromDateLessThanToDateError",[_46(_186),_46(_187)]);_186.set("state","Error");dj.hideTooltip(_186.domNode);dj.showTooltip(_188,_186.domNode,0);dj.showTooltip(_188,domNode,0);}},validateInvoiceToDate:function(_189,_18a){if(!m.compareDateFields(_189,_18a)){var _18b=m.getLocalization("toDateLessThanFromDateError",[_46(_18a),_46(_189)]);_18a.set("state","Error");dj.hideTooltip(_18a.domNode);dj.showTooltip(_18b,_18a.domNode,0);dj.showTooltip(_18b,domNode,0);}},validateDateAmountFormatFields:function(){var _18c=dj.byId("user_list"),_18d=true,_18e=dj.byId("date_format_select"),_18f=dj.byId("amount_format_select"),_190=dj.byId("date_format_other"),_191=dj.byId("amount_format_other"),_192=false;d.some(d.query("option",_18c.domNode),function(_193,_194){var _195=[];if(m._config.mappedColumns[_193.value].dataType==="Date"){if("S"+m._config.mappedColumns[_193.value].dateFormat==="S"){_195.push(_18e);_192=true;_18d=false;}else{if(m._config.mappedColumns[_193.value].dateFormat==="OTHER"&&("S"+m._config.mappedColumns[_193.value].dateFormatText==="S")){_195.push(_190);_192=true;_18d=false;}}}else{if(m._config.mappedColumns[_193.value].dataType==="Number"&&_193.value!=="payment_term_nb_days"){if("S"+m._config.mappedColumns[_193.value].amountFormat==="S"){_195.push(_18f);_192=true;_18d=false;}else{if(m._config.mappedColumns[_193.value].amountFormat==="OTHER"&&("S"+m._config.mappedColumns[_193.value].amountFormatText==="S")){_195.push(_191);_192=true;_18d=false;}}}}if(_192){dj.byId("user_list").domNode.options.selectedIndex=_194;dj.byId("user_list").onClick();m.markErrorFields(_195);}return _192;});return _18d;},markErrorFields:function(_196){var _197=misys.getLocalization("uploadTemplateValueRequired");d.forEach(_196,function(_198){_198.set("state","Error");dj.hideTooltip(_198.domNode);dj.showTooltip(_197,_198.domNode,0);});},getInvoicesForBulk:function(_199){var _19a;if(dj.byId("issuing_bank_customer_reference")){_19a=dj.byId("issuing_bank_customer_reference").get("value");}m.showSearchDialog("invoice_item_bulk","['invoice_ref_id', 'entity', 'program_code','seller_name','buyer_name', 'total_net_cur_code', 'total_net_amt', 'liab_total_net_amt', 'iss_date', 'due_date','prod_stat_code']",{product_code:_199,issuing_bank_customer_reference:_19a},"",_199,"width:1250px;height:400px;",m.getLocalization("ListOfInvoicesTitleMessage"));},getInvoicesForBulkFiltered:function(){var _19b;if(dj.byId("program")){_19b=dj.byId("program").get("value");}if(!_19b){misys.dialog.show("ERROR",misys.getLocalization("programNameRequiredForBulkFinancingSearch"));return;}var _19c;if(dj.byId("issuing_bank_customer_reference")){_19c=dj.byId("issuing_bank_customer_reference").get("value");}if(!_19c){misys.dialog.show("ERROR",misys.getLocalization("customerReferenceRequiredForBulkFinancingSearch"));return;}var _19d;if(dj.byId("curCode")){_19d=dj.byId("curCode").get("value");}if(!m.validateCurrencyCode(_19d)){misys.dialog.show("ERROR",misys.getLocalization("invalidCurrencyError",[_19d]));return;}var _19e;var _19f;var _1a0;var _1a1;if(dj.byId("amount_from")){_1a2=dj.byId("amount_from");}if(dj.byId("amount_to")){_1a3=dj.byId("amount_to");}if(dj.byId("invoice_date_from")){_19e=dj.byId("invoice_date_from");}if(dj.byId("invoice_date_to")){_19f=dj.byId("invoice_date_to");}if(dj.byId("invoice_due_date_from")){_1a0=dj.byId("invoice_due_date_from");}if(dj.byId("invoice_due_date_to")){_1a1=dj.byId("invoice_due_date_to");}if((_1a3&&_1a3.get("value")!==null&&_1a2&&_1a2.get("value")!==null)&&_1a3.get("value")<_1a2.get("value")){misys.dialog.show("ERROR",misys.getLocalization("invalidMaxAmountValueError",[_1a3.get("displayedValue"),_1a2.get("displayedValue")]));}if((_19f&&_19f.get("value")!==null&&_19e&&_19e.get("value")!==null)&&(d.date.compare(_19f.get("value"),_19e.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("invoiceDateToGreaterThanDateFromError",[_19f.get("displayedValue"),_19e.get("displayedValue")]));}if((_1a1&&_1a1.get("value")!==null&&_1a0&&_1a0.get("value")!==null)&&(d.date.compare(_1a1.get("value"),_1a0.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("invoiceDueDateToGreaterThanDueDateFromError",[_1a1.get("displayedValue"),_1a0.get("displayedValue")]));}var _1a4="";if(dj.byId("invoicesGrid")&&dj.byId("invoicesGrid").store&&dj.byId("invoicesGrid").store._arrayOfAllItems&&dj.byId("invoicesGrid").store._arrayOfAllItems.length){var _1a5=dj.byId("invoicesGrid").store._arrayOfAllItems;for(var i=0;i<_1a5.length;i++){if(_1a5[i]&&_1a5[i]["REFERENCEID"]){_1a4=_1a4+_1a5[i]["REFERENCEID"]+",";}}}var _1a6;var _1a7;var _1a8;var _1a2;var _1a3;var _1a9;if(dj.byId("ref_id")){_1a6=dj.byId("ref_id").get("value");}if(dj.byId("invoice_ref_id")){_1a7=dj.byId("invoice_ref_id").get("value");}if(dj.byId("buyer_name")){_1a8=dj.byId("buyer_name").get("value");}if(dj.byId("amount_from")){_1a2=dj.byId("amount_from");}if(dj.byId("amount_to")){_1a3=dj.byId("amount_to");}if(dj.byId("entity")){_1a9=dj.byId("entity").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"invoice_item_bulk",product_code:"IN",invoice_ref_id:_1a7,buyer_name:_1a8,curcode:_19d,program_code:_19b,amount_from:_1a2,amount_to:_1a3,invoice_date_from:_19e,invoice_date_to:_19f,invoice_due_date_from:_1a0,invoice_due_date_to:_1a1,invoiceRefIDList:_1a4,entity:_1a9,customer_reference:_19c},load:function(_1aa){m._showFilteredInvoicesForBulk(_1aa);}});},getInvoicesForBulkLinkedFiltered:function(){var _1ab;if(dj.byId("ref_id")){_1ab=dj.byId("ref_id").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"invoice_item_bulk_linked",product_code:"IN",bulk_ref_id:_1ab},load:function(_1ac){m._showFilteredInvoicesForBulkLinked(_1ac);}});},getInvoicePayablesForBulkLinkedFiltered:function(){var _1ad;if(dj.byId("ref_id")){_1ad=dj.byId("ref_id").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"invoice_payable_item_bulk_linked",product_code:"IP",bulk_ref_id:_1ad},load:function(_1ae){m._showFilteredInvoicePayablesForBulkLinked(_1ae);}});},_showFilteredInvoicesForBulk:function(_1af){var _1b0=dj.byId("invoice_item_bulkdata_grid");var _1b1=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_1af.items.length>0){var _1b2=_1af.items;if(_1b2.length>0){for(var i=0;i<_1b2.length;i++){var item=_1b2[i];if(item!==null){var _1b3=m.createInvoiceItem(item);_1b1.newItem(_1b3);}}}if(_1b0){_1b0.setStore(_1b1);dojo.style(_1b0.domNode,"display","");_1b0.resize();}}else{_1b0.setStore(_1b1);dojo.style(_1b0.domNode,"display","");_1b0.resize();_1b0.render();}},_showFilteredInvoicesForBulkLinked:function(_1b4){var _1b5=dj.byId("invoicesGrid");var _1b6=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_1b4.items.length>0){var _1b7=_1b4.items;if(_1b7.length>0){for(var i=0;i<_1b7.length;i++){var item=_1b7[i];if(item!==null){var _1b8=m.createInvoiceItem(item);_1b6.newItem(_1b8);}}}if(_1b5){_1b5.setStore(_1b6);dojo.style(_1b5.domNode,"display","");_1b5.resize();}}else{_1b5.setStore(_1b6);dojo.style(_1b5.domNode,"display","");_1b5.resize();_1b5.render();}},_showFilteredInvoicePayablesForBulkLinked:function(_1b9){var _1ba=dj.byId("invoicePayablesGrid");var _1bb=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_1b9.items.length>0){var _1bc=_1b9.items;if(_1bc.length>0){for(var i=0;i<_1bc.length;i++){var item=_1bc[i];if(item!==null){var _1bd=m.createInvoicePayableItem(item);_1bb.newItem(_1bd);}}}if(_1ba){_1ba.setStore(_1bb);dojo.style(_1ba.domNode,"display","");_1ba.resize();}}else{_1ba.setStore(_1bb);dojo.style(_1ba.domNode,"display","");_1ba.resize();_1ba.render();}},createInvoiceItem:function(item){var _1be=item.REFERENCEID.slice().toString();var _1bf=item.INVOICE_REFERENCE_LABEL.slice().toString();var _1c0=item.PROGRAM_NAME.slice().toString();var _1c1=item.BUYER_NAME.slice().toString();var _1c2=item.CURCODE.slice().toString();var _1c3=item.AMOUNT;var _1c4=item.OS_AMOUNT;var _1c5=item.INVOICE_DATE.slice().toString();var _1c6=item.INVOICE_DUE_DATE.slice().toString();var _1c7=item.STATUS;var _1c8=item.FIN_REQUESTED_PERCENT;var _1c9="";if(d.byId("delete_icon")!=null&&d.byId("delete_icon")){_1c9=d.byId("delete_icon").value;}var actn="<img src="+_1c9+" onClick =\"javascript:misys.deleteInvoiceRecord('"+item.REFERENCEID+"')\"/>";var _1ca={"REFERENCEID":_1be,"INVOICE_REFERENCE_LABEL":_1bf,"PROGRAM_NAME":_1c0,"ACTION":actn,"BUYER_NAME":_1c1,"CURCODE":_1c2,"AMOUNT":_1c3,"OS_AMOUNT":_1c4,"INVOICE_DATE":_1c5,"INVOICE_DUE_DATE":_1c6,"STATUS":_1c7,"FIN_REQUESTED_PERCENT":_1c8};return _1ca;},processInvoiceRecords:function(grid){var _1cb=dj.byId("invoicesGrid");var _1cc=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});var _1cd=[];if(_1cb&&_1cb.store&&_1cb.store._arrayOfTopLevelItems.length>0){_1cb.store.fetch({query:{REFERENCEID:"*"},onComplete:function(_1ce,_1cf){dojo.forEach(_1ce,function(item){var _1d0=m.createInvoiceItem(item);_1cc.newItem(_1d0);_1cd.push(item);});}});}var _1d1=grid.selection.getSelected();if(_1d1.length>0){for(var i=0;i<_1d1.length;i++){var _1d2=false;var _1d3="";var _1d4={};var item=_1d1[i];if(item!==null){var _1d5=m.createInvoiceItem(item);if(_1cd.length>0){for(var t=0;t<_1cd.length;t++){if(_1cd[t].REFERENCEID.slice().toString()===item.REFERENCEID.slice().toString()){_1d2=true;}}if(!_1d2){_1cc.newItem(_1d5);}}else{_1cc.newItem(_1d5);}}}if(_1cb){_1cb.setStore(_1cc);dojo.style(_1cb.domNode,"display","");_1cb.resize();}dj.byId("xhrDialog").hide();}else{misys.dialog.show("ERROR",misys.getLocalization("invoiceShouldBeSelected"));}},closeInvoiceGrid:function(grid){dj.byId("xhrDialog").hide();},deleteInvoiceRecord:function(ref){var _1d6=[];dj.byId("invoicesGrid").store.fetch({query:{REFERENCEID:"*"},onComplete:dojo.hitch(dj.byId("invoicesGrid"),function(_1d7,_1d8){dojo.forEach(_1d7,function(item){if(item.REFERENCEID.slice().toString()===ref.slice().toString()){dj.byId("invoicesGrid").store.deleteItem(item);}});})});dj.byId("invoicesGrid").resize();dj.byId("invoicesGrid").render();},getInvoicePayablesForBulk:function(_1d9){m.showSearchDialog("invoice_payable_item_bulk","['invoice_payable_ref_id', 'entity', 'program_code','seller_name','buyer_name', 'total_net_cur_code', 'total_net_amt', 'liab_total_net_amt', 'iss_date', 'due_date','prod_stat_code']",{product_code:_1d9},"",_1d9,"width:1250px;height:400px;",m.getLocalization("ListOfInvoicePayablesTitleMessage"));},getInvoicePayablesForBulkFiltered:function(){var _1da;if(dj.byId("program")){_1da=dj.byId("program").get("value");}if(!_1da){misys.dialog.show("ERROR",misys.getLocalization("programNameRequiredForBulkFinancingSearch"));return;}var _1db;if(dj.byId("issuing_bank_customer_reference")){_1db=dj.byId("issuing_bank_customer_reference").get("value");}if(!_1db){misys.dialog.show("ERROR",misys.getLocalization("customerReferenceRequiredForBulkFinancingSearch"));return;}var _1dc;if(dj.byId("curCode")){_1dc=dj.byId("curCode").get("value");}if(!m.validateCurrencyCode(_1dc)){misys.dialog.show("ERROR",misys.getLocalization("invalidCurrencyError",[_1dc]));return;}var _1dd;var _1de;var _1df;var _1e0;if(dj.byId("amount_from")){_1e1=dj.byId("amount_from");}if(dj.byId("amount_to")){_1e2=dj.byId("amount_to");}if(dj.byId("invoice_date_from")){_1dd=dj.byId("invoice_date_from");}if(dj.byId("invoice_date_to")){_1de=dj.byId("invoice_date_to");}if(dj.byId("invoice_due_date_from")){_1df=dj.byId("invoice_due_date_from");}if(dj.byId("invoice_due_date_to")){_1e0=dj.byId("invoice_due_date_to");}if((_1e2&&_1e2.get("value")!==null&&_1e1&&_1e1.get("value")!==null)&&_1e2.get("value")<_1e1.get("value")){misys.dialog.show("ERROR",misys.getLocalization("invalidMaxAmountValueError",[_1e2.get("displayedValue"),_1e1.get("displayedValue")]));}if((_1de&&_1de.get("value")!==null&&_1dd&&_1dd.get("value")!==null)&&(d.date.compare(_1de.get("value"),_1dd.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("invoiceDateToGreaterThanDateFromError",[_1de.get("displayedValue"),_1dd.get("displayedValue")]));}if((_1e0&&_1e0.get("value")!==null&&_1df&&_1df.get("value")!==null)&&(d.date.compare(_1e0.get("value"),_1df.get("value"))<0)){misys.dialog.show("ERROR",misys.getLocalization("invoiceDueDateToGreaterThanDueDateFromError",[_1e0.get("displayedValue"),_1df.get("displayedValue")]));}var _1e3="";if(dj.byId("invoicePayablesGrid")&&dj.byId("invoicePayablesGrid").store&&dj.byId("invoicePayablesGrid").store._arrayOfAllItems&&dj.byId("invoicePayablesGrid").store._arrayOfAllItems.length){var _1e4=dj.byId("invoicePayablesGrid").store._arrayOfAllItems;for(var i=0;i<_1e4.length;i++){if(_1e4[i]&&_1e4[i]["REFERENCEID"]){_1e3=_1e3+_1e4[i]["REFERENCEID"]+",";}}}var _1e5;var _1e6;var _1e7;var _1e1;var _1e2;var _1e8;if(dj.byId("ref_id")){_1e5=dj.byId("ref_id").get("value");}if(dj.byId("invoice_payable_ref_id")){_1e6=dj.byId("invoice_payable_ref_id").get("value");}if(dj.byId("seller_name")){_1e7=dj.byId("seller_name").get("value");}if(dj.byId("amount_from")){_1e1=dj.byId("amount_from");}if(dj.byId("amount_to")){_1e2=dj.byId("amount_to");}if(dj.byId("entity")){_1e8=dj.byId("entity").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"invoice_payable_item_bulk",product_code:"IP",invoice_ref_id:_1e6,seller_name:_1e7,curcode:_1dc,program_code:_1da,amount_from:_1e1,amount_to:_1e2,invoice_date_from:_1dd,invoice_date_to:_1de,invoice_due_date_from:_1df,invoice_due_date_to:_1e0,invoiceRefIDList:_1e3,entity:_1e8,customer_reference:_1db},load:function(_1e9){m._showFilteredInvoicePayablesForBulk(_1e9);}});},_showFilteredInvoicePayablesForBulk:function(_1ea){var _1eb=dj.byId("invoice_payable_item_bulkdata_grid");var _1ec=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});if(_1ea.items.length>0){var _1ed=_1ea.items;if(_1ed.length>0){for(var i=0;i<_1ed.length;i++){var item=_1ed[i];if(item!==null){var _1ee=m.createInvoicePayableItem(item);_1ec.newItem(_1ee);}}}if(_1eb){_1eb.setStore(_1ec);dojo.style(_1eb.domNode,"display","");_1eb.resize();}}else{_1eb.setStore(_1ec);dojo.style(_1eb.domNode,"display","");_1eb.resize();_1eb.render();}},createInvoicePayableItem:function(item){var _1ef=item.REFERENCEID.slice().toString();var _1f0=item.INVOICE_REFERENCE_LABEL.slice().toString();var _1f1=item.PROGRAM_NAME.slice().toString();var _1f2=item.SELLER_NAME.slice().toString();var _1f3=item.CURCODE.slice().toString();var _1f4=item.AMOUNT;var _1f5=item.OS_AMOUNT;var _1f6=item.INVOICE_DATE.slice().toString();var _1f7=item.INVOICE_DUE_DATE.slice().toString();var _1f8=item.STATUS;var _1f9=item.FIN_REQUESTED_PERCENT;var _1fa="";if(d.byId("delete_icon")!=null&&d.byId("delete_icon")){_1fa=d.byId("delete_icon").value;}var actn="<img src="+_1fa+" onClick =\"javascript:misys.deleteInvoicePayableRecord('"+item.REFERENCEID+"')\"/>";var _1fb={"REFERENCEID":_1ef,"INVOICE_REFERENCE_LABEL":_1f0,"PROGRAM_NAME":_1f1,"ACTION":actn,"SELLER_NAME":_1f2,"CURCODE":_1f3,"AMOUNT":_1f4,"OS_AMOUNT":_1f5,"INVOICE_DATE":_1f6,"INVOICE_DUE_DATE":_1f7,"STATUS":_1f8,"FIN_REQUESTED_PERCENT":_1f9};return _1fb;},processInvoicePayableRecords:function(grid){var _1fc=dj.byId("invoicePayablesGrid");var _1fd=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});var _1fe=[];if(_1fc&&_1fc.store&&_1fc.store._arrayOfTopLevelItems.length>0){_1fc.store.fetch({query:{REFERENCEID:"*"},onComplete:function(_1ff,_200){dojo.forEach(_1ff,function(item){var _201=m.createInvoicePayableItem(item);_1fd.newItem(_201);_1fe.push(item);});}});}var _202=grid.selection.getSelected();if(_202.length>0){for(var i=0;i<_202.length;i++){var _203=false;var _204="";var _205={};var item=_202[i];if(item!==null){var _206=m.createInvoicePayableItem(item);if(_1fe.length>0){for(var t=0;t<_1fe.length;t++){if(_1fe[t].REFERENCEID.slice().toString()===item.REFERENCEID.slice().toString()){_203=true;}}if(!_203){_1fd.newItem(_206);}}else{_1fd.newItem(_206);}}}if(_1fc){_1fc.setStore(_1fd);dojo.style(_1fc.domNode,"display","");_1fc.resize();}dj.byId("xhrDialog").hide();}else{misys.dialog.show("ERROR",misys.getLocalization("invoicePayableShouldBeSelected"));}},deleteInvoicePayableRecord:function(ref){var _207=[];dj.byId("invoicePayablesGrid").store.fetch({query:{REFERENCEID:"*"},onComplete:dojo.hitch(dj.byId("invoicePayablesGrid"),function(_208,_209){dojo.forEach(_208,function(item){if(item.REFERENCEID.slice().toString()===ref.slice().toString()){dj.byId("invoicePayablesGrid").store.deleteItem(item);}});})});dj.byId("invoicePayablesGrid").resize();dj.byId("invoicePayablesGrid").render();},resetBulkInvoiceOnEntityChange:function(_20a){var _20b;var _20c;var _20d;var _20e;var _20f;var _210;var _211;if(dj.byId("tnx_id")){_20f=dj.byId("tnx_id").get("value");}if(dj.byId("ref_id")){_20b=dj.byId("ref_id").get("value");}if(dj.byId("invoice_ref_id")){_20c=dj.byId("invoice_ref_id").get("value");}if(dj.byId("entity")){_20e=dj.byId("entity").get("value");}if(dj.byId("child_product_code")){_210=dj.byId("child_product_code").get("value");}if(dj.byId("sub_product_code")){_211=dj.byId("sub_product_code").get("value");}m.xhrPost({url:m.getServletURL("/screen/AjaxScreen/action/GetStaticData"),handleAs:"json",sync:true,content:{option:"reset_invoice_on_entity_change",product_code:_210,sub_product_code:_211,bulk_ref_id:_20b,tnxID:_20f,invoice_ref_id:_20c,invoiceRefIDList:_20a,entity:_20e},load:function(_212){m._showFilteredInvoicePayablesForBulk(_212);}});},clearInvoicePayablesGrid:function(){var _213=dj.byId("invoicePayablesGrid");var _214="";if(dj.byId("invoicePayablesGrid")&&dj.byId("invoicePayablesGrid").store&&dj.byId("invoicePayablesGrid").store._arrayOfAllItems&&dj.byId("invoicePayablesGrid").store._arrayOfAllItems.length){var _215=dj.byId("invoicePayablesGrid").store._arrayOfAllItems;for(var i=0;i<_215.length;i++){if(_215[i]&&_215[i]["REFERENCEID"]){_214=_214+_215[i]["REFERENCEID"]+",";}}}var _216=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});_213.setStore(_216);_213.resize();m.resetBulkInvoiceOnEntityChange(_214);},clearInvoiceGrid:function(){var _217=dj.byId("invoicesGrid");var _218="";if(dj.byId("invoicesGrid")&&dj.byId("invoicesGrid").store&&dj.byId("invoicesGrid").store._arrayOfAllItems&&dj.byId("invoicesGrid").store._arrayOfAllItems.length){var _219=dj.byId("invoicesGrid").store._arrayOfAllItems;for(var i=0;i<_219.length;i++){if(_219[i]&&_219[i]["REFERENCEID"]){_218=_218+_219[i]["REFERENCEID"]+",";}}}var _21a=new dojo.data.ItemFileWriteStore({data:{"identifier":"REFERENCEID","items":[]}});_217.setStore(_21a);_217.resize();m.resetBulkInvoiceOnEntityChange(_218);},clearLinkedInvoiceGrid:function(){var _21b=dj.byId("gridInvoice");var _21c={items:""};var _21d=[];if(dj.byId("gridInvoice")&&dj.byId("gridInvoice").store&&dj.byId("gridInvoice").store._arrayOfAllItems&&dj.byId("gridInvoice").store._arrayOfAllItems.length!==0){var _21e=misys.getLocalization("resetLinkedInvoiceGrid");var _21f=new dojo.data.ItemFileWriteStore({data:_21c});var _220=function(){_21d=_21b.store._arrayOfTopLevelItems;for(var i=0;i<_21d.length;i++){if(dj.byId("invoiceAmt_"+i)){dj.byId("invoiceAmt_"+i).destroy(true);}}_21b.setStore(_21f);};m.dialog.show("CONFIRMATION",_21e,"","","","",_220,function(){});}},clearRepaymentAmt:function(){var _221=dj.byId("finance_repayment_amt");var _222=dj.byId("finance_repayment_percentage");_221.attr("disabled",false);_222.attr("disabled",false);_221.set("value","");_222.set("value","");},setRepaymentDetails:function(){var _223=dj.byId("finance_repayment_action").value;var _224=dj.byId("outstanding_repayment_amt");var _225=dj.byId("outstanding_repayment_cur_code");var _226=dj.byId("interest_flag");var _227=dj.byId("charge_flag");var _228=dj.byId("finance_repayment_amt");var _229=dj.byId("finance_repayment_cur_code");var _22a=dj.byId("finance_repayment_percentage");_224.set("disabled",true);_225.set("disabled",true);_226.set("checked",false);_226.set("disabled",true);_227.set("checked",false);_227.set("disabled",true);_228.attr("disabled",false);_22a.attr("disabled",false);_229.set("value",_225.value);_229.set("disabled",true);if(_223==="01"){_226.set("checked",true);_227.set("checked",true);_228.set("value",_224.value);this.setRepaymentCurrency("finance_repayment_cur_code",["finance_repayment_amt"]);_22a.set("value","");_228.attr("disabled",true);_22a.attr("disabled",true);}else{if(_223==="02"){_226.set("checked",true);}else{if(_223==="03"){if(_228.displayedValue===""){_228.set("value",_224.value);}if(_229.displayedValue===""){_229.set("value",_225.value);this.setRepaymentCurrency("finance_repayment_cur_code",["finance_repayment_amt"]);}_226.set("checked",true);_227.set("checked",true);}else{if(_223==="04"){_226.set("checked",true);_227.set("checked",true);}}}}},setRepaymentAmtAndCurCode:function(){var _22b=dj.byId("finance_repayment_amt");var _22c=dj.byId("finance_repayment_percentage").value;if(_22b.value===0){misys.dialog.show("ERROR",misys.getLocalization("repaymentAmtCantBeZero"));_22b.set("value","");}else{if(dj.byId("finance_repayment_amt").displayedValue===""){dj.byId("finance_repayment_percentage").attr("disabled",false);}}},setRepaymentPercentage:function(){var _22d=dj.byId("outstanding_repayment_amt");var _22e=dj.byId("finance_repayment_percentage").value;var _22f=(_22e/100)*_22d;dj.byId("finance_repayment_amt").set("value",_22f);if(dj.byId("finance_repayment_percentage").displayedValue===""){dj.byId("finance_repayment_amt").attr("disabled",false);}else{dj.byId("finance_repayment_amt").attr("disabled",true);}},validateFSCMFromAmount:function(_230,idTo){var _231=dj.byId(_230);var _232=_231?_231.get("value"):"";var _233=dj.byId(idTo)?dj.byId(idTo).get("value"):"";var _234;if(_232!==""&&_232<=0){_234=misys.getLocalization("invalidAmountError");_231.focus();_231.set("state","Error");dj.hideTooltip(_231.domNode);dj.showTooltip(_234,_231.domNode,0);dj.showTooltip(_234,domNode,0);}if(_232!==""&&_233!==""&&_232>_233){_234=misys.getLocalization("invalidMinAmountValueError");_231.focus();_231.set("state","Error");dj.hideTooltip(_231.domNode);dj.showTooltip(_234,_231.domNode,0);dj.showTooltip(_234,domNode,0);}},validateFSCMToAmount:function(idTo,_235){var _236=dj.byId(idTo);var _237=_236?_236.get("value"):"";var _238=dj.byId(_235)?dj.byId(_235).get("value"):"";var _239;if(_237!==""&&_237<=0){_239=misys.getLocalization("invalidAmountError");_236.focus();_236.set("state","Error");dj.hideTooltip(_236.domNode);dj.showTooltip(_239,_236.domNode,0);dj.showTooltip(_239,domNode,0);}if(_237!==""&&_238!==""&&_237<_238){_239=misys.getLocalization("invalidMaxAmountValueError");_236.focus();_236.set("state","Error");dj.hideTooltip(_236.domNode);dj.showTooltip(_239,_236.domNode,0);dj.showTooltip(_239,domNode,0);}},validateInvoiceDateTo:function(){var _23a;var _23b;if(dj.byId("invoice_date_from")){_23a=dj.byId("invoice_date_from");}if(dj.byId("invoice_date_to")){_23b=dj.byId("invoice_date_to");}if((_23b&&_23b.get("value")!==null&&_23a&&_23a.get("value")!==null)&&(d.date.compare(_23b.get("value"),_23a.get("value"))<0)){var _23c=dj.byId("invoice_date_to");displayMessage=misys.getLocalization("invoiceDateToGreaterThanDateFromError");_23c.set("state","Error");dj.hideTooltip(_23c.domNode);dj.showTooltip(displayMessage,_23c.domNode,0);}},validateInvoiceDateFrom:function(){var _23d;var _23e;if(dj.byId("invoice_date_from")){_23d=dj.byId("invoice_date_from");}if(dj.byId("invoice_date_to")){_23e=dj.byId("invoice_date_to");}if((_23e&&_23e.get("value")!==null&&_23d&&_23d.get("value")!==null)&&(d.date.compare(_23e.get("value"),_23d.get("value"))<0)){var _23f=dj.byId("invoice_date_from");displayMessage=misys.getLocalization("invoiceDateFromGreaterThanDateToError");_23f.set("state","Error");dj.hideTooltip(_23f.domNode);dj.showTooltip(displayMessage,_23f.domNode,0);}},validateInvoiceDueDateFrom:function(){var _240;var _241;if(dj.byId("invoice_due_date_from")){_240=dj.byId("invoice_due_date_from");}if(dj.byId("invoice_due_date_to")){_241=dj.byId("invoice_due_date_to");}if((_241&&_241.get("value")!==null&&_240&&_240.get("value")!==null)&&(d.date.compare(_241.get("value"),_240.get("value"))<0)){var _242=dj.byId("invoice_due_date_from");displayMessage=misys.getLocalization("invoiceDueDateFromGreaterThanDueDateToError");_242.set("state","Error");dj.hideTooltip(_242.domNode);dj.showTooltip(displayMessage,_242.domNode,0);}},validateInvoiceDueDateTo:function(){var _243;var _244;if(dj.byId("invoice_due_date_from")){_243=dj.byId("invoice_due_date_from");}if(dj.byId("invoice_due_date_to")){_244=dj.byId("invoice_due_date_to");}if((_244&&_244.get("value")!==null&&_243&&_243.get("value")!==null)&&(d.date.compare(_244.get("value"),_243.get("value"))<0)){var _245=dj.byId("invoice_due_date_to");displayMessage=misys.getLocalization("invoiceDueDateToGreaterThanDueDateFromError");_245.set("state","Error");dj.hideTooltip(_245.domNode);dj.showTooltip(displayMessage,_245.domNode,0);}},repayValidateDueDateFrom:function(){var _246;var _247;if(dj.byId("fin_due_date")){due_date_from=dj.byId("fin_due_date");}if(dj.byId("fin_due_date2")){due_date_to=dj.byId("fin_due_date2");}if((due_date_to&&due_date_to.get("value")!==null&&due_date_from&&due_date_from.get("value")!==null)&&(d.date.compare(due_date_from.get("value"),due_date_to.get("value"))>0)){var _248=dj.byId("fin_due_date");displayMessage=misys.getLocalization("FinanceDueDateFromLesserThanFinanceDueDateTo");_248.set("state","Error");dj.hideTooltip(_248.domNode);dj.showTooltip(displayMessage,_248.domNode,0);}},repayValidateDueDateTo:function(){var _249;var _24a;if(dj.byId("fin_due_date")){due_date_from=dj.byId("fin_due_date");}if(dj.byId("fin_due_date2")){due_date_to=dj.byId("fin_due_date2");}if((due_date_to&&due_date_to.get("value")!==null&&due_date_from&&due_date_from.get("value")!==null)&&(d.date.compare(due_date_to.get("value"),due_date_from.get("value"))<0)){var _24b=dj.byId("fin_due_date2");displayMessage=misys.getLocalization("FinanceDueDateToGreaterThanFinanceDueDateFrom");_24b.set("state","Error");dj.hideTooltip(_24b.domNode);dj.showTooltip(displayMessage,_24b.domNode,0);}},repayValidateFinanceInvoiceDateFrom:function(){var _24c;var _24d;if(dj.byId("fin_date")){_24c=dj.byId("fin_date");}if(dj.byId("fin_date2")){_24d=dj.byId("fin_date2");}if((_24d&&_24d.get("value")!==null&&_24c&&_24c.get("value")!==null)&&(d.date.compare(_24c.get("value"),_24d.get("value"))>0)){var _24e=dj.byId("fin_date");displayMessage=misys.getLocalization("FinanceIssueDateFromLesserThanFinanceIssueDateTo");_24e.set("state","Error");dj.hideTooltip(_24e.domNode);dj.showTooltip(displayMessage,_24e.domNode,0);}},repayValidateFinanceInvoiceDateTo:function(){var _24f;var _250;if(dj.byId("fin_date")){_24f=dj.byId("fin_date");}if(dj.byId("fin_date2")){_250=dj.byId("fin_date2");}if((_250&&_250.get("value")!==null&&_24f&&_24f.get("value")!==null)&&(d.date.compare(_250.get("value"),_24f.get("value"))<0)){var _251=dj.byId("fin_date2");displayMessage=misys.getLocalization("FinanceIssueDateToGreaterThanFinanceIssueDateFrom");_251.set("state","Error");dj.hideTooltip(_251.domNode);dj.showTooltip(displayMessage,_251.domNode,0);}},setRepaymentCurrency:function(node,arr,_252){var _253=dj.byId(node),_254=d.isArray(arr)?arr:[arr],_255,_256,_257;if(_253&&_253.get("value")!==""&&_253.state!=="Error"){_255=_253.get("value");d.forEach(_254,function(id){_256=dj.byId(id);if(_256){_257=d.cldr.monetary.getData(_255);var _258={round:_257.round,places:_257.places,max:999999999999.99,min:0.01};if(_257.places===2){_258={round:_257.round,places:_257.places,min:0,max:999999999999.99};}else{if(_257.places===3){_258={round:_257.round,places:_257.places,min:0,max:999999999999.999};}else{if(_257.places===0){_258={round:_257.round,places:_257.places,min:0,max:9999999999999};}}}d.mixin(_258,_252);_256.set("constraints",_258);_256.set("value",_256.get("value"));}});}},collectionValidateInvoiceDateFrom:function(){if(this.get("value")===null){return true;}var _259=dj.byId("iss_date2");if(!m.compareDateFields(this,_259)){var _25a=dj.byId("iss_date");displayMessage=misys.getLocalization("InvoiceIssueDateFromLesserThanInvoiceIssueDateTo");_25a.focus();_25a.set("state","Error");dj.hideTooltip(_25a.domNode);dj.showTooltip(displayMessage,_25a.domNode,0);}return true;},collectionValidateInvoiceDateTo:function(){if(this.get("value")===null){return true;}var _25b=dj.byId("iss_date");if(!m.compareDateFields(_25b,this)){var _25c=dj.byId("iss_date2");displayMessage=misys.getLocalization("InvoiceIssueDateToGreaterThanInvoiceIssueDateFrom");_25c.focus();_25c.set("state","Error");dj.hideTooltip(_25c.domNode);dj.showTooltip(displayMessage,_25c.domNode,0);return false;}return true;},collectionValidateDueDateFrom:function(){if(this.get("value")===null){return true;}var _25d=dj.byId("due_date2");if(!m.compareDateFields(this,_25d)){var _25e=dj.byId("due_date"),_25f=misys.getLocalization("InvoiceDueDateFromGreaterThanInvoiceDueDateTo");_25e.focus();_25e.set("state","Error");dj.hideTooltip(_25e.domNode);dj.showTooltip(_25f,_25e.domNode,0);dj.showTooltip(_25f,domNode,0);return false;}return true;},collectionValidateDueDateTo:function(){if(this.get("value")===null){return true;}var _260=dj.byId("due_date");if(!m.compareDateFields(_260,this)){var _261=dj.byId("due_date2");displayMessage=misys.getLocalization("InvoiceDueDateToLesserThanInvoiceDueDateFrom");_261.focus();_261.set("state","Error");dj.hideTooltip(_261.domNode);dj.showTooltip(displayMessage,_261.domNode,0);}return true;},setSettlementPercentage:function(){var _262=dj.byId("collections_amt").value;var _263=dj.byId("settlement_percentage").value;var _264=(_263/100)*_262;dj.byId("settlement_amt").set("value",_264);},setSettlementAmt:function(){var _265=dj.byId("collections_amt").value;var _266=dj.byId("settlement_amt").value;var _267=(_266*100)/_265;dj.byId("settlement_percentage").set("value",_267);},setSettlementAmtAndCurCode:function(){var _268=dj.byId("settlement_amt");var _269=dj.byId("settlement_percentage");if(_268.value===0){misys.dialog.show("ERROR",misys.getLocalization("settlementAmtCantBeZero"));_268.set("value","");}else{if(dj.byId("settlement_amt").displayedValue===""){_269.attr("disabled",false);}}},setSettlementCurrency:function(node,arr,_26a){var _26b=dj.byId(node),_26c=d.isArray(arr)?arr:[arr],_26d,_26e,_26f;if(_26b&&_26b.get("value")!==""&&_26b.state!=="Error"){_26d=_26b.get("value");d.forEach(_26c,function(id){_26e=dj.byId(id);if(_26e){_26f=d.cldr.monetary.getData(_26d);var _270={round:_26f.round,places:_26f.places,max:999999999999.99,min:0.01};if(_26f.places===2){_270={round:_26f.round,places:_26f.places,min:0,max:999999999999.99};}else{if(_26f.places===3){_270={round:_26f.round,places:_26f.places,min:0,max:999999999999.999};}else{if(_26f.places===0){_270={round:_26f.round,places:_26f.places,min:0,max:9999999999999};}}}d.mixin(_270,_26a);_26e.set("constraints",_270);_26e.set("value",_26e.get("value"));}});}},setSettlementDetails:function(){var _271=dj.byId("liab_total_net_amt");var _272=dj.byId("liab_total_net_cur_code");var _273=dj.byId("settlement_amt");var _274=dj.byId("settlement_cur_code");var _275=dj.byId("settlement_percentage");var _276=dj.byId("collections_amt");_271.set("disabled",true);_272.set("disabled",true);_273.set("disabled",false);_275.set("disabled",false);_274.set("value",_272.value);_274.set("disabled",true);m.calculateOutstandingSettlementAmt();},calculateOutstandingSettlementAmt:function(){var _277=dj.byId("liab_total_net_amt");var _278=Number(dijit.byId("collections_amt").get("value"));var _279=Number(dijit.byId("settlement_amt").get("value"));if(_277){_277.set("value",_278-(_279));}},validateSettlementDateWithInvoiceDates:function(){if(!this.get("value")){return true;}var _27a=dj.byId("due_date");if(!m.compareDateFields(this,_27a)){this.invalidMessage=m.getLocalization("settlementDateSmallerThanInvoiceDueDate",[_46(this),_46(_27a)]);return false;}var _27b=dj.byId("iss_date");if(!m.compareDateFields(_27b,this)){this.invalidMessage=m.getLocalization("settlementDateGreaterThanInvoiceDate",[_46(this),_46(_27b)]);return false;}return true;}});})(dojo,dijit,misys);}